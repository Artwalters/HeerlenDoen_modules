(function(){"use strict";let _=0;async function i1(){console.log("🔄 Loading modules sequentially..."),await l1();try{await Promise.resolve().then(()=>I1),console.log("✅ Module 1 loaded: Initialization"),_++,await s1(),await Promise.resolve().then(()=>O1),console.log("✅ Module 2 loaded: Geolocation"),_++,await Promise.resolve().then(()=>H1),console.log("✅ Module 3 loaded: Data loading"),_++,await Promise.resolve().then(()=>N1),console.log("✅ Module 4 loaded: Markers"),_++,await Promise.resolve().then(()=>z1),console.log("✅ Module 5 loaded: Popups"),_++,await Promise.resolve().then(()=>V1),console.log("✅ Module 6 loaded: Map interactions"),_++,await Promise.resolve().then(()=>X1),console.log("✅ Module 7 loaded: Three.js"),_++,await Promise.resolve().then(()=>ee),console.log("✅ Module 8 loaded: POI"),_++,await Promise.resolve().then(()=>ie),console.log("✅ Module 9 loaded: Toggle 3D"),_++,await Promise.resolve().then(()=>ue),console.log("✅ Module 9 loaded: Toggle 3D"),_++,console.log("🎉 All modules loaded successfully!")}catch(e){console.error("❌ Error loading modules:",e)}}function l1(){return new Promise(e=>{const t=()=>{document.getElementById("map")?(console.log("✅ Map container found"),e()):(console.log("⏳ Waiting for map container..."),setTimeout(t,100))};t()})}function s1(){return new Promise(e=>{window.map&&window.map.loaded()?e():window.map?window.map.on("load",e):setTimeout(()=>{window.map?window.map.loaded()?e():window.map.on("load",e):e()},100)})}async function H(){console.log("🎯 Webflow Vite App gestart!"),console.log("📍 Environment:","production"),await new Promise(t=>setTimeout(t,500)),await i1();const e=document.createElement("div");e.style.cssText=`
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #4CAF50;
    color: white;
    padding: 10px 20px;
    border-radius: 5px;
    font-family: Arial, sans-serif;
    z-index: 9999;
  `,e.textContent="✅ Vite Server Connected!",document.body.appendChild(e),setTimeout(()=>{e.style.transition="opacity 0.5s",e.style.opacity="0",setTimeout(()=>e.remove(),500)},3e3)}function r1(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{setTimeout(H,100)}):setTimeout(H,100)}r1();//! INITIALIZATION & GLOBALS //////////////
const v={MAP:{center:[5.979642,50.887634],zoom:15.5,pitch:45,bearing:-17.6,boundary:{center:[5.977105864037915,50.88774161029858],radius:2}},MARKER_ZOOM:{min:10,small:14,medium:16,large:18}};mapboxgl.accessToken="pk.eyJ1IjoicHJvamVjdGhlZXJsZW4iLCJhIjoiY2x4eWVmcXBvMWozZTJpc2FqbWgzcnAyeCJ9.SVOVbBG6o1lHs6TwCudR9g";let S=null,Z=!1;const T={type:"FeatureCollection",features:[]},A="heerlenActiveFilters";let R=new Set;function p1(){try{const e=Array.from(R);localStorage.setItem(A,JSON.stringify(e))}catch(e){console.error("Kon kaartfilters niet opslaan in localStorage:",e)}}function D(e=[]){R=new Set(e),document.querySelectorAll(".filter-btn").forEach(t=>{const o=t.dataset.category;o&&t.classList.toggle("is--active",R.has(o))}),B()}function d1(){try{const e=localStorage.getItem(A),t=e?JSON.parse(e):[];D(t)}catch(e){console.error("Kon filters niet laden/parsen uit localStorage voor kaart:",e),D([])}}const d=new mapboxgl.Map({container:"map",style:"mapbox://styles/projectheerlen/cm9lkc2ge005301qs86xncirv",center:v.MAP.center,zoom:v.MAP.zoom,pitch:v.MAP.pitch,bearing:v.MAP.bearing,antialias:!0,interactive:!0,renderWorldCopies:!1,preserveDrawingBuffer:!1,maxParallelImageRequests:16,fadeDuration:0});//! Sla de originele flyTo methode op
const u1=mapboxgl.Map.prototype.flyTo;mapboxgl.Map.prototype.flyTo=function(e){const t=this.getContainer(),o=t.style.cursor,a=()=>{this.dragPan.disable(),this.scrollZoom.disable(),this.boxZoom.disable(),this.dragRotate.disable(),this.keyboard.disable(),this.touchZoomRotate.disable(),t.style.cursor="wait";let l=document.getElementById("map-interaction-blocker");l||(l=document.createElement("div"),l.id="map-interaction-blocker",l.style.position="absolute",l.style.top="0",l.style.left="0",l.style.width="100%",l.style.height="100%",l.style.zIndex="1000",l.style.pointerEvents="all",l.style.cursor="wait",t.appendChild(l))},n=()=>{this.dragPan.enable(),this.scrollZoom.enable(),this.boxZoom.enable(),this.dragRotate.enable(),this.keyboard.enable(),this.touchZoomRotate.enable(),t.style.cursor=o;const l=document.getElementById("map-interaction-blocker");l&&l.remove()};return a(),this.once("moveend",n),u1.call(this,e)},d.doubleClickZoom.disable();//!============= GEOLOCATION MANAGER ============= //////////
let m1=class{constructor(t){this.map=t,this.searchRadiusId="search-radius",this.searchRadiusOuterId="search-radius-outer",this.radiusInMeters=25,this.boundaryLayerIds=["boundary-fill","boundary-line","boundary-label"],this.distanceMarkers=[],this.isPopupOpen=!1,this.centerPoint=v.MAP.boundary.center,this.boundaryRadius=v.MAP.boundary.radius,console.log("[DEBUG] GeolocationManager initialized."),console.log("[DEBUG] Boundary Center:",this.centerPoint),console.log("[DEBUG] Boundary Radius (km):",this.boundaryRadius),this.initialize()}initialize(){this.setupGeolocateControl(),this.setupSearchRadius(),this.setupBoundaryCheck()}pauseTracking(){this.geolocateControl&&this.geolocateControl._watchState==="ACTIVE_LOCK"&&(this.wasTracking=!0,this.geolocateControl._watchState="ACTIVE_ERROR",console.log("Geolocation tracking paused"))}resumeTracking(){this.geolocateControl&&this.wasTracking&&(this.geolocateControl._watchState="ACTIVE_LOCK",this.wasTracking=!1,console.log("Geolocation tracking resumed"))}updateDistanceMarkers(t){this.distanceMarkers&&(this.distanceMarkers.forEach(o=>o.remove()),this.distanceMarkers=[]),T.features.forEach(o=>{const a=o.geometry.coordinates,n=1e3*this.calculateDistance(t[1],t[0],a[1],a[0]);if(n<=this.radiusInMeters){const l=document.createElement("div");l.className="distance-marker",l.innerHTML=`<span class="distance-marker-distance">${Math.round(n)}m</span>`;const s=new mapboxgl.Marker({element:l}).setLngLat(a).addTo(this.map);l.addEventListener("click",()=>{this.map.fire("click",{lngLat:a,point:this.map.project(a),features:[o]})}),this.distanceMarkers.push(s)}})}handleUserLocation(t){const o=[t.coords.longitude,t.coords.latitude];if(console.log("[DEBUG] handleUserLocation - User Position:",o),this.isWithinBoundary(o))if(console.log("[DEBUG] handleUserLocation - User is INSIDE boundary."),this.updateSearchRadius(o),this.updateDistanceMarkers(o),this.isPopupOpen)console.log("[DEBUG] handleUserLocation - Popup is open, map movement skipped.");else if(this.isFirstLocation)console.log("[DEBUG] handleUserLocation - First location detected, flying to user."),this.map.flyTo({center:o,zoom:17.5,pitch:45,duration:2e3,bearing:t.coords.heading||0}),this.isFirstLocation=!1;else{const a=this.map.getCenter();this.calculateDistance(a.lat,a.lng,o[1],o[0])>.05&&(console.log("[DEBUG] handleUserLocation - Easing to new user position."),this.map.easeTo({center:o,duration:1e3}))}else console.warn("[DEBUG] handleUserLocation - User is OUTSIDE boundary. Stopping tracking."),this.geolocateControl._watchState="OFF",this.geolocateControl._geolocateButton&&(this.geolocateControl._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.geolocateControl._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting")),this.clearSearchRadius(),this.distanceMarkers&&(this.distanceMarkers.forEach(a=>a.remove()),this.distanceMarkers=[]),console.log("[DEBUG] handleUserLocation - Calling showBoundaryPopup because user moved outside."),this.showBoundaryPopup(),console.log("[DEBUG] handleUserLocation - Flying to Heerlen center."),this.map.flyTo({center:this.centerPoint,zoom:14,pitch:0,bearing:0,duration:1500})}setupGeolocateControl(){document.querySelectorAll(".mapboxgl-ctrl-top-right .mapboxgl-ctrl-group").forEach(o=>o.remove()),document.querySelectorAll(".mapboxgl-ctrl-bottom-right .mapboxgl-ctrl-group").forEach(o=>o.remove()),this.geolocateControl=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0,maximumAge:1e3,timeout:6e3},trackUserLocation:!0,showUserHeading:!0,showAccuracyCircle:!1,fitBoundsOptions:{maxZoom:17.5,animate:!0}}),this.isFirstLocation=!0,this.isTracking=!1,this.userInitiatedGeolocation=!1;const t=this.geolocateControl._onSuccess;this.geolocateControl._onSuccess=o=>{const a=[o.coords.longitude,o.coords.latitude];console.log("[DEBUG] _onSuccess - Position received:",a);const n=this.isWithinBoundary(a);if(console.log("[DEBUG] _onSuccess - Before check: userInitiatedGeolocation =",this.userInitiatedGeolocation,", isWithinBoundary =",n),this.userInitiatedGeolocation&&!n){console.warn("[DEBUG] _onSuccess - User clicked AND is outside boundary. Preventing geolocation and showing popup."),this.geolocateControl._watchState="OFF",this.geolocateControl._geolocateButton&&(this.geolocateControl._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.geolocateControl._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),console.log("[DEBUG] _onSuccess - Geolocate button classes removed.")),this.showBoundaryLayers(),console.log("[DEBUG] _onSuccess - Calling showBoundaryPopup()."),this.showBoundaryPopup(),this.geolocateControl._userLocationDotMarker&&(console.log("[DEBUG] _onSuccess - Removing user location dot marker."),this.geolocateControl._userLocationDotMarker.remove()),this.userInitiatedGeolocation=!1,console.log("[DEBUG] _onSuccess - userInitiatedGeolocation flag reset to false.");return}console.log("[DEBUG] _onSuccess - User is within boundary OR check was not user-initiated. Proceeding with original _onSuccess."),t.call(this.geolocateControl,o),this.userInitiatedGeolocation=!1,console.log("[DEBUG] _onSuccess - userInitiatedGeolocation flag reset after normal processing.")},this.geolocateControl.on("error",o=>{console.error("[DEBUG] Geolocation error event triggered:",o),this.userInitiatedGeolocation?(console.warn("[DEBUG] Geolocation error occurred after user initiated the request."),this.handleGeolocationError(o)):console.log("[DEBUG] Geolocation error occurred during automatic tracking or initial load."),this.userInitiatedGeolocation=!1,console.log("[DEBUG] Geolocation error - userInitiatedGeolocation flag reset.")}),this.map.once("idle",()=>{const o=document.querySelector(".mapboxgl-ctrl-geolocate");o&&o.parentElement?o.addEventListener("click",a=>{console.log("[DEBUG] Geolocate button CLICKED. Setting userInitiatedGeolocation = true."),this.userInitiatedGeolocation=!0,console.log("[DEBUG] Geolocate button click - Showing boundary layers."),this.showBoundaryLayers()},!0):console.warn("[DEBUG] Could not find geolocate button after map idle.")}),this.geolocateControl.on("trackuserlocationstart",()=>{console.log("Location tracking started"),console.log("[DEBUG] trackuserlocationstart event - Showing boundary layers."),this.isTracking=!0,this.showBoundaryLayers()}),this.geolocateControl.on("trackuserlocationend",()=>{console.log("Location tracking ended"),this.isTracking=!1,this.isFirstLocation=!0,this.map.easeTo({bearing:0,pitch:45}),this.clearSearchRadius(),this.distanceMarkers&&(this.distanceMarkers.forEach(o=>o.remove()),this.distanceMarkers=[])}),this.map.addControl(this.geolocateControl,"bottom-right"),this.map.addControl(new mapboxgl.NavigationControl,"top-right")}setupSearchRadius(){this.map.on("load",()=>{if(this.map.getSource(this.searchRadiusId)){console.log("[DEBUG] Search radius source already exists on load.");return}this.map.addSource(this.searchRadiusId,{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}}}),this.map.addLayer({id:this.searchRadiusId,type:"fill-extrusion",source:this.searchRadiusId,paint:{"fill-extrusion-color":"#4B83F2","fill-extrusion-opacity":.08,"fill-extrusion-height":1,"fill-extrusion-base":0}}),this.map.addSource(this.searchRadiusOuterId,{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}}}),this.map.addLayer({id:this.searchRadiusOuterId,type:"fill-extrusion",source:this.searchRadiusOuterId,paint:{"fill-extrusion-color":"#4B83F2","fill-extrusion-opacity":.04,"fill-extrusion-height":2,"fill-extrusion-base":0}}),console.log("[DEBUG] Search radius layers added.")})}setupBoundaryCheck(){this.map.on("load",()=>{if(this.map.getSource("boundary-circle")){console.log("[DEBUG] Boundary circle source already exists on load.");return}this.map.addSource("boundary-circle",{type:"geojson",data:this.createBoundaryCircle()}),this.map.addLayer({id:"boundary-fill",type:"fill",source:"boundary-circle",paint:{"fill-color":"#4B83F2","fill-opacity":.03},layout:{visibility:"none"}}),this.map.addLayer({id:"boundary-line",type:"line",source:"boundary-circle",paint:{"line-color":"#4B83F2","line-width":2,"line-dasharray":[3,3]},layout:{visibility:"none"}}),console.log("[DEBUG] Boundary check layers added.")})}showBoundaryLayers(){console.log("[DEBUG] showBoundaryLayers called."),this.boundaryLayerIds.forEach(t=>{if(this.map.getLayer(t)){if(this.map.setLayoutProperty(t,"visibility","visible"),t==="boundary-fill"){let o=0;const a=()=>{o<.03&&(o+=.005,this.map.setPaintProperty(t,"fill-opacity",o),requestAnimationFrame(a))};a()}}else console.warn(`[DEBUG] Layer ${t} not found in showBoundaryLayers.`)})}hideBoundaryLayers(){console.log("[DEBUG] hideBoundaryLayers called."),this.boundaryLayerIds.forEach(t=>{if(this.map.getLayer(t))if(t==="boundary-fill"){let o=this.map.getPaintProperty(t,"fill-opacity")||.03;const a=()=>{if(o>0){o-=.005;const n=Math.max(0,o);this.map.setPaintProperty(t,"fill-opacity",n),n>0?requestAnimationFrame(a):this.map.setLayoutProperty(t,"visibility","none")}else this.map.setLayoutProperty(t,"visibility","none")};a()}else this.map.setLayoutProperty(t,"visibility","none");else console.warn(`[DEBUG] Layer ${t} not found in hideBoundaryLayers.`)})}updateSearchRadius(t){if(!this.map.getSource(this.searchRadiusId)){console.warn("[DEBUG] updateSearchRadius - Source not found:",this.searchRadiusId);return}const a=((n,l,s=64)=>{const i={latitude:n[1],longitude:n[0]},c=l/1e3,r=[],p=c/(111.32*Math.cos(i.latitude*Math.PI/180)),g=c/110.574;for(let u=0;u<s;u++){const b=u/s*(2*Math.PI),C=p*Math.cos(b),x=g*Math.sin(b);r.push([i.longitude+C,i.latitude+x])}return r.push(r[0]),r})(t,this.radiusInMeters);[this.searchRadiusId,this.searchRadiusOuterId].forEach(n=>{const l=this.map.getSource(n);l?l.setData({type:"Feature",geometry:{type:"Polygon",coordinates:[a]}}):console.warn(`[DEBUG] updateSearchRadius - Source not found during update: ${n}`)})}clearSearchRadius(){this.map.getSource(this.searchRadiusId)?[this.searchRadiusId,this.searchRadiusOuterId].forEach(t=>{const o=this.map.getSource(t);o?o.setData({type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}}):console.warn(`[DEBUG] clearSearchRadius - Source not found: ${t}`)}):console.warn("[DEBUG] clearSearchRadius - Source not found initially:",this.searchRadiusId)}handleGeolocationError(t){console.error("[DEBUG] handleGeolocationError called with error:",t),console.error("Geolocation error code:",t.code),console.error("Geolocation error message:",t.message);const o={1:"Locatie toegang geweigerd. Schakel het in bij je instellingen.",2:"Locatie niet beschikbaar. Controleer je apparaat instellingen.",3:"Verzoek verlopen. Probeer opnieuw.",default:"Er is een fout opgetreden bij het ophalen van je locatie."};this.showNotification(o[t.code]||o.default)}showNotification(t){console.log("[DEBUG] Displaying notification:",t);const o=document.createElement("div");o.className="geolocation-error-notification",o.textContent=t,document.body.appendChild(o),setTimeout(()=>o.remove(),5e3)}createBoundaryCircle(){const t={latitude:this.centerPoint[1],longitude:this.centerPoint[0]},o=this.boundaryRadius,a=[],n=o/(111.32*Math.cos(t.latitude*Math.PI/180)),l=o/110.574;for(let s=0;s<=64;s++){const i=s/64*(2*Math.PI),c=n*Math.cos(i),r=l*Math.sin(i);a.push([t.longitude+c,t.latitude+r])}return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[a]}}}isWithinBoundary(t){return this.calculateDistance(t[1],t[0],this.centerPoint[1],this.centerPoint[0])<=this.boundaryRadius}calculateDistance(t,o,a,n){const l=p=>p*(Math.PI/180),s=l(a-t),i=l(n-o),c=Math.sin(s/2)*Math.sin(s/2)+Math.cos(l(t))*Math.cos(l(a))*Math.sin(i/2)*Math.sin(i/2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}showBoundaryPopup(){console.log("[DEBUG] showBoundaryPopup started.");const t=document.querySelector(".location-boundary-popup");t&&(console.log("[DEBUG] Removing existing location-boundary-popup."),t.remove());const o=document.createElement("div");o.className="location-boundary-popup",console.log("[DEBUG] Created new popup element.");const a=document.createElement("h3");a.textContent="Kom naar Heerlen";const n=document.createElement("p");n.textContent="Deze functie is alleen beschikbaar binnen de blauwe cirkel op de kaart. Kom naar het centrum van Heerlen om de interactieve kaart te gebruiken!";const l=document.createElement("button");l.textContent="Ik kom er aan!";const s=this;l.addEventListener("click",function(){console.log("[DEBUG] Boundary popup button clicked."),window.innerWidth<=768?o.style.transform="translateY(100%)":o.style.transform="translateX(120%)",setTimeout(()=>{console.log("[DEBUG] Removing boundary popup after click."),o.remove()},600),setTimeout(()=>{console.log("[DEBUG] Hiding boundary layers after popup button click."),s.hideBoundaryLayers()},200);const i=window.matchMedia("(max-width: 479px)").matches?17:18;console.log("[DEBUG] Flying back to intro location after popup button click."),d.flyTo({center:v.MAP.center,zoom:i,pitch:55,bearing:-17.6,duration:3e3,essential:!0,easing:c=>c*(2-c)})}),o.appendChild(a),o.appendChild(n),o.appendChild(l),document.body.appendChild(o),console.log("[DEBUG] Boundary popup appended to document body."),this.map.getLayer("boundary-fill")?(console.log("[DEBUG] Highlighting boundary layers."),this.map.setPaintProperty("boundary-fill","fill-opacity",.05),this.map.setPaintProperty("boundary-line","line-width",3),setTimeout(()=>{console.log("[DEBUG] Resetting boundary layer highlight."),this.map.getLayer("boundary-fill")&&this.map.setPaintProperty("boundary-fill","fill-opacity",.03),this.map.getLayer("boundary-line")&&this.map.setPaintProperty("boundary-line","line-width",2)},2e3)):console.warn("[DEBUG] Boundary layers not found for highlighting in showBoundaryPopup."),!this.map.isMoving()&&!this.map.isEasing()?(console.log("[DEBUG] Flying to boundary center to show the area."),this.map.flyTo({center:this.centerPoint,zoom:14,pitch:0,bearing:0,duration:1500})):console.log("[DEBUG] Skipping flyTo center in showBoundaryPopup because map is already moving."),requestAnimationFrame(()=>{o.offsetHeight,o.classList.add("show"),console.log("[DEBUG] Added 'show' class to boundary popup.")}),console.log("[DEBUG] showBoundaryPopup finished.")}};const C1=new m1(d);window.geolocationManager=C1;//! ============= DATA LOADING (ROBUST VERSION) =============
function f(e,t,o="value",a=null,n=!1,l=-1,s="item"){if(!e)return console.warn(`[getRobustValue] Invalid parentElement provided for selector '${t}'`),a;const i=e.querySelector(t);return i?o in i?i[o]:(console.warn(`[Data Loading] Property '${o}' not found on element with selector '${t}' in ${s} item ${l}. Using default.`),a):(n&&console.warn(`[Data Loading] Required element with selector '${t}' not found in ${s} item ${l}. Cannot process fully.`),a)}function N(){console.log("[Data Loading] Starting getGeoData...");const e=document.getElementById("location-list");let t=0,o=0;if(!e){console.error("[Data Loading] CRITICAL: Element with ID 'location-list' not found. Cannot load geo data.");return}Array.from(e.childNodes).filter(a=>a.nodeType===Node.ELEMENT_NODE).forEach((a,n)=>{const l=f(a,"#locationLatitude","value",null,!0,n,"location"),s=f(a,"#locationLongitude","value",null,!0,n,"location"),i=f(a,"#locationID","value",`missing-id-${n}`,!0,n,"location"),c=parseFloat(l),r=parseFloat(s);if(isNaN(c)||isNaN(r)){console.warn(`[Data Loading] Skipping location item ${n} (Attempted ID: ${i}) due to invalid or missing coordinates. Lat='${l}', Long='${s}'`),o++;return}const p={locationLat:c,locationLong:r,locationID:i,name:f(a,"#name","value","Naamloos",!1,n,"location"),locationInfo:f(a,".locations-map_card","innerHTML","<p>Geen informatie beschikbaar</p>",!1,n,"location"),ondernemerkleur:f(a,"#ondernemerkleur","value","#A0A0A0",!1,n,"location"),descriptionv2:f(a,"#descriptionv2","value","",!1,n,"location"),icon:f(a,"#icon","value",null,!1,n,"location"),image:f(a,"#image","value",null,!1,n,"location"),category:f(a,"#category","value","Overig",!1,n,"location"),telefoonummer:f(a,"#telefoonnummer","value","",!1,n,"location"),locatie:f(a,"#locatie","value","",!1,n,"location"),maps:f(a,"#maps","value",null,!1,n,"location"),website:f(a,"#website","value",null,!1,n,"location"),instagram:f(a,"#instagram","value",null,!1,n,"location"),facebook:f(a,"#facebook","value",null,!1,n,"location")},g={type:"Feature",geometry:{type:"Point",coordinates:[p.locationLong,p.locationLat]},properties:{id:p.locationID,description:p.locationInfo,arrayID:n,color:p.ondernemerkleur,name:p.name,icon:p.icon,image:p.image,category:p.category,telefoonummer:p.telefoonummer,locatie:p.locatie,maps:p.maps,website:p.website,descriptionv2:p.descriptionv2,instagram:p.instagram,facebook:p.facebook}};T.features.some(u=>u.properties.id===p.locationID)?(console.warn(`[Data Loading] Duplicate location ID found and skipped: ${p.locationID} at index ${n}`),o++):(T.features.push(g),t++)}),console.log(`[Data Loading] getGeoData finished. Loaded: ${t}, Skipped (invalid/duplicate): ${o}`)}function U(){console.log("[Data Loading] Starting getARData...");const e=document.getElementById("location-ar-list");let t=0,o=0;const a=T.features.length;if(!e){console.error("[Data Loading] CRITICAL: Element with ID 'location-ar-list' not found. Cannot load AR data.");return}Array.from(e.childNodes).filter(n=>n.nodeType===Node.ELEMENT_NODE).forEach((n,l)=>{const s=l,i=f(n,"#latitude_ar","value",null,!0,s,"AR"),c=f(n,"#longitude_ar","value",null,!0,s,"AR"),r=f(n,"#name_ar","value",`AR Item ${s}`,!0,s,"AR"),p=parseFloat(i),g=parseFloat(c);if(isNaN(p)||isNaN(g)){console.warn(`[Data Loading] Skipping AR item ${s} (Name: ${r}) due to invalid or missing coordinates. Lat='${i}', Long='${c}'`),o++;return}const u={latitude_ar:p,longitude_ar:g,name_ar:r,slug_ar:f(n,"#slug_ar","value","",!1,s,"AR"),image_ar:f(n,"#image_ar","value",null,!1,s,"AR"),description_ar:f(n,"#description_ar","value","Geen beschrijving.",!1,s,"AR"),arkleur:f(n,"#arkleur","value","#A0A0A0",!1,l,"location"),icon_ar:f(n,"#icon_ar","value",null,!1,s,"AR"),instructie:f(n,"#instructie","value","Geen instructie beschikbaar.",!1,s,"AR"),link_ar_mobile:f(n,"#link_ar_mobile","value",null,!1,s,"AR"),link_ar_desktop:f(n,"#link_ar_desktop","value",null,!1,s,"AR"),category:f(n,"#category","value",null,!1,s,"AR")};if(!u.link_ar_mobile&&!u.link_ar_desktop){console.warn(`[Data Loading] Skipping AR item ${s} (Name: ${r}) due to missing required AR links (both mobile and desktop).`),o++;return}const b={type:"Feature",geometry:{type:"Point",coordinates:[u.longitude_ar,u.latitude_ar]},properties:{type:"ar",name:u.name_ar,slug:u.slug_ar,description:u.description_ar,arrayID:a+l,image:u.image_ar,arkleur:u.arkleur,icon:u.icon_ar,instructie:u.instructie,link_ar_mobile:u.link_ar_mobile,link_ar_desktop:u.link_ar_desktop,category:u.category}};T.features.push(b),t++}),console.log(`[Data Loading] getARData finished. Loaded: ${t}, Skipped (invalid/missing required): ${o}`)}document.addEventListener("DOMContentLoaded",()=>{T.features=[],N(),U(),d.getSource("locations")?(d.getSource("locations").setData(T),console.log("[Data Loading] Map source 'locations' updated.")):console.log("[Data Loading] Map source 'locations' not found yet, will be added later.")}),N(),U();//! ============= MARKER MANAGEMENT =============
function g1(){[...new Set(T.features.map(t=>t.properties.icon))].forEach(t=>{d.loadImage(t,(o,a)=>{if(o)throw o;d.addImage(t,a)})})}function h1(){if(Z)return;d.addSource("locations",{type:"geojson",data:T}),[{id:"location-markers",type:"circle",paint:{"circle-color":["case",["==",["get","type"],"ar"],["get","arkleur"],["get","color"]],"circle-radius":["interpolate",["linear"],["zoom"],v.MARKER_ZOOM.min,2,v.MARKER_ZOOM.small,5,v.MARKER_ZOOM.medium,8,v.MARKER_ZOOM.large,10],"circle-stroke-width":1,"circle-stroke-color":"#ffffff","circle-opacity":0}},{id:"location-icons",type:"symbol",layout:{"icon-image":["get","icon"],"icon-size":["interpolate",["linear"],["zoom"],v.MARKER_ZOOM.min,.05,v.MARKER_ZOOM.small,.08,v.MARKER_ZOOM.medium,.12,v.MARKER_ZOOM.large,.15],"icon-allow-overlap":!0,"icon-anchor":"center"},paint:{"icon-opacity":0}},{id:"location-labels",type:"symbol",layout:{"text-field":["get","name"],"text-size":["interpolate",["linear"],["zoom"],v.MARKER_ZOOM.min,8,v.MARKER_ZOOM.small,10,v.MARKER_ZOOM.medium,11,v.MARKER_ZOOM.large,12],"text-offset":[0,1],"text-anchor":"top","text-allow-overlap":!1},paint:{"text-color":["get","color"],"text-halo-color":"#ffffff","text-halo-width":2,"text-opacity":0}}].forEach(a=>d.addLayer({...a,source:"locations"}));let t=0;const o=()=>{t+=.1,d.setPaintProperty("location-markers","circle-opacity",t),d.setPaintProperty("location-icons","icon-opacity",t),d.setPaintProperty("location-labels","text-opacity",t),t<1&&requestAnimationFrame(o)};setTimeout(o,100),Z=!0}d.on("mouseenter","location-markers",()=>{d.getCanvas().style.cursor="pointer"}),d.on("mouseleave","location-markers",()=>{d.getCanvas().style.cursor=""});//! ============= MARKER FILTERING =============
function x1(){document.querySelectorAll(".filter-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.category;t&&(R.has(t)?(R.delete(t),e.classList.remove("is--active")):(R.add(t),e.classList.add("is--active")),B(),p1())})})}function B(){const e=R.size===0?null:["in",["get","category"],["literal",Array.from(R)]];["location-markers","location-icons","location-labels"].forEach(o=>{if(d.getLayer(o))try{d.setFilter(o,e)}catch(a){console.warn(`Kon filter niet toepassen op laag ${o}:`,a)}})}//! ============= POPUP MANAGEMENT =============
function f1(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768?{link:e.link_ar_mobile,available:!!e.link_ar_mobile,deviceType:"mobile"}:{link:e.link_ar_desktop,available:!!e.link_ar_desktop,deviceType:"desktop"}}function q(e,t="impressie-button button-base",o="Start AR"){const a=f1(e);return a.available?a.deviceType==="mobile"&&a.link.startsWith("snapchat://")?`<button class="${t}" onclick="handleSnapchatLink('${a.link}')">${o}</button>`:`<button class="${t}" onclick="window.open('${a.link}', '_blank')">${o}</button>`:a.deviceType==="desktop"?`<button class="${t} disabled" disabled title="Deze AR-ervaring is alleen beschikbaar op mobiele apparaten">
                ${o} <span class="mobile-only">📱</span>
              </button>`:""}window.handleSnapchatLink=function(e){const n=/Android/i.test(navigator.userAgent)?"https://play.google.com/store/apps/details?id=com.snapchat.android":"https://apps.apple.com/app/snapchat/id447188370",l=Date.now(),s=1e3;window.location.href=e,setTimeout(function(){Date.now()-l<s+100&&confirm("Om deze AR ervaring te gebruiken heb je Snapchat nodig. Wil je Snapchat downloaden?")&&(window.location.href=n)},s)};function z(e){const t=e.type==="ar",o=`
    <style>
      .popup-side {
        background-color: ${e.color||"#6B46C1"};
        clip-path: polygon(calc(100% - 0px) 26.5px, calc(100% - 0px) calc(100% - 26.5px), calc(100% - 0px) calc(100% - 26.5px), calc(100% - 0.34671999999995px) calc(100% - 22.20048px), calc(100% - 1.3505599999999px) calc(100% - 18.12224px), calc(100% - 2.95704px) calc(100% - 14.31976px), calc(100% - 5.11168px) calc(100% - 10.84752px), calc(100% - 7.76px) calc(100% - 7.76px), calc(100% - 10.84752px) calc(100% - 5.11168px), calc(100% - 14.31976px) calc(100% - 2.9570399999999px), calc(100% - 18.12224px) calc(100% - 1.35056px), calc(100% - 22.20048px) calc(100% - 0.34672px), calc(100% - 26.5px) calc(100% - 0px), calc(50% - -32.6px) calc(100% - 0px), calc(50% - -32.6px) calc(100% - 0px), calc(50% - -31.57121px) calc(100% - 0.057139999999947px), calc(50% - -30.56648px) calc(100% - 0.2255199999999px), calc(50% - -29.59427px) calc(100% - 0.50057999999996px), calc(50% - -28.66304px) calc(100% - 0.87775999999991px), calc(50% - -27.78125px) calc(100% - 1.3525px), calc(50% - -26.95736px) calc(100% - 1.92024px), calc(50% - -26.19983px) calc(100% - 2.57642px), calc(50% - -25.51712px) calc(100% - 3.31648px), calc(50% - -24.91769px) calc(100% - 4.13586px), calc(50% - -24.41px) calc(100% - 5.03px), calc(50% - -24.41px) calc(100% - 5.03px), calc(50% - -22.95654px) calc(100% - 7.6045699999999px), calc(50% - -21.23752px) calc(100% - 9.9929599999998px), calc(50% - -19.27298px) calc(100% - 12.17519px), calc(50% - -17.08296px) calc(100% - 14.13128px), calc(50% - -14.6875px) calc(100% - 15.84125px), calc(50% - -12.10664px) calc(100% - 17.28512px), calc(50% - -9.36042px) calc(100% - 18.44291px), calc(50% - -6.46888px) calc(100% - 19.29464px), calc(50% - -3.45206px) calc(100% - 19.82033px), calc(50% - -0.32999999999998px) calc(100% - 20px), calc(50% - -0.32999999999998px) calc(100% - 20px), calc(50% - 2.79179px) calc(100% - 19.82033px), calc(50% - 5.8079199999999px) calc(100% - 19.29464px), calc(50% - 8.69853px) calc(100% - 18.44291px), calc(50% - 11.44376px) calc(100% - 17.28512px), calc(50% - 14.02375px) calc(100% - 15.84125px), calc(50% - 16.41864px) calc(100% - 14.13128px), calc(50% - 18.60857px) calc(100% - 12.17519px), calc(50% - 20.57368px) calc(100% - 9.9929599999999px), calc(50% - 22.29411px) calc(100% - 7.60457px), calc(50% - 23.75px) calc(100% - 5.03px), calc(50% - 23.75px) calc(100% - 5.03px), calc(50% - 24.25769px) calc(100% - 4.1358599999999px), calc(50% - 24.85712px) calc(100% - 3.3164799999998px), calc(50% - 25.53983px) calc(100% - 2.57642px), calc(50% - 26.29736px) calc(100% - 1.92024px), calc(50% - 27.12125px) calc(100% - 1.3525px), calc(50% - 28.00304px) calc(100% - 0.87775999999997px), calc(50% - 28.93427px) calc(100% - 0.50057999999996px), calc(50% - 29.90648px) calc(100% - 0.22552000000002px), calc(50% - 30.91121px) calc(100% - 0.057140000000004px), calc(50% - 31.94px) calc(100% - 0px), 26.5px calc(100% - 0px), 26.5px calc(100% - 0px), 22.20048px calc(100% - 0.34671999999989px), 18.12224px calc(100% - 1.3505599999999px), 14.31976px calc(100% - 2.95704px), 10.84752px calc(100% - 5.1116799999999px), 7.76px calc(100% - 7.76px), 5.11168px calc(100% - 10.84752px), 2.95704px calc(100% - 14.31976px), 1.35056px calc(100% - 18.12224px), 0.34672px calc(100% - 22.20048px), 4.3855735949631E-31px calc(100% - 26.5px), 0px 26.5px, 0px 26.5px, 0.34672px 22.20048px, 1.35056px 18.12224px, 2.95704px 14.31976px, 5.11168px 10.84752px, 7.76px 7.76px, 10.84752px 5.11168px, 14.31976px 2.95704px, 18.12224px 1.35056px, 22.20048px 0.34672px, 26.5px 4.3855735949631E-31px, calc(50% - 26.74px) 0px, calc(50% - 26.74px) 0px, calc(50% - 25.31263px) 0.07137px, calc(50% - 23.91544px) 0.28176px, calc(50% - 22.55581px) 0.62559px, calc(50% - 21.24112px) 1.09728px, calc(50% - 19.97875px) 1.69125px, calc(50% - 18.77608px) 2.40192px, calc(50% - 17.64049px) 3.22371px, calc(50% - 16.57936px) 4.15104px, calc(50% - 15.60007px) 5.17833px, calc(50% - 14.71px) 6.3px, calc(50% - 14.71px) 6.3px, calc(50% - 13.6371px) 7.64798px, calc(50% - 12.446px) 8.89024px, calc(50% - 11.1451px) 10.01826px, calc(50% - 9.7428px) 11.02352px, calc(50% - 8.2475px) 11.8975px, calc(50% - 6.6676px) 12.63168px, calc(50% - 5.0115px) 13.21754px, calc(50% - 3.2876px) 13.64656px, calc(50% - 1.5043px) 13.91022px, calc(50% - -0.32999999999996px) 14px, calc(50% - -0.32999999999998px) 14px, calc(50% - -2.16431px) 13.9105px, calc(50% - -3.94768px) 13.6476px, calc(50% - -5.67177px) 13.2197px, calc(50% - -7.32824px) 12.6352px, calc(50% - -8.90875px) 11.9025px, calc(50% - -10.40496px) 11.03px, calc(50% - -11.80853px) 10.0261px, calc(50% - -13.11112px) 8.8992px, calc(50% - -14.30439px) 7.6577px, calc(50% - -15.38px) 6.31px, calc(50% - -15.38px) 6.31px, calc(50% - -16.27279px) 5.18562px, calc(50% - -17.25432px) 4.15616px, calc(50% - -18.31733px) 3.22714px, calc(50% - -19.45456px) 2.40408px, calc(50% - -20.65875px) 1.6925px, calc(50% - -21.92264px) 1.09792px, calc(50% - -23.23897px) 0.62586px, calc(50% - -24.60048px) 0.28184px, calc(50% - -25.99991px) 0.07138px, calc(50% - -27.43px) 8.9116630386686E-32px, calc(100% - 26.5px) 0px, calc(100% - 26.5px) 0px, calc(100% - 22.20048px) 0.34672px, calc(100% - 18.12224px) 1.35056px, calc(100% - 14.31976px) 2.95704px, calc(100% - 10.84752px) 5.11168px, calc(100% - 7.76px) 7.76px, calc(100% - 5.11168px) 10.84752px, calc(100% - 2.9570399999999px) 14.31976px, calc(100% - 1.35056px) 18.12224px, calc(100% - 0.34671999999995px) 22.20048px, calc(100% - 5.6843418860808E-14px) 26.5px);
      }
       
    
.fade-bottom {
  position: absolute;
  bottom: 6.5em;
  left: 20px;
  right: 20px;
  height: 3.5em;
  /* Gebruik dezelfde kleur als de popup maar met transparantie */
  background: linear-gradient(to top, ${e.color||"#6B46C1"} 0%, ${e.color||"#6B46C1"}00 100%);
  pointer-events: none;
  z-index: 2;
  transition: opacity 0.3s ease;
}

.popup-side.ar .fade-bottom {
  background: linear-gradient(to top, ${e.arkleur||"#6B46C1"} 0%, ${e.arkleur||"#6B46C1"}00 100%);
}

/* CSS voor de top fade gradient */
.fade-top {
  position: absolute;
  bottom: 18em;
  left: 20px;
  right: 20px;
  height: 3.5em;
  /* Gespiegelde gradient vergeleken met de bottom fade */
  background: linear-gradient(to bottom, ${e.color||"#6B46C1"} 0%, ${e.color||"#6B46C1"}00 100%);
  pointer-events: none;
  z-index: 2;
  transition: opacity 0.3s ease;
}

      
  /* Add the mobile media query here */
  @media screen and (max-width: 767px) {
  .fade-top {
  bottom: 14em !important;
   }
 }

/* Voor AR-popups een aparte styling */
.popup-side.ar .fade-top {
  background: linear-gradient(to bottom, ${e.arkleur||"#6B46C1"} 0%, ${e.arkleur||"#6B46C1"}00 100%);
}

    .close-button {
      background: ${e.color||"#6B46C1"};
    }
    
    /* Stijlen voor AR popup - met zwarte tekst */
    .popup-side.ar {
      background-color: ${e.arkleur||"#6B46C1"};
      color: #000000;
    }
    
    .close-button.ar {
      background: ${e.arkleur||"#6B46C1"};
    }
    
    /* Kleur aanpassingen voor AR elementen */
    .popup-side.ar .popup-title {
      color: #000000;
    }
    
    .popup-side.ar .popup-description {
      color: #000000;
    }
    
    /* Knoppen in AR popup */
    .popup-side.ar .button-base {
      color: #000000;
      border-color: #000000;
    }
    
    /* Styling voor achterkant van de popup */
    .popup-side.ar.popup-back {
      color: #000000;
      background-color: ${e.arkleur||"#6B46C1"};
    }
    
    /* Zwarte tekst in AR popup details */
    .popup-side.ar .popup-title.details {
      color: #000000;
    }
    
    /* Maak ook de 'X' in de sluitknop zwart */
    .close-button.ar::before,
    .close-button.ar::after {
      background-color: #000000;
    }
    
    ${t?`
      .ar-button {
        border: 2px solid black;
        font-weight: bold;
        color: #000000;
      }
      .ar-description {
        font-size: 0.9em;
        margin-top: 10px;
        color: #000000;
      }
    `:""}
  </style>
  `;return t?{styles:o,html:`
      <div class="popup-wrapper">
        <button class="close-button ar" aria-label="Close popup"></button>
        <div class="popup-side ar popup-front">
          <svg class="popup-border-overlay" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M0 227.13V240.82C0 246.99 5 252 11.18 252H19.2C25.38 252 30.38 246.99 30.38 240.82C30.38 246.99 35.4 252 41.56 252H49.6C55.75 252 60.75 247.01 60.76 240.85C60.79 247.01 65.79 252 71.94 252H79.98C86.15 252 91.16 246.99 91.16 240.82C91.16 246.99 96.16 252 102.34 252H110.36C116.53 252 121.53 247.01 121.54 240.84C121.55 247.01 126.55 252 132.72 252H140.74C146.35 252 150.99 247.87 151.79 242.48C152.6 247.87 157.24 252 162.85 252H170.87C177.04 252 182.04 247 182.05 240.84C182.06 247 187.06 252 193.23 252H201.25C207.03 252 211.78 247.62 212.36 242C212.95 247.62 217.7 252 223.48 252H231.5C237.68 252 242.68 246.99 242.68 240.82C242.68 246.99 247.69 252 253.86 252H261.89C268.05 252 273.05 247.01 273.06 240.85C273.08 247.01 278.08 252 284.24 252H292.27C298.44 252 303.45 246.99 303.45 240.82C303.45 246.99 308.46 252 314.63 252H322.66C328.82 252 333.82 247.01 333.83 240.84C333.85 247.01 338.85 252 345.01 252H353.04C359.21 252 364.22 246.99 364.22 240.82V227.13C364.22 220.95 359.21 215.95 353.04 215.95C359.21 215.95 364.22 210.94 364.22 204.77V191.07C364.22 184.9 359.21 179.89 353.04 179.89C359.21 179.89 364.22 174.89 364.22 168.71V155.02C364.22 149.52 360.25 144.96 355.02 144.03C360.25 143.09 364.22 138.53 364.22 133.03V119.34C364.22 113.17 359.22 108.17 353.06 108.16C359.22 108.16 364.22 103.15 364.22 96.98V83.29C364.22 77.11 359.21 72.11 353.04 72.11C359.21 72.11 364.22 67.1 364.22 60.93V47.23C364.22 41.06 359.21 36.05 353.04 36.05C359.21 36.05 364.22 31.05 364.22 24.87V11.18C364.22 5.01 359.21 0 353.04 0H345.01C338.85 0 333.85 4.99 333.83 11.16C333.82 4.99 328.82 0 322.66 0H314.63C308.46 0 303.45 5.01 303.45 11.18C303.45 5.01 298.44 0 292.27 0H284.24C278.08 0 273.08 4.99 273.06 11.16C273.05 4.99 268.05 0 261.89 0H253.86C247.69 0 242.68 5.01 242.68 11.18C242.68 5.01 237.68 0 231.5 0H223.48C217.7 0 212.95 4.38 212.36 10C211.78 4.38 207.03 0 201.25 0H193.23C187.06 0 182.06 5 182.05 11.16C182.04 5 177.04 0 170.87 0H162.85C157.24 0 152.6 4.13 151.79 9.52C150.99 4.13 146.35 0 140.74 0H132.72C126.55 0 121.55 4.99 121.54 11.16C121.53 4.99 116.53 0 110.36 0H102.34C96.16 0 91.16 5.01 91.16 11.18C91.16 5.01 86.15 0 79.98 0H71.94C65.79 0 60.79 4.99 60.76 11.16C60.75 4.99 55.75 0 49.6 0H41.56C35.4 0 30.38 5.01 30.38 11.18C30.38 5.01 25.38 0 19.2 0H11.18C5 0 0 5.01 0 11.18V24.87C0 31.05 5 36.05 11.18 36.05C5 36.05 0 41.06 0 47.23V60.93C0 67.1 5 72.11 11.18 72.11C5 72.11 0 77.11 0 83.29V96.98C0 103.15 4.99 108.15 11.16 108.16C4.99 108.17 0 113.17 0 119.34V133.03C0 138.53 3.97 143.09 9.19 144.03C3.97 144.96 0 149.52 0 155.02V168.71C0 174.89 5 179.89 11.18 179.89C5 179.89 0 184.9 0 191.07V204.77C0 210.94 5 215.95 11.18 215.95C5 215.95 0 220.95 0 227.13ZM333.83 24.89C333.85 31.06 338.85 36.05 345.01 36.05C338.85 36.05 333.85 41.05 333.83 47.21C333.82 41.05 328.82 36.05 322.66 36.05C328.82 36.05 333.82 31.06 333.83 24.89ZM333.83 60.95C333.85 67.11 338.85 72.11 345.01 72.11C338.85 72.11 333.85 77.1 333.83 83.27C333.82 77.1 328.82 72.11 322.66 72.11C328.82 72.11 333.82 67.11 333.83 60.95ZM333.83 119.32C333.82 113.16 328.83 108.17 322.68 108.16C328.83 108.16 333.82 103.16 333.83 97C333.85 103.16 338.83 108.15 344.99 108.16C338.83 108.17 333.85 113.16 333.83 119.32ZM343.03 144.03C337.81 144.96 333.84 149.51 333.83 155C333.82 149.51 329.86 144.96 324.64 144.03C329.86 143.09 333.82 138.54 333.83 133.05C333.83 138.54 337.81 143.09 343.03 144.03ZM333.83 168.73C333.85 174.9 338.85 179.89 345.01 179.89C338.85 179.89 333.85 184.89 333.83 191.05C333.82 184.89 328.82 179.89 322.66 179.89C328.82 179.89 333.82 174.9 333.83 168.73ZM333.83 204.79C333.85 210.95 338.85 215.95 345.01 215.95C338.85 215.95 333.85 220.94 333.83 227.11C333.82 220.94 328.82 215.95 322.66 215.95C328.82 215.95 333.82 210.95 333.83 204.79ZM303.45 24.87C303.45 31.05 308.46 36.05 314.63 36.05C308.46 36.05 303.45 41.06 303.45 47.23C303.45 41.06 298.44 36.05 292.27 36.05C298.44 36.05 303.45 31.05 303.45 24.87ZM303.45 60.93C303.45 67.1 308.46 72.11 314.63 72.11C308.46 72.11 303.45 77.11 303.45 83.29C303.45 77.11 298.44 72.11 292.27 72.11C298.44 72.11 303.45 67.1 303.45 60.93ZM303.45 119.34C303.45 113.17 298.45 108.17 292.29 108.16C298.45 108.16 303.45 103.15 303.45 96.98C303.45 103.15 308.45 108.15 314.61 108.16C308.45 108.17 303.45 113.17 303.45 119.34ZM312.64 144.03C307.42 144.96 303.45 149.52 303.45 155.02C303.45 149.52 299.48 144.96 294.25 144.03C299.48 143.09 303.45 138.53 303.45 133.03C303.45 138.53 307.42 143.09 312.64 144.03ZM303.45 168.71C303.45 174.89 308.46 179.89 314.63 179.89C308.46 179.89 303.45 184.9 303.45 191.07C303.45 184.9 298.44 179.89 292.27 179.89C298.44 179.89 303.45 174.89 303.45 168.71ZM303.45 204.77C303.45 210.94 308.46 215.95 314.63 215.95C308.46 215.95 303.45 220.95 303.45 227.13C303.45 220.95 298.44 215.95 292.27 215.95C298.44 215.95 303.45 210.94 303.45 204.77ZM273.06 24.9C273.08 31.06 278.08 36.05 284.24 36.05C278.08 36.05 273.08 41.05 273.06 47.21C273.05 41.05 268.05 36.05 261.89 36.05C268.05 36.05 273.05 31.06 273.06 24.9ZM273.06 60.95C273.08 67.11 278.08 72.11 284.24 72.11C278.08 72.11 273.08 77.1 273.06 83.26C273.05 77.1 268.05 72.11 261.89 72.11C268.05 72.11 273.05 67.11 273.06 60.95ZM273.06 119.31C273.05 113.16 268.06 108.17 261.91 108.16C268.06 108.16 273.05 103.16 273.06 97.01C273.08 103.16 278.07 108.15 284.22 108.16C278.07 108.17 273.08 113.16 273.06 119.31ZM282.26 144.03C277.04 144.96 273.08 149.51 273.06 154.99C273.05 149.51 269.09 144.96 263.87 144.03C269.09 143.09 273.05 138.54 273.06 133.06C273.08 138.54 277.04 143.09 282.26 144.03ZM273.06 168.74C273.08 174.9 278.08 179.89 284.24 179.89C278.08 179.89 273.08 184.89 273.06 191.05C273.05 184.89 268.05 179.89 261.89 179.89C268.05 179.89 273.05 174.9 273.06 168.74ZM273.06 204.79C273.08 210.95 278.08 215.95 284.24 215.95C278.08 215.95 273.08 220.94 273.06 227.1C273.05 220.94 268.05 215.95 261.89 215.95C268.05 215.95 273.05 210.95 273.06 204.79ZM242.68 24.87C242.68 31.05 247.69 36.05 253.86 36.05C247.69 36.05 242.68 41.06 242.68 47.23C242.68 41.06 237.68 36.05 231.5 36.05C237.68 36.05 242.68 31.05 242.68 24.87ZM242.68 60.93C242.68 67.1 247.69 72.11 253.86 72.11C247.69 72.11 242.68 77.11 242.68 83.29C242.68 77.11 237.68 72.11 231.5 72.11C237.68 72.11 242.68 67.1 242.68 60.93ZM242.68 119.34C242.68 113.17 237.69 108.17 231.52 108.16C237.69 108.16 242.68 103.15 242.68 96.98C242.68 103.15 247.68 108.15 253.84 108.16C247.68 108.17 242.68 113.17 242.68 119.34ZM251.87 144.03C246.65 144.96 242.68 149.52 242.68 155.02C242.68 149.52 238.71 144.96 233.49 144.03C238.71 143.09 242.68 138.53 242.68 133.03C242.68 138.53 246.65 143.09 251.87 144.03ZM242.68 168.71C242.68 174.89 247.69 179.89 253.86 179.89C247.69 179.89 242.68 184.9 242.68 191.07C242.68 184.9 237.68 179.89 231.5 179.89C237.68 179.89 242.68 174.89 242.68 168.71ZM242.68 204.77C242.68 210.94 247.69 215.95 253.86 215.95C247.69 215.95 242.68 220.95 242.68 227.13C242.68 220.95 237.68 215.95 231.5 215.95C237.68 215.95 242.68 210.94 242.68 204.77ZM212.36 26.05C212.95 31.68 217.7 36.05 223.48 36.05C217.7 36.05 212.95 40.43 212.36 46.05C211.78 40.43 207.03 36.05 201.25 36.05C207.03 36.05 211.78 31.68 212.36 26.05ZM212.36 62.11C212.95 67.73 217.7 72.11 223.48 72.11C217.7 72.11 212.95 76.48 212.36 82.11C211.78 76.48 207.03 72.11 201.25 72.11C207.03 72.11 211.78 67.73 212.36 62.11ZM212.36 118.16C211.78 112.54 207.04 108.17 201.28 108.16C207.04 108.16 211.78 103.78 212.36 98.16C212.95 103.78 217.69 108.15 223.46 108.16C217.69 108.17 212.95 112.54 212.36 118.16ZM221.49 144.03C216.64 144.89 212.88 148.88 212.36 153.85C211.86 148.88 208.1 144.89 203.24 144.03C208.1 143.16 211.86 139.17 212.36 134.2C212.88 139.17 216.64 143.16 221.49 144.03ZM212.36 169.89C212.95 175.52 217.7 179.89 223.48 179.89C217.7 179.89 212.95 184.27 212.36 189.89C211.78 184.27 207.03 179.89 201.25 179.89C207.03 179.89 211.78 175.52 212.36 169.89ZM212.36 205.95C212.95 211.57 217.7 215.95 223.48 215.95C217.7 215.95 212.95 220.32 212.36 225.95C211.78 220.32 207.03 215.95 201.25 215.95C207.03 215.95 211.78 211.57 212.36 205.95ZM182.05 24.89C182.06 31.06 187.06 36.05 193.23 36.05C187.06 36.05 182.06 41.05 182.05 47.22C182.04 41.05 177.04 36.05 170.87 36.05C177.04 36.05 182.04 31.06 182.05 24.89ZM182.05 60.95C182.06 67.11 187.06 72.11 193.23 72.11C187.06 72.11 182.06 77.1 182.05 83.27C182.04 77.1 177.04 72.11 170.87 72.11C177.04 72.11 182.04 67.11 182.05 60.95ZM182.05 119.32C182.04 113.16 177.05 108.17 170.9 108.16C177.05 108.16 182.04 103.16 182.05 97C182.06 103.16 187.05 108.15 193.22 108.16C187.05 108.17 182.06 113.16 182.05 119.32ZM191.24 144.03C186.03 144.96 182.06 149.51 182.05 155C182.04 149.51 178.09 144.96 172.86 144.03C178.09 143.09 182.04 138.54 182.05 133.05C182.06 138.54 186.03 143.09 191.24 144.03ZM182.05 168.73C182.06 174.9 187.06 179.89 193.23 179.89C187.06 179.89 182.06 184.89 182.05 191.05C182.04 184.89 177.04 179.89 170.87 179.89C177.04 179.89 182.04 174.9 182.05 168.73ZM182.05 204.79C182.06 210.95 187.06 215.95 193.23 215.95C187.06 215.95 182.06 220.94 182.05 227.11C182.04 220.94 177.04 215.95 170.87 215.95C177.04 215.95 182.04 210.95 182.05 204.79ZM151.79 26.53C152.6 31.92 157.24 36.05 162.85 36.05C157.24 36.05 152.6 40.18 151.79 45.57C150.99 40.18 146.35 36.05 140.74 36.05C146.35 36.05 150.99 31.92 151.79 26.53ZM151.79 62.59C152.6 67.98 157.24 72.11 162.85 72.11C157.24 72.11 152.6 76.24 151.79 81.63C150.99 76.24 146.35 72.11 140.74 72.11C146.35 72.11 150.99 67.98 151.79 62.59ZM151.79 117.68C151 112.3 146.36 108.17 140.76 108.16C146.36 108.16 151 104.02 151.79 98.64C152.6 104.02 157.23 108.15 162.84 108.16C157.23 108.17 152.6 112.3 151.79 117.68ZM160.86 144.03C156.18 144.86 152.5 148.62 151.79 153.35C151.1 148.62 147.41 144.86 142.73 144.03C147.41 143.19 151.1 139.43 151.79 134.7C152.5 139.43 156.18 143.19 160.86 144.03ZM151.79 170.37C152.6 175.76 157.24 179.89 162.85 179.89C157.24 179.89 152.6 184.02 151.79 189.41C150.99 184.02 146.35 179.89 140.74 179.89C146.35 179.89 150.99 175.76 151.79 170.37ZM151.79 206.43C152.6 211.82 157.24 215.95 162.85 215.95C157.24 215.95 152.6 220.08 151.79 225.47C150.99 220.08 146.35 215.95 140.74 215.95C146.35 215.95 150.99 211.82 151.79 206.43ZM121.54 24.89C121.55 31.06 126.55 36.05 132.72 36.05C126.55 36.05 121.55 41.05 121.54 47.21C121.53 41.05 116.53 36.05 110.36 36.05C116.53 36.05 121.53 31.06 121.54 24.89ZM121.54 60.95C121.55 67.11 126.55 72.11 132.72 72.11C126.55 72.11 121.55 77.1 121.54 83.27C121.53 77.1 116.53 72.11 110.36 72.11C116.53 72.11 121.53 67.11 121.54 60.95ZM121.54 119.32C121.53 113.16 116.54 108.17 110.38 108.16C116.54 108.16 121.53 103.16 121.54 97C121.55 103.16 126.54 108.15 132.69 108.16C126.54 108.17 121.55 113.16 121.54 119.32ZM130.73 144.03C125.51 144.96 121.54 149.51 121.54 155C121.53 149.51 117.56 144.96 112.35 144.03C117.56 143.09 121.53 138.54 121.54 133.05C121.54 138.54 125.51 143.09 130.73 144.03ZM121.54 168.73C121.55 174.9 126.55 179.89 132.72 179.89C126.55 179.89 121.55 184.89 121.54 191.05C121.53 184.89 116.53 179.89 110.36 179.89C116.53 179.89 121.53 174.9 121.54 168.73ZM121.54 204.79C121.55 210.95 126.55 215.95 132.72 215.95C126.55 215.95 121.55 220.94 121.54 227.11C121.53 220.94 116.53 215.95 110.36 215.95C116.53 215.95 121.53 210.95 121.54 204.79ZM91.16 24.87C91.16 31.05 96.16 36.05 102.34 36.05C96.16 36.05 91.16 41.06 91.16 47.23C91.16 41.06 86.15 36.05 79.98 36.05C86.15 36.05 91.16 31.05 91.16 24.87ZM91.16 60.93C91.16 67.1 96.16 72.11 102.34 72.11C96.16 72.11 91.16 77.11 91.16 83.29C91.16 77.11 86.15 72.11 79.98 72.11C86.15 72.11 91.16 67.1 91.16 60.93ZM91.16 119.34C91.16 113.17 86.16 108.17 79.99 108.16C86.16 108.16 91.16 103.15 91.16 96.98C91.16 103.15 96.16 108.15 102.31 108.16C96.16 108.17 91.16 113.17 91.16 119.34ZM100.35 144.03C95.12 144.96 91.16 149.52 91.16 155.02C91.16 149.52 87.18 144.96 81.95 144.03C87.18 143.09 91.16 138.53 91.16 133.03C91.16 138.53 95.12 143.09 100.35 144.03ZM91.16 168.71C91.16 174.89 96.16 179.89 102.34 179.89C96.16 179.89 91.16 184.9 91.16 191.07C91.16 184.9 86.15 179.89 79.98 179.89C86.15 179.89 91.16 174.89 91.16 168.71ZM91.16 204.77C91.16 210.94 96.16 215.95 102.34 215.95C96.16 215.95 91.16 220.95 91.16 227.13C91.16 220.95 86.15 215.95 79.98 215.95C86.15 215.95 91.16 210.94 91.16 204.77ZM60.76 24.9C60.79 31.06 65.79 36.05 71.94 36.05C65.79 36.05 60.79 41.05 60.76 47.21C60.75 41.05 55.75 36.05 49.6 36.05C55.75 36.05 60.75 31.06 60.76 24.9ZM60.76 60.95C60.79 67.11 65.79 72.11 71.94 72.11C65.79 72.11 60.79 77.1 60.76 83.26C60.75 77.1 55.75 72.11 49.6 72.11C55.75 72.11 60.75 67.11 60.76 60.95ZM60.76 119.31C60.75 113.16 55.76 108.17 49.61 108.16C55.76 108.16 60.75 103.16 60.76 97.01C60.79 103.16 65.78 108.15 71.92 108.16C65.78 108.17 60.79 113.16 60.76 119.31ZM69.97 144.03C64.74 144.96 60.79 149.51 60.76 154.99C60.75 149.51 56.79 144.96 51.57 144.03C56.79 143.09 60.75 138.54 60.76 133.06C60.79 138.54 64.74 143.09 69.97 144.03ZM60.76 168.74C60.79 174.9 65.79 179.89 71.94 179.89C65.79 179.89 60.79 184.89 60.76 191.05C60.75 184.89 55.75 179.89 49.6 179.89C55.75 179.89 60.75 174.9 60.76 168.74ZM60.76 204.79C60.79 210.95 65.79 215.95 71.94 215.95C65.79 215.95 60.79 220.94 60.76 227.1C60.75 220.94 55.75 215.95 49.6 215.95C55.75 215.95 60.75 210.95 60.76 204.79ZM30.38 24.87C30.38 31.05 35.4 36.05 41.56 36.05C35.4 36.05 30.38 41.06 30.38 47.23C30.38 41.06 25.38 36.05 19.2 36.05C25.38 36.05 30.38 31.05 30.38 24.87ZM30.38 60.93C30.38 67.1 35.4 72.11 41.56 72.11C35.4 72.11 30.38 77.11 30.38 83.29C30.38 77.11 25.38 72.11 19.2 72.11C25.38 72.11 30.38 67.1 30.38 60.93ZM30.38 119.34C30.38 113.17 25.4 108.17 19.23 108.16C25.4 108.16 30.38 103.15 30.38 96.98C30.38 103.15 35.38 108.15 41.54 108.16C35.38 108.17 30.38 113.17 30.38 119.34ZM39.57 144.03C34.35 144.96 30.38 149.52 30.38 155.02C30.38 149.52 26.41 144.96 21.19 144.03C26.41 143.09 30.38 138.53 30.38 133.03C30.38 138.53 34.35 143.09 39.57 144.03ZM30.38 168.71C30.38 174.89 35.4 179.89 41.56 179.89C35.4 179.89 30.38 184.9 30.38 191.07C30.38 184.9 25.38 179.89 19.2 179.89C25.38 179.89 30.38 174.89 30.38 168.71ZM30.38 204.77C30.38 210.94 35.4 215.95 41.56 215.95C35.4 215.95 30.38 220.95 30.38 227.13C30.38 220.95 25.38 215.95 19.2 215.95C25.38 215.95 30.38 210.94 30.38 204.77Z" fill="url(#paint0_linear_3248_5)"/>
              <defs>
              <linearGradient id="paint0_linear_3248_5" x1="182.11" y1="0" x2="182.11" y2="252" gradientUnits="userSpaceOnUse">
                <stop offset="0" stop-color="${e.arkleur}" stop-opacity="0" />
                <stop offset="0.3" stop-color="${e.arkleur}" stop-opacity="1" />
              </linearGradient>
            </defs>
          </svg>
          ${e.image?`<img src="${e.image}" class="popup-background-image" alt="">`:""}
          <div class="content-wrapper">
            <div class="popup-title">${e.name}</div>
                        <div class="fade-top"></div> 
            <div class="popup-description">${e.description}</div>
                      <div class="fade-bottom"></div>
${e.image?q(e):""}
            <button class="more-info-button button-base">Instructie</button>
          </div>
        </div>
        
        <div class="popup-side ar popup-back">
          <div class="content-wrapper">
            <div class="popup-title details">Instructie</div>
            <div class="popup-ar-instructie">${e.instructie||"Bekijk deze AR ervaring op je telefoon of desktop."}</div>
            <button class="more-info-button button-base">Terug</button>
${q(e,"impressie-button button-base","Start AR")}
          </div>
        </div>
      </div>
      `}:{styles:o,html:`
        <div class="popup-wrapper">
          <button class="close-button" aria-label="Close popup"></button>
          <div class="popup-side popup-front">
            <svg class="popup-border-overlay" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M0 227.13V240.82C0 246.99 5 252 11.18 252H19.2C25.38 252 30.38 246.99 30.38 240.82C30.38 246.99 35.4 252 41.56 252H49.6C55.75 252 60.75 247.01 60.76 240.85C60.79 247.01 65.79 252 71.94 252H79.98C86.15 252 91.16 246.99 91.16 240.82C91.16 246.99 96.16 252 102.34 252H110.36C116.53 252 121.53 247.01 121.54 240.84C121.55 247.01 126.55 252 132.72 252H140.74C146.35 252 150.99 247.87 151.79 242.48C152.6 247.87 157.24 252 162.85 252H170.87C177.04 252 182.04 247 182.05 240.84C182.06 247 187.06 252 193.23 252H201.25C207.03 252 211.78 247.62 212.36 242C212.95 247.62 217.7 252 223.48 252H231.5C237.68 252 242.68 246.99 242.68 240.82C242.68 246.99 247.69 252 253.86 252H261.89C268.05 252 273.05 247.01 273.06 240.85C273.08 247.01 278.08 252 284.24 252H292.27C298.44 252 303.45 246.99 303.45 240.82C303.45 246.99 308.46 252 314.63 252H322.66C328.82 252 333.82 247.01 333.83 240.84C333.85 247.01 338.85 252 345.01 252H353.04C359.21 252 364.22 246.99 364.22 240.82V227.13C364.22 220.95 359.21 215.95 353.04 215.95C359.21 215.95 364.22 210.94 364.22 204.77V191.07C364.22 184.9 359.21 179.89 353.04 179.89C359.21 179.89 364.22 174.89 364.22 168.71V155.02C364.22 149.52 360.25 144.96 355.02 144.03C360.25 143.09 364.22 138.53 364.22 133.03V119.34C364.22 113.17 359.22 108.17 353.06 108.16C359.22 108.16 364.22 103.15 364.22 96.98V83.29C364.22 77.11 359.21 72.11 353.04 72.11C359.21 72.11 364.22 67.1 364.22 60.93V47.23C364.22 41.06 359.21 36.05 353.04 36.05C359.21 36.05 364.22 31.05 364.22 24.87V11.18C364.22 5.01 359.21 0 353.04 0H345.01C338.85 0 333.85 4.99 333.83 11.16C333.82 4.99 328.82 0 322.66 0H314.63C308.46 0 303.45 5.01 303.45 11.18C303.45 5.01 298.44 0 292.27 0H284.24C278.08 0 273.08 4.99 273.06 11.16C273.05 4.99 268.05 0 261.89 0H253.86C247.69 0 242.68 5.01 242.68 11.18C242.68 5.01 237.68 0 231.5 0H223.48C217.7 0 212.95 4.38 212.36 10C211.78 4.38 207.03 0 201.25 0H193.23C187.06 0 182.06 5 182.05 11.16C182.04 5 177.04 0 170.87 0H162.85C157.24 0 152.6 4.13 151.79 9.52C150.99 4.13 146.35 0 140.74 0H132.72C126.55 0 121.55 4.99 121.54 11.16C121.53 4.99 116.53 0 110.36 0H102.34C96.16 0 91.16 5.01 91.16 11.18C91.16 5.01 86.15 0 79.98 0H71.94C65.79 0 60.79 4.99 60.76 11.16C60.75 4.99 55.75 0 49.6 0H41.56C35.4 0 30.38 5.01 30.38 11.18C30.38 5.01 25.38 0 19.2 0H11.18C5 0 0 5.01 0 11.18V24.87C0 31.05 5 36.05 11.18 36.05C5 36.05 0 41.06 0 47.23V60.93C0 67.1 5 72.11 11.18 72.11C5 72.11 0 77.11 0 83.29V96.98C0 103.15 4.99 108.15 11.16 108.16C4.99 108.17 0 113.17 0 119.34V133.03C0 138.53 3.97 143.09 9.19 144.03C3.97 144.96 0 149.52 0 155.02V168.71C0 174.89 5 179.89 11.18 179.89C5 179.89 0 184.9 0 191.07V204.77C0 210.94 5 215.95 11.18 215.95C5 215.95 0 220.95 0 227.13ZM333.83 24.89C333.85 31.06 338.85 36.05 345.01 36.05C338.85 36.05 333.85 41.05 333.83 47.21C333.82 41.05 328.82 36.05 322.66 36.05C328.82 36.05 333.82 31.06 333.83 24.89ZM333.83 60.95C333.85 67.11 338.85 72.11 345.01 72.11C338.85 72.11 333.85 77.1 333.83 83.27C333.82 77.1 328.82 72.11 322.66 72.11C328.82 72.11 333.82 67.11 333.83 60.95ZM333.83 119.32C333.82 113.16 328.83 108.17 322.68 108.16C328.83 108.16 333.82 103.16 333.83 97C333.85 103.16 338.83 108.15 344.99 108.16C338.83 108.17 333.85 113.16 333.83 119.32ZM343.03 144.03C337.81 144.96 333.84 149.51 333.83 155C333.82 149.51 329.86 144.96 324.64 144.03C329.86 143.09 333.82 138.54 333.83 133.05C333.83 138.54 337.81 143.09 343.03 144.03ZM333.83 168.73C333.85 174.9 338.85 179.89 345.01 179.89C338.85 179.89 333.85 184.89 333.83 191.05C333.82 184.89 328.82 179.89 322.66 179.89C328.82 179.89 333.82 174.9 333.83 168.73ZM333.83 204.79C333.85 210.95 338.85 215.95 345.01 215.95C338.85 215.95 333.85 220.94 333.83 227.11C333.82 220.94 328.82 215.95 322.66 215.95C328.82 215.95 333.82 210.95 333.83 204.79ZM303.45 24.87C303.45 31.05 308.46 36.05 314.63 36.05C308.46 36.05 303.45 41.06 303.45 47.23C303.45 41.06 298.44 36.05 292.27 36.05C298.44 36.05 303.45 31.05 303.45 24.87ZM303.45 60.93C303.45 67.1 308.46 72.11 314.63 72.11C308.46 72.11 303.45 77.11 303.45 83.29C303.45 77.11 298.44 72.11 292.27 72.11C298.44 72.11 303.45 67.1 303.45 60.93ZM303.45 119.34C303.45 113.17 298.45 108.17 292.29 108.16C298.45 108.16 303.45 103.15 303.45 96.98C303.45 103.15 308.45 108.15 314.61 108.16C308.45 108.17 303.45 113.17 303.45 119.34ZM312.64 144.03C307.42 144.96 303.45 149.52 303.45 155.02C303.45 149.52 299.48 144.96 294.25 144.03C299.48 143.09 303.45 138.53 303.45 133.03C303.45 138.53 307.42 143.09 312.64 144.03ZM303.45 168.71C303.45 174.89 308.46 179.89 314.63 179.89C308.46 179.89 303.45 184.9 303.45 191.07C303.45 184.9 298.44 179.89 292.27 179.89C298.44 179.89 303.45 174.89 303.45 168.71ZM303.45 204.77C303.45 210.94 308.46 215.95 314.63 215.95C308.46 215.95 303.45 220.95 303.45 227.13C303.45 220.95 298.44 215.95 292.27 215.95C298.44 215.95 303.45 210.94 303.45 204.77ZM273.06 24.9C273.08 31.06 278.08 36.05 284.24 36.05C278.08 36.05 273.08 41.05 273.06 47.21C273.05 41.05 268.05 36.05 261.89 36.05C268.05 36.05 273.05 31.06 273.06 24.9ZM273.06 60.95C273.08 67.11 278.08 72.11 284.24 72.11C278.08 72.11 273.08 77.1 273.06 83.26C273.05 77.1 268.05 72.11 261.89 72.11C268.05 72.11 273.05 67.11 273.06 60.95ZM273.06 119.31C273.05 113.16 268.06 108.17 261.91 108.16C268.06 108.16 273.05 103.16 273.06 97.01C273.08 103.16 278.07 108.15 284.22 108.16C278.07 108.17 273.08 113.16 273.06 119.31ZM282.26 144.03C277.04 144.96 273.08 149.51 273.06 154.99C273.05 149.51 269.09 144.96 263.87 144.03C269.09 143.09 273.05 138.54 273.06 133.06C273.08 138.54 277.04 143.09 282.26 144.03ZM273.06 168.74C273.08 174.9 278.08 179.89 284.24 179.89C278.08 179.89 273.08 184.89 273.06 191.05C273.05 184.89 268.05 179.89 261.89 179.89C268.05 179.89 273.05 174.9 273.06 168.74ZM273.06 204.79C273.08 210.95 278.08 215.95 284.24 215.95C278.08 215.95 273.08 220.94 273.06 227.1C273.05 220.94 268.05 215.95 261.89 215.95C268.05 215.95 273.05 210.95 273.06 204.79ZM242.68 24.87C242.68 31.05 247.69 36.05 253.86 36.05C247.69 36.05 242.68 41.06 242.68 47.23C242.68 41.06 237.68 36.05 231.5 36.05C237.68 36.05 242.68 31.05 242.68 24.87ZM242.68 60.93C242.68 67.1 247.69 72.11 253.86 72.11C247.69 72.11 242.68 77.11 242.68 83.29C242.68 77.11 237.68 72.11 231.5 72.11C237.68 72.11 242.68 67.1 242.68 60.93ZM242.68 119.34C242.68 113.17 237.69 108.17 231.52 108.16C237.69 108.16 242.68 103.15 242.68 96.98C242.68 103.15 247.68 108.15 253.84 108.16C247.68 108.17 242.68 113.17 242.68 119.34ZM251.87 144.03C246.65 144.96 242.68 149.52 242.68 155.02C242.68 149.52 238.71 144.96 233.49 144.03C238.71 143.09 242.68 138.53 242.68 133.03C242.68 138.53 246.65 143.09 251.87 144.03ZM242.68 168.71C242.68 174.89 247.69 179.89 253.86 179.89C247.69 179.89 242.68 184.9 242.68 191.07C242.68 184.9 237.68 179.89 231.5 179.89C237.68 179.89 242.68 174.89 242.68 168.71ZM242.68 204.77C242.68 210.94 247.69 215.95 253.86 215.95C247.69 215.95 242.68 220.95 242.68 227.13C242.68 220.95 237.68 215.95 231.5 215.95C237.68 215.95 242.68 210.94 242.68 204.77ZM212.36 26.05C212.95 31.68 217.7 36.05 223.48 36.05C217.7 36.05 212.95 40.43 212.36 46.05C211.78 40.43 207.03 36.05 201.25 36.05C207.03 36.05 211.78 31.68 212.36 26.05ZM212.36 62.11C212.95 67.73 217.7 72.11 223.48 72.11C217.7 72.11 212.95 76.48 212.36 82.11C211.78 76.48 207.03 72.11 201.25 72.11C207.03 72.11 211.78 67.73 212.36 62.11ZM212.36 118.16C211.78 112.54 207.04 108.17 201.28 108.16C207.04 108.16 211.78 103.78 212.36 98.16C212.95 103.78 217.69 108.15 223.46 108.16C217.69 108.17 212.95 112.54 212.36 118.16ZM221.49 144.03C216.64 144.89 212.88 148.88 212.36 153.85C211.86 148.88 208.1 144.89 203.24 144.03C208.1 143.16 211.86 139.17 212.36 134.2C212.88 139.17 216.64 143.16 221.49 144.03ZM212.36 169.89C212.95 175.52 217.7 179.89 223.48 179.89C217.7 179.89 212.95 184.27 212.36 189.89C211.78 184.27 207.03 179.89 201.25 179.89C207.03 179.89 211.78 175.52 212.36 169.89ZM212.36 205.95C212.95 211.57 217.7 215.95 223.48 215.95C217.7 215.95 212.95 220.32 212.36 225.95C211.78 220.32 207.03 215.95 201.25 215.95C207.03 215.95 211.78 211.57 212.36 205.95ZM182.05 24.89C182.06 31.06 187.06 36.05 193.23 36.05C187.06 36.05 182.06 41.05 182.05 47.22C182.04 41.05 177.04 36.05 170.87 36.05C177.04 36.05 182.04 31.06 182.05 24.89ZM182.05 60.95C182.06 67.11 187.06 72.11 193.23 72.11C187.06 72.11 182.06 77.1 182.05 83.27C182.04 77.1 177.04 72.11 170.87 72.11C177.04 72.11 182.04 67.11 182.05 60.95ZM182.05 119.32C182.04 113.16 177.05 108.17 170.9 108.16C177.05 108.16 182.04 103.16 182.05 97C182.06 103.16 187.05 108.15 193.22 108.16C187.05 108.17 182.06 113.16 182.05 119.32ZM191.24 144.03C186.03 144.96 182.06 149.51 182.05 155C182.04 149.51 178.09 144.96 172.86 144.03C178.09 143.09 182.04 138.54 182.05 133.05C182.06 138.54 186.03 143.09 191.24 144.03ZM182.05 168.73C182.06 174.9 187.06 179.89 193.23 179.89C187.06 179.89 182.06 184.89 182.05 191.05C182.04 184.89 177.04 179.89 170.87 179.89C177.04 179.89 182.04 174.9 182.05 168.73ZM182.05 204.79C182.06 210.95 187.06 215.95 193.23 215.95C187.06 215.95 182.06 220.94 182.05 227.11C182.04 220.94 177.04 215.95 170.87 215.95C177.04 215.95 182.04 210.95 182.05 204.79ZM151.79 26.53C152.6 31.92 157.24 36.05 162.85 36.05C157.24 36.05 152.6 40.18 151.79 45.57C150.99 40.18 146.35 36.05 140.74 36.05C146.35 36.05 150.99 31.92 151.79 26.53ZM151.79 62.59C152.6 67.98 157.24 72.11 162.85 72.11C157.24 72.11 152.6 76.24 151.79 81.63C150.99 76.24 146.35 72.11 140.74 72.11C146.35 72.11 150.99 67.98 151.79 62.59ZM151.79 117.68C151 112.3 146.36 108.17 140.76 108.16C146.36 108.16 151 104.02 151.79 98.64C152.6 104.02 157.23 108.15 162.84 108.16C157.23 108.17 152.6 112.3 151.79 117.68ZM160.86 144.03C156.18 144.86 152.5 148.62 151.79 153.35C151.1 148.62 147.41 144.86 142.73 144.03C147.41 143.19 151.1 139.43 151.79 134.7C152.5 139.43 156.18 143.19 160.86 144.03ZM151.79 170.37C152.6 175.76 157.24 179.89 162.85 179.89C157.24 179.89 152.6 184.02 151.79 189.41C150.99 184.02 146.35 179.89 140.74 179.89C146.35 179.89 150.99 175.76 151.79 170.37ZM151.79 206.43C152.6 211.82 157.24 215.95 162.85 215.95C157.24 215.95 152.6 220.08 151.79 225.47C150.99 220.08 146.35 215.95 140.74 215.95C146.35 215.95 150.99 211.82 151.79 206.43ZM121.54 24.89C121.55 31.06 126.55 36.05 132.72 36.05C126.55 36.05 121.55 41.05 121.54 47.21C121.53 41.05 116.53 36.05 110.36 36.05C116.53 36.05 121.53 31.06 121.54 24.89ZM121.54 60.95C121.55 67.11 126.55 72.11 132.72 72.11C126.55 72.11 121.55 77.1 121.54 83.27C121.53 77.1 116.53 72.11 110.36 72.11C116.53 72.11 121.53 67.11 121.54 60.95ZM121.54 119.32C121.53 113.16 116.54 108.17 110.38 108.16C116.54 108.16 121.53 103.16 121.54 97C121.55 103.16 126.54 108.15 132.69 108.16C126.54 108.17 121.55 113.16 121.54 119.32ZM130.73 144.03C125.51 144.96 121.54 149.51 121.54 155C121.53 149.51 117.56 144.96 112.35 144.03C117.56 143.09 121.53 138.54 121.54 133.05C121.54 138.54 125.51 143.09 130.73 144.03ZM121.54 168.73C121.55 174.9 126.55 179.89 132.72 179.89C126.55 179.89 121.55 184.89 121.54 191.05C121.53 184.89 116.53 179.89 110.36 179.89C116.53 179.89 121.53 174.9 121.54 168.73ZM121.54 204.79C121.55 210.95 126.55 215.95 132.72 215.95C126.55 215.95 121.55 220.94 121.54 227.11C121.53 220.94 116.53 215.95 110.36 215.95C116.53 215.95 121.53 210.95 121.54 204.79ZM91.16 24.87C91.16 31.05 96.16 36.05 102.34 36.05C96.16 36.05 91.16 41.06 91.16 47.23C91.16 41.06 86.15 36.05 79.98 36.05C86.15 36.05 91.16 31.05 91.16 24.87ZM91.16 60.93C91.16 67.1 96.16 72.11 102.34 72.11C96.16 72.11 91.16 77.11 91.16 83.29C91.16 77.11 86.15 72.11 79.98 72.11C86.15 72.11 91.16 67.1 91.16 60.93ZM91.16 119.34C91.16 113.17 86.16 108.17 79.99 108.16C86.16 108.16 91.16 103.15 91.16 96.98C91.16 103.15 96.16 108.15 102.31 108.16C96.16 108.17 91.16 113.17 91.16 119.34ZM100.35 144.03C95.12 144.96 91.16 149.52 91.16 155.02C91.16 149.52 87.18 144.96 81.95 144.03C87.18 143.09 91.16 138.53 91.16 133.03C91.16 138.53 95.12 143.09 100.35 144.03ZM91.16 168.71C91.16 174.89 96.16 179.89 102.34 179.89C96.16 179.89 91.16 184.9 91.16 191.07C91.16 184.9 86.15 179.89 79.98 179.89C86.15 179.89 91.16 174.89 91.16 168.71ZM91.16 204.77C91.16 210.94 96.16 215.95 102.34 215.95C96.16 215.95 91.16 220.95 91.16 227.13C91.16 220.95 86.15 215.95 79.98 215.95C86.15 215.95 91.16 210.94 91.16 204.77ZM60.76 24.9C60.79 31.06 65.79 36.05 71.94 36.05C65.79 36.05 60.79 41.05 60.76 47.21C60.75 41.05 55.75 36.05 49.6 36.05C55.75 36.05 60.75 31.06 60.76 24.9ZM60.76 60.95C60.79 67.11 65.79 72.11 71.94 72.11C65.79 72.11 60.79 77.1 60.76 83.26C60.75 77.1 55.75 72.11 49.6 72.11C55.75 72.11 60.75 67.11 60.76 60.95ZM60.76 119.31C60.75 113.16 55.76 108.17 49.61 108.16C55.76 108.16 60.75 103.16 60.76 97.01C60.79 103.16 65.78 108.15 71.92 108.16C65.78 108.17 60.79 113.16 60.76 119.31ZM69.97 144.03C64.74 144.96 60.79 149.51 60.76 154.99C60.75 149.51 56.79 144.96 51.57 144.03C56.79 143.09 60.75 138.54 60.76 133.06C60.79 138.54 64.74 143.09 69.97 144.03ZM60.76 168.74C60.79 174.9 65.79 179.89 71.94 179.89C65.79 179.89 60.79 184.89 60.76 191.05C60.75 184.89 55.75 179.89 49.6 179.89C55.75 179.89 60.75 174.9 60.76 168.74ZM60.76 204.79C60.79 210.95 65.79 215.95 71.94 215.95C65.79 215.95 60.79 220.94 60.76 227.1C60.75 220.94 55.75 215.95 49.6 215.95C55.75 215.95 60.75 210.95 60.76 204.79ZM30.38 24.87C30.38 31.05 35.4 36.05 41.56 36.05C35.4 36.05 30.38 41.06 30.38 47.23C30.38 41.06 25.38 36.05 19.2 36.05C25.38 36.05 30.38 31.05 30.38 24.87ZM30.38 60.93C30.38 67.1 35.4 72.11 41.56 72.11C35.4 72.11 30.38 77.11 30.38 83.29C30.38 77.11 25.38 72.11 19.2 72.11C25.38 72.11 30.38 67.1 30.38 60.93ZM30.38 119.34C30.38 113.17 25.4 108.17 19.23 108.16C25.4 108.16 30.38 103.15 30.38 96.98C30.38 103.15 35.38 108.15 41.54 108.16C35.38 108.17 30.38 113.17 30.38 119.34ZM39.57 144.03C34.35 144.96 30.38 149.52 30.38 155.02C30.38 149.52 26.41 144.96 21.19 144.03C26.41 143.09 30.38 138.53 30.38 133.03C30.38 138.53 34.35 143.09 39.57 144.03ZM30.38 168.71C30.38 174.89 35.4 179.89 41.56 179.89C35.4 179.89 30.38 184.9 30.38 191.07C30.38 184.9 25.38 179.89 19.2 179.89C25.38 179.89 30.38 174.89 30.38 168.71ZM30.38 204.77C30.38 210.94 35.4 215.95 41.56 215.95C35.4 215.95 30.38 220.95 30.38 227.13C30.38 220.95 25.38 215.95 19.2 215.95C25.38 215.95 30.38 210.94 30.38 204.77Z" fill="url(#paint0_linear_3248_5)"/>
              <defs>
                <linearGradient id="paint0_linear_3248_5" x1="182.11" y1="0" x2="182.11" y2="252" gradientUnits="userSpaceOnUse">
                  <stop offset="0" stop-color="${e.color}" stop-opacity="0" />
                  <stop offset="0.3" stop-color="${e.color}" stop-opacity="1" />
                </linearGradient>
              </defs>
            </svg>
            ${e.image?`<img src="${e.image}" class="popup-background-image" alt="">`:""}
            <div class="content-wrapper">
              <div class="popup-title">${e.name}</div>
                          <div class="fade-top"></div> 
              <div class="popup-description">${e.description}</div>
                        <div class="fade-bottom"></div>

              ${e.image?'<button class="impressie-button button-base">Impressie</button>':""}
              <button class="more-info-button button-base">Meer info</button>
            </div>
          </div>
          
          <div class="popup-side popup-back">
            <div class="content-wrapper">
              <div class="popup-title details">${e.name||"Naam error"}</div>

               <!-- Add this new social-icons div -->
          <div class="social-icons">
          ${e.website?`
            <a href="${e.website}" target="_blank" aria-label="Website" title="Website">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="2" y1="12" x2="22" y2="12"></line>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
              </svg>
            </a>`:""}
          ${e.instagram?`
            <a href="${e.instagram}" target="_blank" aria-label="Instagram" title="Instagram">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.28-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
              </svg>
            </a>`:""}
          ${e.facebook?`
            <a href="${e.facebook}" target="_blank" aria-label="Facebook" title="Facebook">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                 <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
              </svg>
            </a>`:""}
            </div>
              <div class="info-content"</div>
                <div class="popup-descriptionv2">${e.descriptionv2}</div>
              <button class="more-info-button button-base">Terug</button>
            </div>
          </div>
        </div>
      `}}function j(e,t,o){if(!e)return;t&&(t.style.transition="opacity 0.3s ease"),o&&(o.style.transition="opacity 0.3s ease");const a=()=>{const n=e.scrollHeight-e.clientHeight;if(n<=5){t&&(t.style.opacity="0"),o&&(o.style.opacity="0");return}const l=e.scrollTop/n;if(o){let s=1;l>.75&&(s=1-(l-.75)/.25),o.style.opacity=Math.max(0,Math.min(1,s)).toFixed(2)}if(t){let s=0;l>0&&(s=Math.min(1,l*4)),t.style.opacity=Math.max(0,Math.min(1,s)).toFixed(2)}};return e.addEventListener("scroll",a),window.addEventListener("resize",a),a(),()=>{e.removeEventListener("scroll",a),window.removeEventListener("resize",a)}}function V(e,t,o){const a=e.getElement(),n=a.querySelector(".mapboxgl-popup-content"),l=a.querySelector(".popup-wrapper"),s=a.querySelector(".popup-front .content-wrapper"),i=a.querySelector(".popup-back .content-wrapper"),c=a.querySelector(".popup-description"),r=a.querySelector("#paint0_linear_3248_5"),p=a.querySelector(".popup-front .fade-top"),g=a.querySelector(".popup-front .fade-bottom");if(c){const C=j(c,p,g),x=a.querySelector(".popup-back .popup-descriptionv2"),w=a.querySelector(".popup-back .fade-top"),E=a.querySelector(".popup-back .fade-bottom");if(x){const M=j(x,w,E);a.querySelector(".close-button").addEventListener("click",()=>{typeof C=="function"&&C(),typeof M=="function"&&M()})}else a.querySelector(".close-button").addEventListener("click",()=>{typeof C=="function"&&C()});a.querySelectorAll(".more-info-button").forEach(M=>{M.addEventListener("click",()=>{setTimeout(()=>{const m=l.classList.contains("is-flipped"),k=m?x:c;if(k){const P=k.scrollHeight-k.clientHeight;if(P>5){const L=k.scrollTop/P;m?(w&&(w.style.opacity=L>0?Math.min(1,L*4).toFixed(2):"0"),E&&(E.style.opacity=L>.75?(1-(L-.75)/.25).toFixed(2):"1")):(p&&(p.style.opacity=L>0?Math.min(1,L*4).toFixed(2):"0"),g&&(g.style.opacity=L>.75?(1-(L-.75)/.25).toFixed(2):"1"))}}},50)})})}function u(C,x,w){const E=parseFloat(w.y1.baseVal.value),M=parseFloat(w.y2.baseVal.value),m=Date.now();function k(){const P=Math.min((Date.now()-m)/800,1);w.y1.baseVal.value=E+(C-E)*P,w.y2.baseVal.value=M+(x-M)*P,P<1&&requestAnimationFrame(k)}requestAnimationFrame(k)}function b(){const C=Math.max(s.offsetHeight,i.offsetHeight);l.style.height=`${C}px`,a.querySelectorAll(".popup-side").forEach(x=>{x.style.height=`${C}px`})}if(l.addEventListener("mouseenter",()=>{u(30,282,r)}),l.addEventListener("mouseleave",()=>{u(0,252,r)}),setTimeout(b,10),n.style.opacity="0",n.style.transform="rotate(8deg) translateY(40px) scale(0.4)",requestAnimationFrame(()=>{n.style.transition="all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",n.style.opacity="1",n.style.transform="rotate(0deg) translateY(0) scale(1)"}),c){c.addEventListener("wheel",m=>{m.stopPropagation(),m.preventDefault(),c.scrollTop+=m.deltaY},{passive:!1}),c.addEventListener("mouseenter",()=>{d.dragPan.disable(),d.scrollZoom.disable()}),c.addEventListener("mouseleave",()=>{d.dragPan.enable(),d.scrollZoom.enable()});let C=!1,x,w;c.addEventListener("mousedown",m=>{C=!0,x=m.pageY,w=c.scrollTop,c.style.cursor="grabbing",m.preventDefault(),m.stopPropagation()}),c.addEventListener("mousemove",m=>{if(!C)return;m.preventDefault(),m.stopPropagation();const k=m.pageY-x;c.scrollTop=w-k}),document.addEventListener("mouseup",()=>{C=!1,c.style.cursor="grab"}),c.addEventListener("mouseleave",()=>{C=!1,c.style.cursor="grab"});let E=0,M=0;c.addEventListener("touchstart",m=>{E=m.touches[0].clientY,M=c.scrollTop,m.stopPropagation()}),c.addEventListener("touchmove",m=>{const k=E-m.touches[0].clientY;c.scrollTop=M+k,m.stopPropagation(),m.preventDefault()},{passive:!1})}t.image&&a.querySelector(".impressie-button")&&a.querySelector(".impressie-button").addEventListener("click",()=>{t.link_ar||(n.style.transition="all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)",n.style.transform="rotate(-5deg) translateY(40px) scale(0.6)",n.style.opacity="0",setTimeout(()=>{const C=Math.max(s.offsetHeight,i.offsetHeight);e.remove(),S=null,y1(t,o,C)},400))}),a.querySelectorAll(".more-info-button").forEach(C=>{C.addEventListener("click",()=>{l.classList.toggle("is-flipped")})}),a.querySelectorAll(".close-button").forEach(C=>{C.addEventListener("click",()=>{n.style.transition="all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)",n.style.transform="rotate(-5deg) translateY(40px) scale(0.6)",n.style.opacity="0";const x=$(".locations-map_item.is--show");x.length&&x.css({opacity:"0",transform:"translateY(40px) scale(0.6)",transition:"all 400ms cubic-bezier(0.68, -0.55, 0.265, 1.55)"}),setTimeout(()=>{e.remove(),S=null,$(".locations-map_item").removeClass("is--show"),window.geolocationManager&&(window.geolocationManager.isPopupOpen=!1,window.geolocationManager.wasTracking&&window.geolocationManager.resumeTracking())},400)})}),window.addEventListener("resize",b)}function y1(e,t,o){window.matchMedia("(max-width: 479px)").matches;const a=new mapboxgl.Popup({offset:{bottom:[0,-5],top:[0,0],left:[0,0],right:[0,0]},className:"custom-popup",closeButton:!1,maxWidth:"300px",closeOnClick:!1,anchor:"bottom"}),n=`
    <style>
      .popup-wrapper {
        height: ${o}px;
      }

      .popup-side {
        background-color: ${e.color||"#6B46C1"};
        clip-path: polygon(calc(100% - 0px) 26.5px, calc(100% - 0px) calc(100% - 26.5px), calc(100% - 0px) calc(100% - 26.5px), calc(100% - 0.34671999999995px) calc(100% - 22.20048px), calc(100% - 1.3505599999999px) calc(100% - 18.12224px), calc(100% - 2.95704px) calc(100% - 14.31976px), calc(100% - 5.11168px) calc(100% - 10.84752px), calc(100% - 7.76px) calc(100% - 7.76px), calc(100% - 10.84752px) calc(100% - 5.11168px), calc(100% - 14.31976px) calc(100% - 2.9570399999999px), calc(100% - 18.12224px) calc(100% - 1.35056px), calc(100% - 22.20048px) calc(100% - 0.34672px), calc(100% - 26.5px) calc(100% - 0px), calc(50% - -32.6px) calc(100% - 0px), calc(50% - -32.6px) calc(100% - 0px), calc(50% - -31.57121px) calc(100% - 0.057139999999947px), calc(50% - -30.56648px) calc(100% - 0.2255199999999px), calc(50% - -29.59427px) calc(100% - 0.50057999999996px), calc(50% - -28.66304px) calc(100% - 0.87775999999991px), calc(50% - -27.78125px) calc(100% - 1.3525px), calc(50% - -26.95736px) calc(100% - 1.92024px), calc(50% - -26.19983px) calc(100% - 2.57642px), calc(50% - -25.51712px) calc(100% - 3.31648px), calc(50% - -24.91769px) calc(100% - 4.13586px), calc(50% - -24.41px) calc(100% - 5.03px), calc(50% - -24.41px) calc(100% - 5.03px), calc(50% - -22.95654px) calc(100% - 7.6045699999999px), calc(50% - -21.23752px) calc(100% - 9.9929599999998px), calc(50% - -19.27298px) calc(100% - 12.17519px), calc(50% - -17.08296px) calc(100% - 14.13128px), calc(50% - -14.6875px) calc(100% - 15.84125px), calc(50% - -12.10664px) calc(100% - 17.28512px), calc(50% - -9.36042px) calc(100% - 18.44291px), calc(50% - -6.46888px) calc(100% - 19.29464px), calc(50% - -3.45206px) calc(100% - 19.82033px), calc(50% - -0.32999999999998px) calc(100% - 20px), calc(50% - -0.32999999999998px) calc(100% - 20px), calc(50% - 2.79179px) calc(100% - 19.82033px), calc(50% - 5.8079199999999px) calc(100% - 19.29464px), calc(50% - 8.69853px) calc(100% - 18.44291px), calc(50% - 11.44376px) calc(100% - 17.28512px), calc(50% - 14.02375px) calc(100% - 15.84125px), calc(50% - 16.41864px) calc(100% - 14.13128px), calc(50% - 18.60857px) calc(100% - 12.17519px), calc(50% - 20.57368px) calc(100% - 9.9929599999999px), calc(50% - 22.29411px) calc(100% - 7.60457px), calc(50% - 23.75px) calc(100% - 5.03px), calc(50% - 23.75px) calc(100% - 5.03px), calc(50% - 24.25769px) calc(100% - 4.1358599999999px), calc(50% - 24.85712px) calc(100% - 3.3164799999998px), calc(50% - 25.53983px) calc(100% - 2.57642px), calc(50% - 26.29736px) calc(100% - 1.92024px), calc(50% - 27.12125px) calc(100% - 1.3525px), calc(50% - 28.00304px) calc(100% - 0.87775999999997px), calc(50% - 28.93427px) calc(100% - 0.50057999999996px), calc(50% - 29.90648px) calc(100% - 0.22552000000002px), calc(50% - 30.91121px) calc(100% - 0.057140000000004px), calc(50% - 31.94px) calc(100% - 0px), 26.5px calc(100% - 0px), 26.5px calc(100% - 0px), 22.20048px calc(100% - 0.34671999999989px), 18.12224px calc(100% - 1.3505599999999px), 14.31976px calc(100% - 2.95704px), 10.84752px calc(100% - 5.1116799999999px), 7.76px calc(100% - 7.76px), 5.11168px calc(100% - 10.84752px), 2.95704px calc(100% - 14.31976px), 1.35056px calc(100% - 18.12224px), 0.34672px calc(100% - 22.20048px), 4.3855735949631E-31px calc(100% - 26.5px), 0px 26.5px, 0px 26.5px, 0.34672px 22.20048px, 1.35056px 18.12224px, 2.95704px 14.31976px, 5.11168px 10.84752px, 7.76px 7.76px, 10.84752px 5.11168px, 14.31976px 2.95704px, 18.12224px 1.35056px, 22.20048px 0.34672px, 26.5px 4.3855735949631E-31px, calc(50% - 26.74px) 0px, calc(50% - 26.74px) 0px, calc(50% - 25.31263px) 0.07137px, calc(50% - 23.91544px) 0.28176px, calc(50% - 22.55581px) 0.62559px, calc(50% - 21.24112px) 1.09728px, calc(50% - 19.97875px) 1.69125px, calc(50% - 18.77608px) 2.40192px, calc(50% - 17.64049px) 3.22371px, calc(50% - 16.57936px) 4.15104px, calc(50% - 15.60007px) 5.17833px, calc(50% - 14.71px) 6.3px, calc(50% - 14.71px) 6.3px, calc(50% - 13.6371px) 7.64798px, calc(50% - 12.446px) 8.89024px, calc(50% - 11.1451px) 10.01826px, calc(50% - 9.7428px) 11.02352px, calc(50% - 8.2475px) 11.8975px, calc(50% - 6.6676px) 12.63168px, calc(50% - 5.0115px) 13.21754px, calc(50% - 3.2876px) 13.64656px, calc(50% - 1.5043px) 13.91022px, calc(50% - -0.32999999999996px) 14px, calc(50% - -0.32999999999998px) 14px, calc(50% - -2.16431px) 13.9105px, calc(50% - -3.94768px) 13.6476px, calc(50% - -5.67177px) 13.2197px, calc(50% - -7.32824px) 12.6352px, calc(50% - -8.90875px) 11.9025px, calc(50% - -10.40496px) 11.03px, calc(50% - -11.80853px) 10.0261px, calc(50% - -13.11112px) 8.8992px, calc(50% - -14.30439px) 7.6577px, calc(50% - -15.38px) 6.31px, calc(50% - -15.38px) 6.31px, calc(50% - -16.27279px) 5.18562px, calc(50% - -17.25432px) 4.15616px, calc(50% - -18.31733px) 3.22714px, calc(50% - -19.45456px) 2.40408px, calc(50% - -20.65875px) 1.6925px, calc(50% - -21.92264px) 1.09792px, calc(50% - -23.23897px) 0.62586px, calc(50% - -24.60048px) 0.28184px, calc(50% - -25.99991px) 0.07138px, calc(50% - -27.43px) 8.9116630386686E-32px, calc(100% - 26.5px) 0px, calc(100% - 26.5px) 0px, calc(100% - 22.20048px) 0.34672px, calc(100% - 18.12224px) 1.35056px, calc(100% - 14.31976px) 2.95704px, calc(100% - 10.84752px) 5.11168px, calc(100% - 7.76px) 7.76px, calc(100% - 5.11168px) 10.84752px, calc(100% - 2.9570399999999px) 14.31976px, calc(100% - 1.35056px) 18.12224px, calc(100% - 0.34671999999995px) 22.20048px, calc(100% - 5.6843418860808E-14px) 26.5px);
      }

      .close-button {
        background: ${e.color||"#6B46C1"};
      }
    </style>
    <div class="popup-wrapper">
      <button class="close-button" aria-label="Close popup"></button>
      <div class="popup-side">
        <div class="image-container">
          <img src="${e.image}" alt="${e.name}" class="full-image">
          <div class="button-container">
            <button class="back-button">Terug</button>
          </div>
          <div class="location-name">${e.name}</div>
        </div>
      </div>
    </div>
  `;a.setLngLat(t).setHTML(n).addTo(d),S=a;const l=a.getElement(),s=l.querySelector(".mapboxgl-popup-content"),i=l.querySelector(".close-button"),c=l.querySelector(".back-button");s.style.opacity="0",s.style.transform="rotate(8deg) translateY(40px) scale(0.4)",requestAnimationFrame(()=>{s.style.transition="all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",s.style.opacity="1",s.style.transform="rotate(0deg) translateY(0) scale(1)"});const r=l.querySelector("svg");if(r){const p=r.querySelector("linearGradient");if(p){const g=l.querySelector(".popup-wrapper");g.addEventListener("mouseenter",()=>{animateGradient(30,282,p)}),g.addEventListener("mouseleave",()=>{animateGradient(0,252,p)})}}i.addEventListener("click",()=>{s.style.transition="all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)",s.style.transform="rotate(-5deg) translateY(40px) scale(0.6)",s.style.opacity="0",setTimeout(()=>{a.remove(),S=null},400)}),c.addEventListener("click",()=>{s.style.transition="all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)",s.style.transform="rotate(-5deg) translateY(40px) scale(0.6)",s.style.opacity="0",setTimeout(()=>{a.remove(),S=null;const p=new mapboxgl.Popup({offset:{bottom:[0,-5],top:[0,0],left:[0,0],right:[0,0]},className:"custom-popup",closeButton:!1,maxWidth:"300px",closeOnClick:!1,anchor:"bottom"}),{styles:g,html:u}=z(e);p.setLngLat(t).setHTML(`${g}${u}`),p.addTo(d),S=p,V(p,e,t);const b=p.getElement().querySelector(".mapboxgl-popup-content");b.style.opacity="0",b.style.transform="rotate(8deg) translateY(40px) scale(0.4)",requestAnimationFrame(()=>{b.style.transition="all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",b.style.opacity="1",b.style.transform="rotate(0deg) translateY(0) scale(1)"})},400)})}function b1(){$(".locations-map_item").removeClass("is--show")}d.on("click","location-markers",async e=>{const t=e.features[0].geometry.coordinates.slice(),o=e.features[0].properties,a=o.type==="ar",n=window.matchMedia("(max-width: 479px)").matches?[0,200]:[0,250];d.flyTo({center:t,offset:n,duration:800,essential:!0});const l=$(".locations-map_item.is--show");if(l.length&&l.css({opacity:"0",transform:"translateY(40px) scale(0.6)"}),S){const r=S.getElement().querySelector(".mapboxgl-popup-content");r.style.transition="all 400ms cubic-bezier(0.68, -0.55, 0.265, 1.55)",r.style.transform="rotate(-5deg) translateY(20px) scale(0.8)",r.style.opacity="0"}if(await new Promise(r=>setTimeout(r,400)),S&&(S.remove(),S=null),a)$(".locations-map_wrapper").removeClass("is--show"),$(".locations-map_item").removeClass("is--show");else{$(".locations-map_item").removeClass("is--show").css({display:"none",transform:"translateY(40px) scale(0.6)",opacity:"0"}),$(".locations-map_wrapper").addClass("is--show");const r=$(".locations-map_item").eq(o.arrayID);r.css({display:"block",opacity:"0",transform:"translateY(40px) scale(0.6)"}),r[0].offsetHeight,requestAnimationFrame(()=>{r.css({transition:"all 400ms cubic-bezier(0.68, -0.55, 0.265, 1.55)",opacity:"1",transform:"translateY(0) scale(1)"}).addClass("is--show")})}const s=new mapboxgl.Popup({offset:{bottom:[0,-5],top:[0,0],left:[0,0],right:[0,0]},className:"custom-popup",closeButton:!1,maxWidth:"300px",closeOnClick:!1,anchor:"bottom"});window.geolocationManager&&(window.geolocationManager.isPopupOpen=!0,window.geolocationManager.geolocateControl&&(window.geolocationManager.wasTracking=window.geolocationManager.geolocateControl._watchState==="ACTIVE_LOCK",window.geolocationManager.pauseTracking()));const{styles:i,html:c}=z(o);s.setLngLat(t).setHTML(`${i}${c}`).addTo(d),S=s,s.on("close",()=>{window.geolocationManager&&(window.geolocationManager.isPopupOpen=!1,window.geolocationManager.wasTracking&&window.geolocationManager.resumeTracking())}),V(s,o,t)});//! ============= MAP INTERACTION HANDLERS =============
d.on("load",()=>{d.once("idle",()=>{var t;const e=(t=d.getStyle().layers.find(o=>o.type==="symbol"&&o.id.includes("label")))==null?void 0:t.id;d.addLayer({id:"heerlen-buildings",type:"fill-extrusion",source:"composite","source-layer":"building",filter:["!=",["get","type"],"underground"],minzoom:15,paint:{"fill-extrusion-color":"#e8e0cc","fill-extrusion-height":["case",["has","height"],["get","height"],["has","min_height"],["get","min_height"],3],"fill-extrusion-base":["case",["has","min_height"],["get","min_height"],0],"fill-extrusion-opacity":1,"fill-extrusion-vertical-gradient":!0}},e)}),d1(),g1(),h1(),x1(),Z?B():d.once("idle",B),setTimeout(()=>{const e=window.matchMedia("(max-width: 479px)").matches?17:18;d.jumpTo({center:v.MAP.center,zoom:15,pitch:0,bearing:0}),d.flyTo({center:v.MAP.center,zoom:e,pitch:55,bearing:-17.6,duration:6e3,essential:!0,easing:t=>t*(2-t)})},5e3)}),$(".close-block").on("click",()=>{b1()}),["dragstart","zoomstart","rotatestart","pitchstart"].forEach(e=>{d.on(e,()=>{const t=$(".locations-map_item.is--show");if(t.length&&(t.css({opacity:"0",transform:"translateY(40px) scale(0.6)",transition:"all 400ms cubic-bezier(0.68, -0.55, 0.265, 1.55)"}),setTimeout(()=>{t.removeClass("is--show")},400)),S){const o=S.getElement().querySelector(".mapboxgl-popup-content");o.style.transition="all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)",o.style.transform="rotate(-5deg) translateY(40px) scale(0.6)",o.style.opacity="0",setTimeout(()=>{S.remove(),S=null},400)}})});//! grens instellingen en teleport functie voor zoom en afstand. 
d.on("moveend",()=>{if(d.isEasing())return;const e=d.getCenter(),t={lng:v.MAP.boundary.center[0],lat:v.MAP.boundary.center[1]};if(v1(e.lat,e.lng,t.lat,t.lng)>1){const a=document.createElement("div");a.id="interaction-blocker",document.body.appendChild(a),d.flyTo({center:v.MAP.center,zoom:17,pitch:45,bearing:-17.6,speed:.8,curve:1.5,essential:!0}),gsap.to(a,{duration:2,backgroundColor:"rgba(255,255,255,0)",onComplete:()=>{a.remove()}})}});//! Zorg ervoor dat de calculateDistance functie beschikbaar is op global niveau
function v1(e,t,o,a){const n=r=>r*(Math.PI/180),l=n(o-e),s=n(a-t),i=Math.sin(l/2)*Math.sin(l/2)+Math.cos(n(e))*Math.cos(n(o))*Math.sin(s/2)*Math.sin(s/2);return 6371*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))}//! ============= THREEJS LAYER =============
const w1=[{id:"schunck",origin:[50.88778235149691,5.979389928151281],altitude:0,rotate:[Math.PI/2,.45,0],url:"https://cdn.jsdelivr.net/gh/Artwalters/3dmodels_heerlen@main/schunckv5.glb",scale:1.3},{id:"theater",origin:[50.886541206107225,5.972454838314243],altitude:0,rotate:[Math.PI/2,2.05,0],url:"https://cdn.jsdelivr.net/gh/Artwalters/3dmodels_heerlen@main/theaterheerlenv4.glb",scale:.6}],k1={origin:[50.88801513786042,5.980644311376565],altitude:6.5,rotate:[Math.PI/2,.35,0],imageUrl:"https://daks2k3a4ib2z.cloudfront.net/671769e099775386585f574d/67adf2bff5be8a200ec2fa55_osgameos_mural-p-130x130q80.png",width:13,height:13};function M1(e){const t=mapboxgl.MercatorCoordinate.fromLngLat([e.origin[1],e.origin[0]],e.altitude),o=t.meterInMercatorCoordinateUnits(),a=e.width*o,n=e.height*o;return new Promise((l,s)=>{new THREE.TextureLoader().load(e.imageUrl,c=>{const r=new THREE.MeshBasicMaterial({map:c,transparent:!0,side:THREE.DoubleSide}),p=new THREE.PlaneGeometry(a,n),g=new THREE.Mesh(p,r);g.userData.transform={translateX:t.x,translateY:t.y,translateZ:t.z,rotate:e.rotate,scale:1},l(g)},void 0,c=>s(c))})}const E1={id:"3d-models",type:"custom",renderingMode:"3d",onAdd:function(e,t){this.map=e,this.scene=new THREE.Scene,this.camera=new THREE.Camera;const o=new THREE.AmbientLight(16777215,.57);this.scene.add(o);const a=new THREE.DirectionalLight(16777215,.55);a.color.setHex(16579836);const n=210*(Math.PI/180),l=50*(Math.PI/180);a.position.set(Math.sin(n)*Math.sin(l),Math.cos(n)*Math.sin(l),Math.cos(l)).normalize(),this.scene.add(a),this.renderer=new THREE.WebGLRenderer({canvas:e.getCanvas(),context:t,antialias:!0}),this.renderer.autoClear=!1;const s=new THREE.GLTFLoader;w1.forEach(i=>{const c=mapboxgl.MercatorCoordinate.fromLngLat([i.origin[1],i.origin[0]],i.altitude);s.load(i.url,r=>{const p=r.scene;p.userData.transform={translateX:c.x,translateY:c.y,translateZ:c.z,rotate:i.rotate,scale:c.meterInMercatorCoordinateUnits()*i.scale},this.scene.add(p)},void 0,r=>console.error(r))}),M1(k1).then(i=>{this.scene.add(i)}).catch(i=>console.error("Error loading image plane:",i))},render:function(e,t){const o=new THREE.Matrix4().fromArray(t);this.scene.traverse(a=>{if(a.userData.transform){const n=a.userData.transform,l=new THREE.Matrix4().makeTranslation(n.translateX,n.translateY,n.translateZ),s=new THREE.Matrix4().makeScale(n.scale,-n.scale,n.scale),i=new THREE.Matrix4().makeRotationX(n.rotate[0]),c=new THREE.Matrix4().makeRotationY(n.rotate[1]),r=new THREE.Matrix4().makeRotationZ(n.rotate[2]),p=new THREE.Matrix4().multiply(l).multiply(s).multiply(i).multiply(c).multiply(r);a.matrix=new THREE.Matrix4().copy(o).multiply(p),a.matrixAutoUpdate=!1}}),this.renderer.resetState(),this.renderer.render(this.scene,this.camera)}};d.on("style.load",()=>{d.addLayer(E1)});//! Complete POI filter and interaction code /////////////////////////
const L1=["Brasserie Mijn Streek","De Twee Gezusters","SCHUNCK Bibliotheek Heerlen Glaspaleis","Glaspaleis Schunck","Bagels & Beans","Terras Bagels & Beans","Brunch Bar","Berden","Aroma","Brasserie Goya","Poppodium Nieuwe Nor","Nederlands Mijnmuseum","Smaak & Vermaak","Café ","De Kromme Toeter","Café Pelt","Het Romeins Museum","Pat's Tosti Bar","Sint-Pancratiuskerk","Cafe Bluff"];d.on("idle",()=>{if(!d.loaded())return;let e=["all"];L1.forEach(o=>{e.push(["all",["!=",["get","brand"],o],["!=",["get","name"],o]])}),e.push(["has","name"]),["poi-label","poi-scalerank1","poi-scalerank2","poi-scalerank3","poi-scalerank4"].forEach(o=>{d.getLayer(o)&&d.setFilter(o,e)})});//! Enhanced walkthrough for Heerlen Mapbox application ////////////////////
document.addEventListener("DOMContentLoaded",function(){if(typeof mapboxgl<"u"){S1();const e=setInterval(function(){const t=document.getElementById("map");t&&t.querySelector(".mapboxgl-canvas")&&d&&d.loaded()&&(clearInterval(e),setTimeout(function(){P1()},2e3))},500)}});function S1(){if(!document.getElementById("tour-styles")){const e=document.createElement("link");e.id="tour-styles",e.rel="stylesheet",e.type="text/css",e.href="tour-styles.css",document.head.appendChild(e)}}function P1(){const e=localStorage.getItem("heerlenMapWalkthroughShown");T1(),(!e||window.location.hash==="#tutorial")&&_1(function(){Y(),localStorage.setItem("heerlenMapWalkthroughShown","true")})}function _1(e){const t=document.createElement("div");t.className="welcome-overlay",t.innerHTML=`
    <div class="welcome-card">
      <p> Welkom in <strong>Heerlen</strong> deze kaart heeft veel unieke functies die ik je graag uitleg </p>
      <div class="welcome-buttons">
        <button class="welcome-start-btn">Start tour</button>
        <button class="welcome-skip-btn">Skip tour</button>
      </div>
    </div>
  `,document.body.appendChild(t),setTimeout(()=>{t.style.opacity="1";const o=t.querySelector(".welcome-card");o.style.transform="translateY(0)",o.style.opacity="1"},100),t.querySelector(".welcome-start-btn").addEventListener("click",function(){t.style.opacity="0",setTimeout(()=>{t.remove(),e()},500)}),t.querySelector(".welcome-skip-btn").addEventListener("click",function(){t.style.opacity="0",setTimeout(()=>{t.remove()},500)})}function T1(){const e=document.querySelector(".help-button");e&&e.remove();const t=document.createElement("button");t.className="help-button",t.innerHTML="?",t.title="Start rondleiding",t.setAttribute("aria-label","Start kaart rondleiding"),t.addEventListener("click",()=>{if(window.activeTour&&window.activeTour.isActive()){const a=window.activeTour.getCurrentStep();a?window.activeTour.show(a.id):window.activeTour.start()}else Y()});const o=document.querySelector(".mapboxgl-ctrl-top-right");if(o){const a=document.createElement("div");a.className="mapboxgl-ctrl mapboxgl-ctrl-group help-button-container",a.appendChild(t),o.appendChild(a)}}function Y(){const e=new Shepherd.Tour({useModalOverlay:!1,defaultStepOptions:{cancelIcon:{enabled:!0},classes:"shepherd-theme-heerlen",scrollTo:!1,title:null,popperOptions:{modifiers:[{name:"offset",options:{offset:[0,12]}},{name:"preventOverflow",options:{boundary:document.body,padding:10}}]}}});window.activeTour=e;function t(){const i=document.querySelector(".shepherd-modal-overlay-container");i&&(i.style.transition="opacity 0.3s ease",i.classList.add("shepherd-modal-is-visible"),i.style.pointerEvents="auto")}function o(){const i=document.querySelector(".shepherd-modal-overlay-container");i&&(i.classList.remove("shepherd-modal-is-visible"),i.style.pointerEvents="none")}function a(i,c){const r=document.querySelector(i);if(r)return{element:r,on:"bottom"};if(c){const p=document.querySelector(c);if(p)return{element:p,on:"bottom"}}return null}e.addStep({id:"welcome",text:"Ontdek <strong>Heerlen</strong> met deze interactieve kaart. We leiden je even rond!.",buttons:[{text:"Start",action:e.next,classes:"shepherd-button-primary"}],when:{show:t}}),[{id:"map-controls",attachTo:a(".mapboxgl-ctrl-top-right",".mapboxgl-ctrl-group"),text:"Gebruik deze <strong>knoppen</strong> om in/uit te zoomen en de kaart te draaien."},{id:"filters",attachTo:a(".map-filter-wrap-2",".filter-btn"),text:" gebruik <strong>filters</strong> om per categorie te zoeken en te ontdekken!"},{id:"geolocation",attachTo:a(".mapboxgl-ctrl-geolocate",".mapboxgl-ctrl-bottom-right"),text:"Klik hier om je <strong>locatie</strong> aan te zetten en direct te zien waar jij je bevindt op de kaart."}].forEach(i=>{i.attachTo&&e.addStep({...i,buttons:[{text:"←",action:e.back,classes:"shepherd-button-secondary"},{text:"→",action:e.next,classes:"shepherd-button-primary"}],when:{show:t,hide:()=>{var r;const c=(r=i.attachTo)==null?void 0:r.element;c&&(c.classList.add("tour-highlight-pulse"),setTimeout(()=>{c.classList.remove("tour-highlight-pulse")},1e3))}}})}),e.addStep({id:"try-marker",text:`
      <div class="tour-marker-instruction">
        <p>klik op een van de <strong>gekleurde</strong> rondjes.</p>
        <div class="marker-animation">
          <span class="pulse-dot"></span>
          <span class="instruction-arrow">↓</span>
        </div>
      </div>
    `,buttons:[{text:"←",action:e.back,classes:"shepherd-button-secondary"},{text:"Skip",action:()=>{window.tourWaitingForMarkerClick=!1,e.show("popup-info")},classes:"shepherd-button-secondary"}],when:{show:function(){o();const i=document.createElement("div");i.className="tour-instruction-message",i.textContent="Klik op een marker om door te gaan",document.body.appendChild(i),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i)},4e3),window.tourWaitingForMarkerClick=!0,window.markerClickFallbackTimer=setTimeout(()=>{if(window.tourWaitingForMarkerClick){const c=document.createElement("div");c.className="tour-instruction-message",c.textContent='Klik op "Skip" als je geen marker kunt vinden',document.body.appendChild(c),setTimeout(()=>{c.parentNode&&c.parentNode.removeChild(c)},5e3)}},15e3)},hide:function(){window.markerClickFallbackTimer&&clearTimeout(window.markerClickFallbackTimer),document.querySelectorAll(".tour-instruction-message").forEach(c=>{c.parentNode&&c.parentNode.removeChild(c)})}},canClickTarget:!1,advanceOn:null}),e.addStep({id:"popup-info",attachTo:function(){const i=document.querySelector(".mapboxgl-popup-content");return i?{element:i,on:"top"}:null},text:"Bekijk <strong>informatie</strong> over deze plek en druk op de <strong>like-knop</strong> om deze locatie op te slaan.",buttons:[{text:"←",action:e.back,classes:"shepherd-button-secondary"},{text:"→",action:e.next,classes:"shepherd-button-primary"}],when:{show:function(){if(t(),!document.querySelector(".mapboxgl-popup-content")&&d){const i=document.querySelector(".mapboxgl-marker, .mapboxgl-user-location-dot");i&&(i.click(),setTimeout(()=>{if(!document.querySelector(".mapboxgl-popup-content")&&d.getLayer("location-markers")){const c=d.queryRenderedFeatures({layers:["location-markers"]});if(c.length>0){const r=c[0];d.fire("click",{lngLat:r.geometry.coordinates,point:d.project(r.geometry.coordinates),features:[r]})}}},300))}}}}),e.addStep({id:"like-heart-svg",attachTo:a(".heart-svg.w-embed",".like-heart-svg"),text:"Klik op het <strong>hartje</strong> om al je opgeslagen favoriete locaties te bekijken.",buttons:[{text:"←",action:e.back,classes:"shepherd-button-secondary"},{text:"→",action:e.next,classes:"shepherd-button-primary"}],when:{show:t,hide:()=>{const i=document.querySelector(".heart-svg.w-embed");i&&(i.classList.add("tour-highlight-pulse"),setTimeout(()=>{i.classList.remove("tour-highlight-pulse")},1e3))}}}),e.addStep({id:"finish",text:"Je bent nu klaar om <strong>Heerlen te verkennen</strong>! Klik op markers om locaties te ontdekken. Je kunt deze rondleiding opnieuw starten via het <strong>?</strong> icoon.",buttons:[{text:"Klaar",action:e.complete,classes:"shepherd-button-primary"}],when:{show:t}}),e.on("start",()=>{R1(e)});function l(){window.markerClickListener&&d.off("click","location-markers",window.markerClickListener),window.markerClickListener=()=>{window.tourWaitingForMarkerClick&&(window.tourWaitingForMarkerClick=!1,clearTimeout(window.markerClickFallbackTimer),setTimeout(()=>{e.getCurrentStep()&&e.getCurrentStep().id==="try-marker"&&(t(),e.show("popup-info"))},500))},d.on("click","location-markers",window.markerClickListener)}l();function s(){window.tourWaitingForMarkerClick=!1,window.markerClickFallbackTimer&&clearTimeout(window.markerClickFallbackTimer),document.querySelectorAll(".tour-instruction-message").forEach(r=>{r.parentNode&&r.parentNode.removeChild(r)});const c=document.querySelector(".shepherd-progress-bar");c&&c.parentNode&&c.parentNode.removeChild(c)}e.on("complete",s),e.on("cancel",s),e.start()}function R1(e){const t=document.querySelector(".shepherd-progress-bar");t&&t.remove();const o=document.createElement("div");o.className="shepherd-progress-bar";const a=document.createElement("div");a.className="progress-inner",a.innerHTML='<div class="progress-fill"></div>';const n=document.createElement("button");n.className="progress-bar-close-btn",n.innerHTML="×",n.setAttribute("aria-label","Sluit rondleiding"),n.title="Sluit rondleiding",n.addEventListener("click",()=>{e.cancel()}),o.appendChild(a),o.appendChild(n),document.body.appendChild(o);function l(){const s=e.getCurrentStep();if(!s)return;const i=e.steps.indexOf(s),c=e.steps.length,r=c>1?Math.round(i/(c-1)*100):100,p=o.querySelector(".progress-fill");p&&(p.style.width=`${r}%`)}e.on("show",l),l()}const h={settings:{is3DEnabled:!0,lowPerformanceDetected:!1,frameRatePopupShown:!1},layers:{threeDModelsLayer:"3d-models",buildingLayers:[]},originalPaintProperties:{}};window.addEventListener("storage",function(e){if(e.key===A){console.log("Storage event ontvangen op kaart pagina:",e.newValue);try{const t=e.newValue?JSON.parse(e.newValue):[];D(t)}catch(t){console.error("Kon storage update niet verwerken op kaart:",t),D([])}}});//!Toggle 3D layers visibility - optimized version //////////////
function G(e){h.settings.is3DEnabled=e,K(),W(),h.layers.buildingLayers.length===0&&I();const t=h.layers.threeDModelsLayer;d.getLayer(t)&&d.setLayoutProperty(t,"visibility",e?"visible":"none"),h.layers.buildingLayers.forEach(o=>{if(e){if(d.setLayoutProperty(o,"visibility","visible"),h.originalPaintProperties[o]){const a=h.originalPaintProperties[o];Object.entries(a).forEach(([n,l])=>{d.setPaintProperty(o,n,l)})}}else h.originalPaintProperties[o]||(h.originalPaintProperties[o]={"fill-extrusion-height":d.getPaintProperty(o,"fill-extrusion-height"),"fill-extrusion-base":d.getPaintProperty(o,"fill-extrusion-base")}),d.setLayoutProperty(o,"visibility","none")}),D1(e)}function I(){const e=d.getStyle().layers;h.layers.buildingLayers=e.filter(t=>t.type==="fill-extrusion"&&(t.id.includes("building")||t.id.includes("3d"))).map(t=>t.id)}function D1(e){if(!e&&d.getPitch()>0)h.previousPitch=d.getPitch(),K(),d.easeTo({pitch:0,duration:500});else if(e&&!h.settings.lowPerformanceDetected){const t=h.previousPitch||45;d.easeTo({pitch:t,duration:500})}}function W(){const e=document.querySelector(".toggle-3d-button");if(!e)return;const t=h.settings.is3DEnabled;e.classList.toggle("is-active",t),e.setAttribute("aria-pressed",t),e.title=t?"Schakel Performance Mode uit":"Schakel Performance Mode in",e.innerHTML=t?'<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9M12 4.15l-6.04 3.4 6.04 3.4 6.04-3.4L12 4.15Z"/></svg>':'<svg viewBox="0 0 24 24" width="16" height="16"><path fill="none" stroke="currentColor" stroke-width="1.5" d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9M12 4.15l-6.04 3.4 6.04 3.4 6.04-3.4L12 4.15Z"/></svg>'}function K(){localStorage.setItem("heerlen_map_performance",JSON.stringify({is3DEnabled:h.settings.is3DEnabled,previousPitch:h.previousPitch||45,tooltipShown:h.settings.frameRatePopupShown,warningShown:localStorage.getItem("performance_warning_shown")==="true"}))}function B1(){try{const e=localStorage.getItem("heerlen_map_performance");if(e){const t=JSON.parse(e);h.settings.is3DEnabled=t.is3DEnabled!==!1,h.previousPitch=t.previousPitch,h.settings.frameRatePopupShown=t.tooltipShown===!0,t.warningShown&&localStorage.setItem("performance_warning_shown","true")}else h.settings.is3DEnabled=localStorage.getItem("heerlen_map_3d_enabled")!=="false",h.settings.frameRatePopupShown=localStorage.getItem("performance_tooltip_shown")==="true"}catch{console.warn("Failed to load performance settings")}}function Z1(){if(h.frameRateMonitor)return;let e=performance.now(),t=0,o=0,a=0,n=!0,l=null;const s=2e3,i=()=>{if(!n)return;t++;const r=performance.now();if(r-e>=s){const p=Math.round(t*1e3/(r-e));if(a+=p,o++,o>=3){if(a/o<20){h.settings.lowPerformanceDetected=!0;const u=document.querySelector(".toggle-3d-button");h.settings.is3DEnabled&&u&&!h.settings.frameRatePopupShown&&showPerformanceTooltip(u),c();return}else if(o>=5){c();return}}t=0,e=r}n&&(l=requestAnimationFrame(i))},c=()=>{n=!1,l!==null&&cancelAnimationFrame(l),h.frameRateMonitor=null};l=requestAnimationFrame(i),h.frameRateMonitor={stop:c},setTimeout(c,3e4)}function A1(){const e=document.querySelector(".mapboxgl-ctrl-group .toggle-3d-button");if(e){const n=e.closest(".mapboxgl-ctrl-group");n&&n.remove()}const t=document.createElement("div");t.className="mapboxgl-ctrl mapboxgl-ctrl-group";const o=document.createElement("button");o.className="mapboxgl-ctrl-icon toggle-3d-button",o.type="button",o.setAttribute("aria-label","3D gebouwen aan/uit"),W(),o.addEventListener("click",()=>{G(!h.settings.is3DEnabled),h.settings.is3DEnabled&&h.settings.lowPerformanceDetected&&localStorage.getItem("performance_warning_shown")!=="true"&&showPerformanceWarning()}),o.addEventListener("mouseenter",()=>{h.settings.lowPerformanceDetected&&!h.settings.frameRatePopupShown&&showPerformanceTooltip(o)}),t.appendChild(o);const a=document.querySelector(".mapboxgl-ctrl-top-right");a&&a.appendChild(t)}function G1(){B1(),d.once("load",()=>{A1(),setTimeout(Z1,5e3);const e=()=>{d.getLayer(h.layers.threeDModelsLayer)&&(I(),G(h.settings.is3DEnabled),d.off("styledata",e))};d.on("styledata",e),d.getLayer(h.layers.threeDModelsLayer)&&(I(),G(h.settings.is3DEnabled))})}G1();const I1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));//!============= GEOLOCATION MANAGER ============= //////////
class $1{constructor(t){this.map=t,this.searchRadiusId="search-radius",this.searchRadiusOuterId="search-radius-outer",this.radiusInMeters=25,this.boundaryLayerIds=["boundary-fill","boundary-line","boundary-label"],this.distanceMarkers=[],this.isPopupOpen=!1,this.centerPoint=CONFIG.MAP.boundary.center,this.boundaryRadius=CONFIG.MAP.boundary.radius,console.log("[DEBUG] GeolocationManager initialized."),console.log("[DEBUG] Boundary Center:",this.centerPoint),console.log("[DEBUG] Boundary Radius (km):",this.boundaryRadius),this.initialize()}initialize(){this.setupGeolocateControl(),this.setupSearchRadius(),this.setupBoundaryCheck()}pauseTracking(){this.geolocateControl&&this.geolocateControl._watchState==="ACTIVE_LOCK"&&(this.wasTracking=!0,this.geolocateControl._watchState="ACTIVE_ERROR",console.log("Geolocation tracking paused"))}resumeTracking(){this.geolocateControl&&this.wasTracking&&(this.geolocateControl._watchState="ACTIVE_LOCK",this.wasTracking=!1,console.log("Geolocation tracking resumed"))}updateDistanceMarkers(t){this.distanceMarkers&&(this.distanceMarkers.forEach(o=>o.remove()),this.distanceMarkers=[]),mapLocations.features.forEach(o=>{const a=o.geometry.coordinates,n=1e3*this.calculateDistance(t[1],t[0],a[1],a[0]);if(n<=this.radiusInMeters){const l=document.createElement("div");l.className="distance-marker",l.innerHTML=`<span class="distance-marker-distance">${Math.round(n)}m</span>`;const s=new mapboxgl.Marker({element:l}).setLngLat(a).addTo(this.map);l.addEventListener("click",()=>{this.map.fire("click",{lngLat:a,point:this.map.project(a),features:[o]})}),this.distanceMarkers.push(s)}})}handleUserLocation(t){const o=[t.coords.longitude,t.coords.latitude];if(console.log("[DEBUG] handleUserLocation - User Position:",o),this.isWithinBoundary(o))if(console.log("[DEBUG] handleUserLocation - User is INSIDE boundary."),this.updateSearchRadius(o),this.updateDistanceMarkers(o),this.isPopupOpen)console.log("[DEBUG] handleUserLocation - Popup is open, map movement skipped.");else if(this.isFirstLocation)console.log("[DEBUG] handleUserLocation - First location detected, flying to user."),this.map.flyTo({center:o,zoom:17.5,pitch:45,duration:2e3,bearing:t.coords.heading||0}),this.isFirstLocation=!1;else{const a=this.map.getCenter();this.calculateDistance(a.lat,a.lng,o[1],o[0])>.05&&(console.log("[DEBUG] handleUserLocation - Easing to new user position."),this.map.easeTo({center:o,duration:1e3}))}else console.warn("[DEBUG] handleUserLocation - User is OUTSIDE boundary. Stopping tracking."),this.geolocateControl._watchState="OFF",this.geolocateControl._geolocateButton&&(this.geolocateControl._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.geolocateControl._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting")),this.clearSearchRadius(),this.distanceMarkers&&(this.distanceMarkers.forEach(a=>a.remove()),this.distanceMarkers=[]),console.log("[DEBUG] handleUserLocation - Calling showBoundaryPopup because user moved outside."),this.showBoundaryPopup(),console.log("[DEBUG] handleUserLocation - Flying to Heerlen center."),this.map.flyTo({center:this.centerPoint,zoom:14,pitch:0,bearing:0,duration:1500})}setupGeolocateControl(){document.querySelectorAll(".mapboxgl-ctrl-top-right .mapboxgl-ctrl-group").forEach(o=>o.remove()),document.querySelectorAll(".mapboxgl-ctrl-bottom-right .mapboxgl-ctrl-group").forEach(o=>o.remove()),this.geolocateControl=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0,maximumAge:1e3,timeout:6e3},trackUserLocation:!0,showUserHeading:!0,showAccuracyCircle:!1,fitBoundsOptions:{maxZoom:17.5,animate:!0}}),this.isFirstLocation=!0,this.isTracking=!1,this.userInitiatedGeolocation=!1;const t=this.geolocateControl._onSuccess;this.geolocateControl._onSuccess=o=>{const a=[o.coords.longitude,o.coords.latitude];console.log("[DEBUG] _onSuccess - Position received:",a);const n=this.isWithinBoundary(a);if(console.log("[DEBUG] _onSuccess - Before check: userInitiatedGeolocation =",this.userInitiatedGeolocation,", isWithinBoundary =",n),this.userInitiatedGeolocation&&!n){console.warn("[DEBUG] _onSuccess - User clicked AND is outside boundary. Preventing geolocation and showing popup."),this.geolocateControl._watchState="OFF",this.geolocateControl._geolocateButton&&(this.geolocateControl._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.geolocateControl._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),console.log("[DEBUG] _onSuccess - Geolocate button classes removed.")),this.showBoundaryLayers(),console.log("[DEBUG] _onSuccess - Calling showBoundaryPopup()."),this.showBoundaryPopup(),this.geolocateControl._userLocationDotMarker&&(console.log("[DEBUG] _onSuccess - Removing user location dot marker."),this.geolocateControl._userLocationDotMarker.remove()),this.userInitiatedGeolocation=!1,console.log("[DEBUG] _onSuccess - userInitiatedGeolocation flag reset to false.");return}console.log("[DEBUG] _onSuccess - User is within boundary OR check was not user-initiated. Proceeding with original _onSuccess."),t.call(this.geolocateControl,o),this.userInitiatedGeolocation=!1,console.log("[DEBUG] _onSuccess - userInitiatedGeolocation flag reset after normal processing.")},this.geolocateControl.on("error",o=>{console.error("[DEBUG] Geolocation error event triggered:",o),this.userInitiatedGeolocation?(console.warn("[DEBUG] Geolocation error occurred after user initiated the request."),this.handleGeolocationError(o)):console.log("[DEBUG] Geolocation error occurred during automatic tracking or initial load."),this.userInitiatedGeolocation=!1,console.log("[DEBUG] Geolocation error - userInitiatedGeolocation flag reset.")}),this.map.once("idle",()=>{const o=document.querySelector(".mapboxgl-ctrl-geolocate");o&&o.parentElement?o.addEventListener("click",a=>{console.log("[DEBUG] Geolocate button CLICKED. Setting userInitiatedGeolocation = true."),this.userInitiatedGeolocation=!0,console.log("[DEBUG] Geolocate button click - Showing boundary layers."),this.showBoundaryLayers()},!0):console.warn("[DEBUG] Could not find geolocate button after map idle.")}),this.geolocateControl.on("trackuserlocationstart",()=>{console.log("Location tracking started"),console.log("[DEBUG] trackuserlocationstart event - Showing boundary layers."),this.isTracking=!0,this.showBoundaryLayers()}),this.geolocateControl.on("trackuserlocationend",()=>{console.log("Location tracking ended"),this.isTracking=!1,this.isFirstLocation=!0,this.map.easeTo({bearing:0,pitch:45}),this.clearSearchRadius(),this.distanceMarkers&&(this.distanceMarkers.forEach(o=>o.remove()),this.distanceMarkers=[])}),this.map.addControl(this.geolocateControl,"bottom-right"),this.map.addControl(new mapboxgl.NavigationControl,"top-right")}setupSearchRadius(){this.map.on("load",()=>{if(this.map.getSource(this.searchRadiusId)){console.log("[DEBUG] Search radius source already exists on load.");return}this.map.addSource(this.searchRadiusId,{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}}}),this.map.addLayer({id:this.searchRadiusId,type:"fill-extrusion",source:this.searchRadiusId,paint:{"fill-extrusion-color":"#4B83F2","fill-extrusion-opacity":.08,"fill-extrusion-height":1,"fill-extrusion-base":0}}),this.map.addSource(this.searchRadiusOuterId,{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}}}),this.map.addLayer({id:this.searchRadiusOuterId,type:"fill-extrusion",source:this.searchRadiusOuterId,paint:{"fill-extrusion-color":"#4B83F2","fill-extrusion-opacity":.04,"fill-extrusion-height":2,"fill-extrusion-base":0}}),console.log("[DEBUG] Search radius layers added.")})}setupBoundaryCheck(){this.map.on("load",()=>{if(this.map.getSource("boundary-circle")){console.log("[DEBUG] Boundary circle source already exists on load.");return}this.map.addSource("boundary-circle",{type:"geojson",data:this.createBoundaryCircle()}),this.map.addLayer({id:"boundary-fill",type:"fill",source:"boundary-circle",paint:{"fill-color":"#4B83F2","fill-opacity":.03},layout:{visibility:"none"}}),this.map.addLayer({id:"boundary-line",type:"line",source:"boundary-circle",paint:{"line-color":"#4B83F2","line-width":2,"line-dasharray":[3,3]},layout:{visibility:"none"}}),console.log("[DEBUG] Boundary check layers added.")})}showBoundaryLayers(){console.log("[DEBUG] showBoundaryLayers called."),this.boundaryLayerIds.forEach(t=>{if(this.map.getLayer(t)){if(this.map.setLayoutProperty(t,"visibility","visible"),t==="boundary-fill"){let o=0;const a=()=>{o<.03&&(o+=.005,this.map.setPaintProperty(t,"fill-opacity",o),requestAnimationFrame(a))};a()}}else console.warn(`[DEBUG] Layer ${t} not found in showBoundaryLayers.`)})}hideBoundaryLayers(){console.log("[DEBUG] hideBoundaryLayers called."),this.boundaryLayerIds.forEach(t=>{if(this.map.getLayer(t))if(t==="boundary-fill"){let o=this.map.getPaintProperty(t,"fill-opacity")||.03;const a=()=>{if(o>0){o-=.005;const n=Math.max(0,o);this.map.setPaintProperty(t,"fill-opacity",n),n>0?requestAnimationFrame(a):this.map.setLayoutProperty(t,"visibility","none")}else this.map.setLayoutProperty(t,"visibility","none")};a()}else this.map.setLayoutProperty(t,"visibility","none");else console.warn(`[DEBUG] Layer ${t} not found in hideBoundaryLayers.`)})}updateSearchRadius(t){if(!this.map.getSource(this.searchRadiusId)){console.warn("[DEBUG] updateSearchRadius - Source not found:",this.searchRadiusId);return}const a=((n,l,s=64)=>{const i={latitude:n[1],longitude:n[0]},c=l/1e3,r=[],p=c/(111.32*Math.cos(i.latitude*Math.PI/180)),g=c/110.574;for(let u=0;u<s;u++){const b=u/s*(2*Math.PI),C=p*Math.cos(b),x=g*Math.sin(b);r.push([i.longitude+C,i.latitude+x])}return r.push(r[0]),r})(t,this.radiusInMeters);[this.searchRadiusId,this.searchRadiusOuterId].forEach(n=>{const l=this.map.getSource(n);l?l.setData({type:"Feature",geometry:{type:"Polygon",coordinates:[a]}}):console.warn(`[DEBUG] updateSearchRadius - Source not found during update: ${n}`)})}clearSearchRadius(){this.map.getSource(this.searchRadiusId)?[this.searchRadiusId,this.searchRadiusOuterId].forEach(t=>{const o=this.map.getSource(t);o?o.setData({type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}}):console.warn(`[DEBUG] clearSearchRadius - Source not found: ${t}`)}):console.warn("[DEBUG] clearSearchRadius - Source not found initially:",this.searchRadiusId)}handleGeolocationError(t){console.error("[DEBUG] handleGeolocationError called with error:",t),console.error("Geolocation error code:",t.code),console.error("Geolocation error message:",t.message);const o={1:"Locatie toegang geweigerd. Schakel het in bij je instellingen.",2:"Locatie niet beschikbaar. Controleer je apparaat instellingen.",3:"Verzoek verlopen. Probeer opnieuw.",default:"Er is een fout opgetreden bij het ophalen van je locatie."};this.showNotification(o[t.code]||o.default)}showNotification(t){console.log("[DEBUG] Displaying notification:",t);const o=document.createElement("div");o.className="geolocation-error-notification",o.textContent=t,document.body.appendChild(o),setTimeout(()=>o.remove(),5e3)}createBoundaryCircle(){const t={latitude:this.centerPoint[1],longitude:this.centerPoint[0]},o=this.boundaryRadius,a=[],n=o/(111.32*Math.cos(t.latitude*Math.PI/180)),l=o/110.574;for(let s=0;s<=64;s++){const i=s/64*(2*Math.PI),c=n*Math.cos(i),r=l*Math.sin(i);a.push([t.longitude+c,t.latitude+r])}return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[a]}}}isWithinBoundary(t){return this.calculateDistance(t[1],t[0],this.centerPoint[1],this.centerPoint[0])<=this.boundaryRadius}calculateDistance(t,o,a,n){const l=p=>p*(Math.PI/180),s=l(a-t),i=l(n-o),c=Math.sin(s/2)*Math.sin(s/2)+Math.cos(l(t))*Math.cos(l(a))*Math.sin(i/2)*Math.sin(i/2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}showBoundaryPopup(){console.log("[DEBUG] showBoundaryPopup started.");const t=document.querySelector(".location-boundary-popup");t&&(console.log("[DEBUG] Removing existing location-boundary-popup."),t.remove());const o=document.createElement("div");o.className="location-boundary-popup",console.log("[DEBUG] Created new popup element.");const a=document.createElement("h3");a.textContent="Kom naar Heerlen";const n=document.createElement("p");n.textContent="Deze functie is alleen beschikbaar binnen de blauwe cirkel op de kaart. Kom naar het centrum van Heerlen om de interactieve kaart te gebruiken!";const l=document.createElement("button");l.textContent="Ik kom er aan!";const s=this;l.addEventListener("click",function(){console.log("[DEBUG] Boundary popup button clicked."),window.innerWidth<=768?o.style.transform="translateY(100%)":o.style.transform="translateX(120%)",setTimeout(()=>{console.log("[DEBUG] Removing boundary popup after click."),o.remove()},600),setTimeout(()=>{console.log("[DEBUG] Hiding boundary layers after popup button click."),s.hideBoundaryLayers()},200);const i=window.matchMedia("(max-width: 479px)").matches?17:18;console.log("[DEBUG] Flying back to intro location after popup button click."),map.flyTo({center:CONFIG.MAP.center,zoom:i,pitch:55,bearing:-17.6,duration:3e3,essential:!0,easing:c=>c*(2-c)})}),o.appendChild(a),o.appendChild(n),o.appendChild(l),document.body.appendChild(o),console.log("[DEBUG] Boundary popup appended to document body."),this.map.getLayer("boundary-fill")?(console.log("[DEBUG] Highlighting boundary layers."),this.map.setPaintProperty("boundary-fill","fill-opacity",.05),this.map.setPaintProperty("boundary-line","line-width",3),setTimeout(()=>{console.log("[DEBUG] Resetting boundary layer highlight."),this.map.getLayer("boundary-fill")&&this.map.setPaintProperty("boundary-fill","fill-opacity",.03),this.map.getLayer("boundary-line")&&this.map.setPaintProperty("boundary-line","line-width",2)},2e3)):console.warn("[DEBUG] Boundary layers not found for highlighting in showBoundaryPopup."),!this.map.isMoving()&&!this.map.isEasing()?(console.log("[DEBUG] Flying to boundary center to show the area."),this.map.flyTo({center:this.centerPoint,zoom:14,pitch:0,bearing:0,duration:1500})):console.log("[DEBUG] Skipping flyTo center in showBoundaryPopup because map is already moving."),requestAnimationFrame(()=>{o.offsetHeight,o.classList.add("show"),console.log("[DEBUG] Added 'show' class to boundary popup.")}),console.log("[DEBUG] showBoundaryPopup finished.")}}const F1=new $1(map);window.geolocationManager=F1;const O1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));//! ============= DATA LOADING (ROBUST VERSION) =============
function y(e,t,o="value",a=null,n=!1,l=-1,s="item"){if(!e)return console.warn(`[getRobustValue] Invalid parentElement provided for selector '${t}'`),a;const i=e.querySelector(t);return i?o in i?i[o]:(console.warn(`[Data Loading] Property '${o}' not found on element with selector '${t}' in ${s} item ${l}. Using default.`),a):(n&&console.warn(`[Data Loading] Required element with selector '${t}' not found in ${s} item ${l}. Cannot process fully.`),a)}function J(){console.log("[Data Loading] Starting getGeoData...");const e=document.getElementById("location-list");let t=0,o=0;if(!e){console.error("[Data Loading] CRITICAL: Element with ID 'location-list' not found. Cannot load geo data.");return}Array.from(e.childNodes).filter(a=>a.nodeType===Node.ELEMENT_NODE).forEach((a,n)=>{const l=y(a,"#locationLatitude","value",null,!0,n,"location"),s=y(a,"#locationLongitude","value",null,!0,n,"location"),i=y(a,"#locationID","value",`missing-id-${n}`,!0,n,"location"),c=parseFloat(l),r=parseFloat(s);if(isNaN(c)||isNaN(r)){console.warn(`[Data Loading] Skipping location item ${n} (Attempted ID: ${i}) due to invalid or missing coordinates. Lat='${l}', Long='${s}'`),o++;return}const p={locationLat:c,locationLong:r,locationID:i,name:y(a,"#name","value","Naamloos",!1,n,"location"),locationInfo:y(a,".locations-map_card","innerHTML","<p>Geen informatie beschikbaar</p>",!1,n,"location"),ondernemerkleur:y(a,"#ondernemerkleur","value","#A0A0A0",!1,n,"location"),descriptionv2:y(a,"#descriptionv2","value","",!1,n,"location"),icon:y(a,"#icon","value",null,!1,n,"location"),image:y(a,"#image","value",null,!1,n,"location"),category:y(a,"#category","value","Overig",!1,n,"location"),telefoonummer:y(a,"#telefoonnummer","value","",!1,n,"location"),locatie:y(a,"#locatie","value","",!1,n,"location"),maps:y(a,"#maps","value",null,!1,n,"location"),website:y(a,"#website","value",null,!1,n,"location"),instagram:y(a,"#instagram","value",null,!1,n,"location"),facebook:y(a,"#facebook","value",null,!1,n,"location")},g={type:"Feature",geometry:{type:"Point",coordinates:[p.locationLong,p.locationLat]},properties:{id:p.locationID,description:p.locationInfo,arrayID:n,color:p.ondernemerkleur,name:p.name,icon:p.icon,image:p.image,category:p.category,telefoonummer:p.telefoonummer,locatie:p.locatie,maps:p.maps,website:p.website,descriptionv2:p.descriptionv2,instagram:p.instagram,facebook:p.facebook}};mapLocations.features.some(u=>u.properties.id===p.locationID)?(console.warn(`[Data Loading] Duplicate location ID found and skipped: ${p.locationID} at index ${n}`),o++):(mapLocations.features.push(g),t++)}),console.log(`[Data Loading] getGeoData finished. Loaded: ${t}, Skipped (invalid/duplicate): ${o}`)}function X(){console.log("[Data Loading] Starting getARData...");const e=document.getElementById("location-ar-list");let t=0,o=0;const a=mapLocations.features.length;if(!e){console.error("[Data Loading] CRITICAL: Element with ID 'location-ar-list' not found. Cannot load AR data.");return}Array.from(e.childNodes).filter(n=>n.nodeType===Node.ELEMENT_NODE).forEach((n,l)=>{const s=l,i=y(n,"#latitude_ar","value",null,!0,s,"AR"),c=y(n,"#longitude_ar","value",null,!0,s,"AR"),r=y(n,"#name_ar","value",`AR Item ${s}`,!0,s,"AR"),p=parseFloat(i),g=parseFloat(c);if(isNaN(p)||isNaN(g)){console.warn(`[Data Loading] Skipping AR item ${s} (Name: ${r}) due to invalid or missing coordinates. Lat='${i}', Long='${c}'`),o++;return}const u={latitude_ar:p,longitude_ar:g,name_ar:r,slug_ar:y(n,"#slug_ar","value","",!1,s,"AR"),image_ar:y(n,"#image_ar","value",null,!1,s,"AR"),description_ar:y(n,"#description_ar","value","Geen beschrijving.",!1,s,"AR"),arkleur:y(n,"#arkleur","value","#A0A0A0",!1,l,"location"),icon_ar:y(n,"#icon_ar","value",null,!1,s,"AR"),instructie:y(n,"#instructie","value","Geen instructie beschikbaar.",!1,s,"AR"),link_ar_mobile:y(n,"#link_ar_mobile","value",null,!1,s,"AR"),link_ar_desktop:y(n,"#link_ar_desktop","value",null,!1,s,"AR"),category:y(n,"#category","value",null,!1,s,"AR")};if(!u.link_ar_mobile&&!u.link_ar_desktop){console.warn(`[Data Loading] Skipping AR item ${s} (Name: ${r}) due to missing required AR links (both mobile and desktop).`),o++;return}const b={type:"Feature",geometry:{type:"Point",coordinates:[u.longitude_ar,u.latitude_ar]},properties:{type:"ar",name:u.name_ar,slug:u.slug_ar,description:u.description_ar,arrayID:a+l,image:u.image_ar,arkleur:u.arkleur,icon:u.icon_ar,instructie:u.instructie,link_ar_mobile:u.link_ar_mobile,link_ar_desktop:u.link_ar_desktop,category:u.category}};mapLocations.features.push(b),t++}),console.log(`[Data Loading] getARData finished. Loaded: ${t}, Skipped (invalid/missing required): ${o}`)}document.addEventListener("DOMContentLoaded",()=>{mapLocations.features=[],J(),X(),map.getSource("locations")?(map.getSource("locations").setData(mapLocations),console.log("[Data Loading] Map source 'locations' updated.")):console.log("[Data Loading] Map source 'locations' not found yet, will be added later.")}),J(),X();const H1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));map.on("mouseenter","location-markers",()=>{map.getCanvas().style.cursor="pointer"}),map.on("mouseleave","location-markers",()=>{map.getCanvas().style.cursor=""});const N1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));//! ============= POPUP MANAGEMENT =============
function U1(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768?{link:e.link_ar_mobile,available:!!e.link_ar_mobile,deviceType:"mobile"}:{link:e.link_ar_desktop,available:!!e.link_ar_desktop,deviceType:"desktop"}}function Q(e,t="impressie-button button-base",o="Start AR"){const a=U1(e);return a.available?a.deviceType==="mobile"&&a.link.startsWith("snapchat://")?`<button class="${t}" onclick="handleSnapchatLink('${a.link}')">${o}</button>`:`<button class="${t}" onclick="window.open('${a.link}', '_blank')">${o}</button>`:a.deviceType==="desktop"?`<button class="${t} disabled" disabled title="Deze AR-ervaring is alleen beschikbaar op mobiele apparaten">
                ${o} <span class="mobile-only">📱</span>
              </button>`:""}window.handleSnapchatLink=function(e){const n=/Android/i.test(navigator.userAgent)?"https://play.google.com/store/apps/details?id=com.snapchat.android":"https://apps.apple.com/app/snapchat/id447188370",l=Date.now(),s=1e3;window.location.href=e,setTimeout(function(){Date.now()-l<s+100&&confirm("Om deze AR ervaring te gebruiken heb je Snapchat nodig. Wil je Snapchat downloaden?")&&(window.location.href=n)},s)};function e1(e){const t=e.type==="ar",o=`
    <style>
      .popup-side {
        background-color: ${e.color||"#6B46C1"};
        clip-path: polygon(calc(100% - 0px) 26.5px, calc(100% - 0px) calc(100% - 26.5px), calc(100% - 0px) calc(100% - 26.5px), calc(100% - 0.34671999999995px) calc(100% - 22.20048px), calc(100% - 1.3505599999999px) calc(100% - 18.12224px), calc(100% - 2.95704px) calc(100% - 14.31976px), calc(100% - 5.11168px) calc(100% - 10.84752px), calc(100% - 7.76px) calc(100% - 7.76px), calc(100% - 10.84752px) calc(100% - 5.11168px), calc(100% - 14.31976px) calc(100% - 2.9570399999999px), calc(100% - 18.12224px) calc(100% - 1.35056px), calc(100% - 22.20048px) calc(100% - 0.34672px), calc(100% - 26.5px) calc(100% - 0px), calc(50% - -32.6px) calc(100% - 0px), calc(50% - -32.6px) calc(100% - 0px), calc(50% - -31.57121px) calc(100% - 0.057139999999947px), calc(50% - -30.56648px) calc(100% - 0.2255199999999px), calc(50% - -29.59427px) calc(100% - 0.50057999999996px), calc(50% - -28.66304px) calc(100% - 0.87775999999991px), calc(50% - -27.78125px) calc(100% - 1.3525px), calc(50% - -26.95736px) calc(100% - 1.92024px), calc(50% - -26.19983px) calc(100% - 2.57642px), calc(50% - -25.51712px) calc(100% - 3.31648px), calc(50% - -24.91769px) calc(100% - 4.13586px), calc(50% - -24.41px) calc(100% - 5.03px), calc(50% - -24.41px) calc(100% - 5.03px), calc(50% - -22.95654px) calc(100% - 7.6045699999999px), calc(50% - -21.23752px) calc(100% - 9.9929599999998px), calc(50% - -19.27298px) calc(100% - 12.17519px), calc(50% - -17.08296px) calc(100% - 14.13128px), calc(50% - -14.6875px) calc(100% - 15.84125px), calc(50% - -12.10664px) calc(100% - 17.28512px), calc(50% - -9.36042px) calc(100% - 18.44291px), calc(50% - -6.46888px) calc(100% - 19.29464px), calc(50% - -3.45206px) calc(100% - 19.82033px), calc(50% - -0.32999999999998px) calc(100% - 20px), calc(50% - -0.32999999999998px) calc(100% - 20px), calc(50% - 2.79179px) calc(100% - 19.82033px), calc(50% - 5.8079199999999px) calc(100% - 19.29464px), calc(50% - 8.69853px) calc(100% - 18.44291px), calc(50% - 11.44376px) calc(100% - 17.28512px), calc(50% - 14.02375px) calc(100% - 15.84125px), calc(50% - 16.41864px) calc(100% - 14.13128px), calc(50% - 18.60857px) calc(100% - 12.17519px), calc(50% - 20.57368px) calc(100% - 9.9929599999999px), calc(50% - 22.29411px) calc(100% - 7.60457px), calc(50% - 23.75px) calc(100% - 5.03px), calc(50% - 23.75px) calc(100% - 5.03px), calc(50% - 24.25769px) calc(100% - 4.1358599999999px), calc(50% - 24.85712px) calc(100% - 3.3164799999998px), calc(50% - 25.53983px) calc(100% - 2.57642px), calc(50% - 26.29736px) calc(100% - 1.92024px), calc(50% - 27.12125px) calc(100% - 1.3525px), calc(50% - 28.00304px) calc(100% - 0.87775999999997px), calc(50% - 28.93427px) calc(100% - 0.50057999999996px), calc(50% - 29.90648px) calc(100% - 0.22552000000002px), calc(50% - 30.91121px) calc(100% - 0.057140000000004px), calc(50% - 31.94px) calc(100% - 0px), 26.5px calc(100% - 0px), 26.5px calc(100% - 0px), 22.20048px calc(100% - 0.34671999999989px), 18.12224px calc(100% - 1.3505599999999px), 14.31976px calc(100% - 2.95704px), 10.84752px calc(100% - 5.1116799999999px), 7.76px calc(100% - 7.76px), 5.11168px calc(100% - 10.84752px), 2.95704px calc(100% - 14.31976px), 1.35056px calc(100% - 18.12224px), 0.34672px calc(100% - 22.20048px), 4.3855735949631E-31px calc(100% - 26.5px), 0px 26.5px, 0px 26.5px, 0.34672px 22.20048px, 1.35056px 18.12224px, 2.95704px 14.31976px, 5.11168px 10.84752px, 7.76px 7.76px, 10.84752px 5.11168px, 14.31976px 2.95704px, 18.12224px 1.35056px, 22.20048px 0.34672px, 26.5px 4.3855735949631E-31px, calc(50% - 26.74px) 0px, calc(50% - 26.74px) 0px, calc(50% - 25.31263px) 0.07137px, calc(50% - 23.91544px) 0.28176px, calc(50% - 22.55581px) 0.62559px, calc(50% - 21.24112px) 1.09728px, calc(50% - 19.97875px) 1.69125px, calc(50% - 18.77608px) 2.40192px, calc(50% - 17.64049px) 3.22371px, calc(50% - 16.57936px) 4.15104px, calc(50% - 15.60007px) 5.17833px, calc(50% - 14.71px) 6.3px, calc(50% - 14.71px) 6.3px, calc(50% - 13.6371px) 7.64798px, calc(50% - 12.446px) 8.89024px, calc(50% - 11.1451px) 10.01826px, calc(50% - 9.7428px) 11.02352px, calc(50% - 8.2475px) 11.8975px, calc(50% - 6.6676px) 12.63168px, calc(50% - 5.0115px) 13.21754px, calc(50% - 3.2876px) 13.64656px, calc(50% - 1.5043px) 13.91022px, calc(50% - -0.32999999999996px) 14px, calc(50% - -0.32999999999998px) 14px, calc(50% - -2.16431px) 13.9105px, calc(50% - -3.94768px) 13.6476px, calc(50% - -5.67177px) 13.2197px, calc(50% - -7.32824px) 12.6352px, calc(50% - -8.90875px) 11.9025px, calc(50% - -10.40496px) 11.03px, calc(50% - -11.80853px) 10.0261px, calc(50% - -13.11112px) 8.8992px, calc(50% - -14.30439px) 7.6577px, calc(50% - -15.38px) 6.31px, calc(50% - -15.38px) 6.31px, calc(50% - -16.27279px) 5.18562px, calc(50% - -17.25432px) 4.15616px, calc(50% - -18.31733px) 3.22714px, calc(50% - -19.45456px) 2.40408px, calc(50% - -20.65875px) 1.6925px, calc(50% - -21.92264px) 1.09792px, calc(50% - -23.23897px) 0.62586px, calc(50% - -24.60048px) 0.28184px, calc(50% - -25.99991px) 0.07138px, calc(50% - -27.43px) 8.9116630386686E-32px, calc(100% - 26.5px) 0px, calc(100% - 26.5px) 0px, calc(100% - 22.20048px) 0.34672px, calc(100% - 18.12224px) 1.35056px, calc(100% - 14.31976px) 2.95704px, calc(100% - 10.84752px) 5.11168px, calc(100% - 7.76px) 7.76px, calc(100% - 5.11168px) 10.84752px, calc(100% - 2.9570399999999px) 14.31976px, calc(100% - 1.35056px) 18.12224px, calc(100% - 0.34671999999995px) 22.20048px, calc(100% - 5.6843418860808E-14px) 26.5px);
      }
       
    
.fade-bottom {
  position: absolute;
  bottom: 6.5em;
  left: 20px;
  right: 20px;
  height: 3.5em;
  /* Gebruik dezelfde kleur als de popup maar met transparantie */
  background: linear-gradient(to top, ${e.color||"#6B46C1"} 0%, ${e.color||"#6B46C1"}00 100%);
  pointer-events: none;
  z-index: 2;
  transition: opacity 0.3s ease;
}

.popup-side.ar .fade-bottom {
  background: linear-gradient(to top, ${e.arkleur||"#6B46C1"} 0%, ${e.arkleur||"#6B46C1"}00 100%);
}

/* CSS voor de top fade gradient */
.fade-top {
  position: absolute;
  bottom: 18em;
  left: 20px;
  right: 20px;
  height: 3.5em;
  /* Gespiegelde gradient vergeleken met de bottom fade */
  background: linear-gradient(to bottom, ${e.color||"#6B46C1"} 0%, ${e.color||"#6B46C1"}00 100%);
  pointer-events: none;
  z-index: 2;
  transition: opacity 0.3s ease;
}

      
  /* Add the mobile media query here */
  @media screen and (max-width: 767px) {
  .fade-top {
  bottom: 14em !important;
   }
 }

/* Voor AR-popups een aparte styling */
.popup-side.ar .fade-top {
  background: linear-gradient(to bottom, ${e.arkleur||"#6B46C1"} 0%, ${e.arkleur||"#6B46C1"}00 100%);
}

    .close-button {
      background: ${e.color||"#6B46C1"};
    }
    
    /* Stijlen voor AR popup - met zwarte tekst */
    .popup-side.ar {
      background-color: ${e.arkleur||"#6B46C1"};
      color: #000000;
    }
    
    .close-button.ar {
      background: ${e.arkleur||"#6B46C1"};
    }
    
    /* Kleur aanpassingen voor AR elementen */
    .popup-side.ar .popup-title {
      color: #000000;
    }
    
    .popup-side.ar .popup-description {
      color: #000000;
    }
    
    /* Knoppen in AR popup */
    .popup-side.ar .button-base {
      color: #000000;
      border-color: #000000;
    }
    
    /* Styling voor achterkant van de popup */
    .popup-side.ar.popup-back {
      color: #000000;
      background-color: ${e.arkleur||"#6B46C1"};
    }
    
    /* Zwarte tekst in AR popup details */
    .popup-side.ar .popup-title.details {
      color: #000000;
    }
    
    /* Maak ook de 'X' in de sluitknop zwart */
    .close-button.ar::before,
    .close-button.ar::after {
      background-color: #000000;
    }
    
    ${t?`
      .ar-button {
        border: 2px solid black;
        font-weight: bold;
        color: #000000;
      }
      .ar-description {
        font-size: 0.9em;
        margin-top: 10px;
        color: #000000;
      }
    `:""}
  </style>
  `;return t?{styles:o,html:`
      <div class="popup-wrapper">
        <button class="close-button ar" aria-label="Close popup"></button>
        <div class="popup-side ar popup-front">
          <svg class="popup-border-overlay" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M0 227.13V240.82C0 246.99 5 252 11.18 252H19.2C25.38 252 30.38 246.99 30.38 240.82C30.38 246.99 35.4 252 41.56 252H49.6C55.75 252 60.75 247.01 60.76 240.85C60.79 247.01 65.79 252 71.94 252H79.98C86.15 252 91.16 246.99 91.16 240.82C91.16 246.99 96.16 252 102.34 252H110.36C116.53 252 121.53 247.01 121.54 240.84C121.55 247.01 126.55 252 132.72 252H140.74C146.35 252 150.99 247.87 151.79 242.48C152.6 247.87 157.24 252 162.85 252H170.87C177.04 252 182.04 247 182.05 240.84C182.06 247 187.06 252 193.23 252H201.25C207.03 252 211.78 247.62 212.36 242C212.95 247.62 217.7 252 223.48 252H231.5C237.68 252 242.68 246.99 242.68 240.82C242.68 246.99 247.69 252 253.86 252H261.89C268.05 252 273.05 247.01 273.06 240.85C273.08 247.01 278.08 252 284.24 252H292.27C298.44 252 303.45 246.99 303.45 240.82C303.45 246.99 308.46 252 314.63 252H322.66C328.82 252 333.82 247.01 333.83 240.84C333.85 247.01 338.85 252 345.01 252H353.04C359.21 252 364.22 246.99 364.22 240.82V227.13C364.22 220.95 359.21 215.95 353.04 215.95C359.21 215.95 364.22 210.94 364.22 204.77V191.07C364.22 184.9 359.21 179.89 353.04 179.89C359.21 179.89 364.22 174.89 364.22 168.71V155.02C364.22 149.52 360.25 144.96 355.02 144.03C360.25 143.09 364.22 138.53 364.22 133.03V119.34C364.22 113.17 359.22 108.17 353.06 108.16C359.22 108.16 364.22 103.15 364.22 96.98V83.29C364.22 77.11 359.21 72.11 353.04 72.11C359.21 72.11 364.22 67.1 364.22 60.93V47.23C364.22 41.06 359.21 36.05 353.04 36.05C359.21 36.05 364.22 31.05 364.22 24.87V11.18C364.22 5.01 359.21 0 353.04 0H345.01C338.85 0 333.85 4.99 333.83 11.16C333.82 4.99 328.82 0 322.66 0H314.63C308.46 0 303.45 5.01 303.45 11.18C303.45 5.01 298.44 0 292.27 0H284.24C278.08 0 273.08 4.99 273.06 11.16C273.05 4.99 268.05 0 261.89 0H253.86C247.69 0 242.68 5.01 242.68 11.18C242.68 5.01 237.68 0 231.5 0H223.48C217.7 0 212.95 4.38 212.36 10C211.78 4.38 207.03 0 201.25 0H193.23C187.06 0 182.06 5 182.05 11.16C182.04 5 177.04 0 170.87 0H162.85C157.24 0 152.6 4.13 151.79 9.52C150.99 4.13 146.35 0 140.74 0H132.72C126.55 0 121.55 4.99 121.54 11.16C121.53 4.99 116.53 0 110.36 0H102.34C96.16 0 91.16 5.01 91.16 11.18C91.16 5.01 86.15 0 79.98 0H71.94C65.79 0 60.79 4.99 60.76 11.16C60.75 4.99 55.75 0 49.6 0H41.56C35.4 0 30.38 5.01 30.38 11.18C30.38 5.01 25.38 0 19.2 0H11.18C5 0 0 5.01 0 11.18V24.87C0 31.05 5 36.05 11.18 36.05C5 36.05 0 41.06 0 47.23V60.93C0 67.1 5 72.11 11.18 72.11C5 72.11 0 77.11 0 83.29V96.98C0 103.15 4.99 108.15 11.16 108.16C4.99 108.17 0 113.17 0 119.34V133.03C0 138.53 3.97 143.09 9.19 144.03C3.97 144.96 0 149.52 0 155.02V168.71C0 174.89 5 179.89 11.18 179.89C5 179.89 0 184.9 0 191.07V204.77C0 210.94 5 215.95 11.18 215.95C5 215.95 0 220.95 0 227.13ZM333.83 24.89C333.85 31.06 338.85 36.05 345.01 36.05C338.85 36.05 333.85 41.05 333.83 47.21C333.82 41.05 328.82 36.05 322.66 36.05C328.82 36.05 333.82 31.06 333.83 24.89ZM333.83 60.95C333.85 67.11 338.85 72.11 345.01 72.11C338.85 72.11 333.85 77.1 333.83 83.27C333.82 77.1 328.82 72.11 322.66 72.11C328.82 72.11 333.82 67.11 333.83 60.95ZM333.83 119.32C333.82 113.16 328.83 108.17 322.68 108.16C328.83 108.16 333.82 103.16 333.83 97C333.85 103.16 338.83 108.15 344.99 108.16C338.83 108.17 333.85 113.16 333.83 119.32ZM343.03 144.03C337.81 144.96 333.84 149.51 333.83 155C333.82 149.51 329.86 144.96 324.64 144.03C329.86 143.09 333.82 138.54 333.83 133.05C333.83 138.54 337.81 143.09 343.03 144.03ZM333.83 168.73C333.85 174.9 338.85 179.89 345.01 179.89C338.85 179.89 333.85 184.89 333.83 191.05C333.82 184.89 328.82 179.89 322.66 179.89C328.82 179.89 333.82 174.9 333.83 168.73ZM333.83 204.79C333.85 210.95 338.85 215.95 345.01 215.95C338.85 215.95 333.85 220.94 333.83 227.11C333.82 220.94 328.82 215.95 322.66 215.95C328.82 215.95 333.82 210.95 333.83 204.79ZM303.45 24.87C303.45 31.05 308.46 36.05 314.63 36.05C308.46 36.05 303.45 41.06 303.45 47.23C303.45 41.06 298.44 36.05 292.27 36.05C298.44 36.05 303.45 31.05 303.45 24.87ZM303.45 60.93C303.45 67.1 308.46 72.11 314.63 72.11C308.46 72.11 303.45 77.11 303.45 83.29C303.45 77.11 298.44 72.11 292.27 72.11C298.44 72.11 303.45 67.1 303.45 60.93ZM303.45 119.34C303.45 113.17 298.45 108.17 292.29 108.16C298.45 108.16 303.45 103.15 303.45 96.98C303.45 103.15 308.45 108.15 314.61 108.16C308.45 108.17 303.45 113.17 303.45 119.34ZM312.64 144.03C307.42 144.96 303.45 149.52 303.45 155.02C303.45 149.52 299.48 144.96 294.25 144.03C299.48 143.09 303.45 138.53 303.45 133.03C303.45 138.53 307.42 143.09 312.64 144.03ZM303.45 168.71C303.45 174.89 308.46 179.89 314.63 179.89C308.46 179.89 303.45 184.9 303.45 191.07C303.45 184.9 298.44 179.89 292.27 179.89C298.44 179.89 303.45 174.89 303.45 168.71ZM303.45 204.77C303.45 210.94 308.46 215.95 314.63 215.95C308.46 215.95 303.45 220.95 303.45 227.13C303.45 220.95 298.44 215.95 292.27 215.95C298.44 215.95 303.45 210.94 303.45 204.77ZM273.06 24.9C273.08 31.06 278.08 36.05 284.24 36.05C278.08 36.05 273.08 41.05 273.06 47.21C273.05 41.05 268.05 36.05 261.89 36.05C268.05 36.05 273.05 31.06 273.06 24.9ZM273.06 60.95C273.08 67.11 278.08 72.11 284.24 72.11C278.08 72.11 273.08 77.1 273.06 83.26C273.05 77.1 268.05 72.11 261.89 72.11C268.05 72.11 273.05 67.11 273.06 60.95ZM273.06 119.31C273.05 113.16 268.06 108.17 261.91 108.16C268.06 108.16 273.05 103.16 273.06 97.01C273.08 103.16 278.07 108.15 284.22 108.16C278.07 108.17 273.08 113.16 273.06 119.31ZM282.26 144.03C277.04 144.96 273.08 149.51 273.06 154.99C273.05 149.51 269.09 144.96 263.87 144.03C269.09 143.09 273.05 138.54 273.06 133.06C273.08 138.54 277.04 143.09 282.26 144.03ZM273.06 168.74C273.08 174.9 278.08 179.89 284.24 179.89C278.08 179.89 273.08 184.89 273.06 191.05C273.05 184.89 268.05 179.89 261.89 179.89C268.05 179.89 273.05 174.9 273.06 168.74ZM273.06 204.79C273.08 210.95 278.08 215.95 284.24 215.95C278.08 215.95 273.08 220.94 273.06 227.1C273.05 220.94 268.05 215.95 261.89 215.95C268.05 215.95 273.05 210.95 273.06 204.79ZM242.68 24.87C242.68 31.05 247.69 36.05 253.86 36.05C247.69 36.05 242.68 41.06 242.68 47.23C242.68 41.06 237.68 36.05 231.5 36.05C237.68 36.05 242.68 31.05 242.68 24.87ZM242.68 60.93C242.68 67.1 247.69 72.11 253.86 72.11C247.69 72.11 242.68 77.11 242.68 83.29C242.68 77.11 237.68 72.11 231.5 72.11C237.68 72.11 242.68 67.1 242.68 60.93ZM242.68 119.34C242.68 113.17 237.69 108.17 231.52 108.16C237.69 108.16 242.68 103.15 242.68 96.98C242.68 103.15 247.68 108.15 253.84 108.16C247.68 108.17 242.68 113.17 242.68 119.34ZM251.87 144.03C246.65 144.96 242.68 149.52 242.68 155.02C242.68 149.52 238.71 144.96 233.49 144.03C238.71 143.09 242.68 138.53 242.68 133.03C242.68 138.53 246.65 143.09 251.87 144.03ZM242.68 168.71C242.68 174.89 247.69 179.89 253.86 179.89C247.69 179.89 242.68 184.9 242.68 191.07C242.68 184.9 237.68 179.89 231.5 179.89C237.68 179.89 242.68 174.89 242.68 168.71ZM242.68 204.77C242.68 210.94 247.69 215.95 253.86 215.95C247.69 215.95 242.68 220.95 242.68 227.13C242.68 220.95 237.68 215.95 231.5 215.95C237.68 215.95 242.68 210.94 242.68 204.77ZM212.36 26.05C212.95 31.68 217.7 36.05 223.48 36.05C217.7 36.05 212.95 40.43 212.36 46.05C211.78 40.43 207.03 36.05 201.25 36.05C207.03 36.05 211.78 31.68 212.36 26.05ZM212.36 62.11C212.95 67.73 217.7 72.11 223.48 72.11C217.7 72.11 212.95 76.48 212.36 82.11C211.78 76.48 207.03 72.11 201.25 72.11C207.03 72.11 211.78 67.73 212.36 62.11ZM212.36 118.16C211.78 112.54 207.04 108.17 201.28 108.16C207.04 108.16 211.78 103.78 212.36 98.16C212.95 103.78 217.69 108.15 223.46 108.16C217.69 108.17 212.95 112.54 212.36 118.16ZM221.49 144.03C216.64 144.89 212.88 148.88 212.36 153.85C211.86 148.88 208.1 144.89 203.24 144.03C208.1 143.16 211.86 139.17 212.36 134.2C212.88 139.17 216.64 143.16 221.49 144.03ZM212.36 169.89C212.95 175.52 217.7 179.89 223.48 179.89C217.7 179.89 212.95 184.27 212.36 189.89C211.78 184.27 207.03 179.89 201.25 179.89C207.03 179.89 211.78 175.52 212.36 169.89ZM212.36 205.95C212.95 211.57 217.7 215.95 223.48 215.95C217.7 215.95 212.95 220.32 212.36 225.95C211.78 220.32 207.03 215.95 201.25 215.95C207.03 215.95 211.78 211.57 212.36 205.95ZM182.05 24.89C182.06 31.06 187.06 36.05 193.23 36.05C187.06 36.05 182.06 41.05 182.05 47.22C182.04 41.05 177.04 36.05 170.87 36.05C177.04 36.05 182.04 31.06 182.05 24.89ZM182.05 60.95C182.06 67.11 187.06 72.11 193.23 72.11C187.06 72.11 182.06 77.1 182.05 83.27C182.04 77.1 177.04 72.11 170.87 72.11C177.04 72.11 182.04 67.11 182.05 60.95ZM182.05 119.32C182.04 113.16 177.05 108.17 170.9 108.16C177.05 108.16 182.04 103.16 182.05 97C182.06 103.16 187.05 108.15 193.22 108.16C187.05 108.17 182.06 113.16 182.05 119.32ZM191.24 144.03C186.03 144.96 182.06 149.51 182.05 155C182.04 149.51 178.09 144.96 172.86 144.03C178.09 143.09 182.04 138.54 182.05 133.05C182.06 138.54 186.03 143.09 191.24 144.03ZM182.05 168.73C182.06 174.9 187.06 179.89 193.23 179.89C187.06 179.89 182.06 184.89 182.05 191.05C182.04 184.89 177.04 179.89 170.87 179.89C177.04 179.89 182.04 174.9 182.05 168.73ZM182.05 204.79C182.06 210.95 187.06 215.95 193.23 215.95C187.06 215.95 182.06 220.94 182.05 227.11C182.04 220.94 177.04 215.95 170.87 215.95C177.04 215.95 182.04 210.95 182.05 204.79ZM151.79 26.53C152.6 31.92 157.24 36.05 162.85 36.05C157.24 36.05 152.6 40.18 151.79 45.57C150.99 40.18 146.35 36.05 140.74 36.05C146.35 36.05 150.99 31.92 151.79 26.53ZM151.79 62.59C152.6 67.98 157.24 72.11 162.85 72.11C157.24 72.11 152.6 76.24 151.79 81.63C150.99 76.24 146.35 72.11 140.74 72.11C146.35 72.11 150.99 67.98 151.79 62.59ZM151.79 117.68C151 112.3 146.36 108.17 140.76 108.16C146.36 108.16 151 104.02 151.79 98.64C152.6 104.02 157.23 108.15 162.84 108.16C157.23 108.17 152.6 112.3 151.79 117.68ZM160.86 144.03C156.18 144.86 152.5 148.62 151.79 153.35C151.1 148.62 147.41 144.86 142.73 144.03C147.41 143.19 151.1 139.43 151.79 134.7C152.5 139.43 156.18 143.19 160.86 144.03ZM151.79 170.37C152.6 175.76 157.24 179.89 162.85 179.89C157.24 179.89 152.6 184.02 151.79 189.41C150.99 184.02 146.35 179.89 140.74 179.89C146.35 179.89 150.99 175.76 151.79 170.37ZM151.79 206.43C152.6 211.82 157.24 215.95 162.85 215.95C157.24 215.95 152.6 220.08 151.79 225.47C150.99 220.08 146.35 215.95 140.74 215.95C146.35 215.95 150.99 211.82 151.79 206.43ZM121.54 24.89C121.55 31.06 126.55 36.05 132.72 36.05C126.55 36.05 121.55 41.05 121.54 47.21C121.53 41.05 116.53 36.05 110.36 36.05C116.53 36.05 121.53 31.06 121.54 24.89ZM121.54 60.95C121.55 67.11 126.55 72.11 132.72 72.11C126.55 72.11 121.55 77.1 121.54 83.27C121.53 77.1 116.53 72.11 110.36 72.11C116.53 72.11 121.53 67.11 121.54 60.95ZM121.54 119.32C121.53 113.16 116.54 108.17 110.38 108.16C116.54 108.16 121.53 103.16 121.54 97C121.55 103.16 126.54 108.15 132.69 108.16C126.54 108.17 121.55 113.16 121.54 119.32ZM130.73 144.03C125.51 144.96 121.54 149.51 121.54 155C121.53 149.51 117.56 144.96 112.35 144.03C117.56 143.09 121.53 138.54 121.54 133.05C121.54 138.54 125.51 143.09 130.73 144.03ZM121.54 168.73C121.55 174.9 126.55 179.89 132.72 179.89C126.55 179.89 121.55 184.89 121.54 191.05C121.53 184.89 116.53 179.89 110.36 179.89C116.53 179.89 121.53 174.9 121.54 168.73ZM121.54 204.79C121.55 210.95 126.55 215.95 132.72 215.95C126.55 215.95 121.55 220.94 121.54 227.11C121.53 220.94 116.53 215.95 110.36 215.95C116.53 215.95 121.53 210.95 121.54 204.79ZM91.16 24.87C91.16 31.05 96.16 36.05 102.34 36.05C96.16 36.05 91.16 41.06 91.16 47.23C91.16 41.06 86.15 36.05 79.98 36.05C86.15 36.05 91.16 31.05 91.16 24.87ZM91.16 60.93C91.16 67.1 96.16 72.11 102.34 72.11C96.16 72.11 91.16 77.11 91.16 83.29C91.16 77.11 86.15 72.11 79.98 72.11C86.15 72.11 91.16 67.1 91.16 60.93ZM91.16 119.34C91.16 113.17 86.16 108.17 79.99 108.16C86.16 108.16 91.16 103.15 91.16 96.98C91.16 103.15 96.16 108.15 102.31 108.16C96.16 108.17 91.16 113.17 91.16 119.34ZM100.35 144.03C95.12 144.96 91.16 149.52 91.16 155.02C91.16 149.52 87.18 144.96 81.95 144.03C87.18 143.09 91.16 138.53 91.16 133.03C91.16 138.53 95.12 143.09 100.35 144.03ZM91.16 168.71C91.16 174.89 96.16 179.89 102.34 179.89C96.16 179.89 91.16 184.9 91.16 191.07C91.16 184.9 86.15 179.89 79.98 179.89C86.15 179.89 91.16 174.89 91.16 168.71ZM91.16 204.77C91.16 210.94 96.16 215.95 102.34 215.95C96.16 215.95 91.16 220.95 91.16 227.13C91.16 220.95 86.15 215.95 79.98 215.95C86.15 215.95 91.16 210.94 91.16 204.77ZM60.76 24.9C60.79 31.06 65.79 36.05 71.94 36.05C65.79 36.05 60.79 41.05 60.76 47.21C60.75 41.05 55.75 36.05 49.6 36.05C55.75 36.05 60.75 31.06 60.76 24.9ZM60.76 60.95C60.79 67.11 65.79 72.11 71.94 72.11C65.79 72.11 60.79 77.1 60.76 83.26C60.75 77.1 55.75 72.11 49.6 72.11C55.75 72.11 60.75 67.11 60.76 60.95ZM60.76 119.31C60.75 113.16 55.76 108.17 49.61 108.16C55.76 108.16 60.75 103.16 60.76 97.01C60.79 103.16 65.78 108.15 71.92 108.16C65.78 108.17 60.79 113.16 60.76 119.31ZM69.97 144.03C64.74 144.96 60.79 149.51 60.76 154.99C60.75 149.51 56.79 144.96 51.57 144.03C56.79 143.09 60.75 138.54 60.76 133.06C60.79 138.54 64.74 143.09 69.97 144.03ZM60.76 168.74C60.79 174.9 65.79 179.89 71.94 179.89C65.79 179.89 60.79 184.89 60.76 191.05C60.75 184.89 55.75 179.89 49.6 179.89C55.75 179.89 60.75 174.9 60.76 168.74ZM60.76 204.79C60.79 210.95 65.79 215.95 71.94 215.95C65.79 215.95 60.79 220.94 60.76 227.1C60.75 220.94 55.75 215.95 49.6 215.95C55.75 215.95 60.75 210.95 60.76 204.79ZM30.38 24.87C30.38 31.05 35.4 36.05 41.56 36.05C35.4 36.05 30.38 41.06 30.38 47.23C30.38 41.06 25.38 36.05 19.2 36.05C25.38 36.05 30.38 31.05 30.38 24.87ZM30.38 60.93C30.38 67.1 35.4 72.11 41.56 72.11C35.4 72.11 30.38 77.11 30.38 83.29C30.38 77.11 25.38 72.11 19.2 72.11C25.38 72.11 30.38 67.1 30.38 60.93ZM30.38 119.34C30.38 113.17 25.4 108.17 19.23 108.16C25.4 108.16 30.38 103.15 30.38 96.98C30.38 103.15 35.38 108.15 41.54 108.16C35.38 108.17 30.38 113.17 30.38 119.34ZM39.57 144.03C34.35 144.96 30.38 149.52 30.38 155.02C30.38 149.52 26.41 144.96 21.19 144.03C26.41 143.09 30.38 138.53 30.38 133.03C30.38 138.53 34.35 143.09 39.57 144.03ZM30.38 168.71C30.38 174.89 35.4 179.89 41.56 179.89C35.4 179.89 30.38 184.9 30.38 191.07C30.38 184.9 25.38 179.89 19.2 179.89C25.38 179.89 30.38 174.89 30.38 168.71ZM30.38 204.77C30.38 210.94 35.4 215.95 41.56 215.95C35.4 215.95 30.38 220.95 30.38 227.13C30.38 220.95 25.38 215.95 19.2 215.95C25.38 215.95 30.38 210.94 30.38 204.77Z" fill="url(#paint0_linear_3248_5)"/>
              <defs>
              <linearGradient id="paint0_linear_3248_5" x1="182.11" y1="0" x2="182.11" y2="252" gradientUnits="userSpaceOnUse">
                <stop offset="0" stop-color="${e.arkleur}" stop-opacity="0" />
                <stop offset="0.3" stop-color="${e.arkleur}" stop-opacity="1" />
              </linearGradient>
            </defs>
          </svg>
          ${e.image?`<img src="${e.image}" class="popup-background-image" alt="">`:""}
          <div class="content-wrapper">
            <div class="popup-title">${e.name}</div>
                        <div class="fade-top"></div> 
            <div class="popup-description">${e.description}</div>
                      <div class="fade-bottom"></div>
${e.image?Q(e):""}
            <button class="more-info-button button-base">Instructie</button>
          </div>
        </div>
        
        <div class="popup-side ar popup-back">
          <div class="content-wrapper">
            <div class="popup-title details">Instructie</div>
            <div class="popup-ar-instructie">${e.instructie||"Bekijk deze AR ervaring op je telefoon of desktop."}</div>
            <button class="more-info-button button-base">Terug</button>
${Q(e,"impressie-button button-base","Start AR")}
          </div>
        </div>
      </div>
      `}:{styles:o,html:`
        <div class="popup-wrapper">
          <button class="close-button" aria-label="Close popup"></button>
          <div class="popup-side popup-front">
            <svg class="popup-border-overlay" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M0 227.13V240.82C0 246.99 5 252 11.18 252H19.2C25.38 252 30.38 246.99 30.38 240.82C30.38 246.99 35.4 252 41.56 252H49.6C55.75 252 60.75 247.01 60.76 240.85C60.79 247.01 65.79 252 71.94 252H79.98C86.15 252 91.16 246.99 91.16 240.82C91.16 246.99 96.16 252 102.34 252H110.36C116.53 252 121.53 247.01 121.54 240.84C121.55 247.01 126.55 252 132.72 252H140.74C146.35 252 150.99 247.87 151.79 242.48C152.6 247.87 157.24 252 162.85 252H170.87C177.04 252 182.04 247 182.05 240.84C182.06 247 187.06 252 193.23 252H201.25C207.03 252 211.78 247.62 212.36 242C212.95 247.62 217.7 252 223.48 252H231.5C237.68 252 242.68 246.99 242.68 240.82C242.68 246.99 247.69 252 253.86 252H261.89C268.05 252 273.05 247.01 273.06 240.85C273.08 247.01 278.08 252 284.24 252H292.27C298.44 252 303.45 246.99 303.45 240.82C303.45 246.99 308.46 252 314.63 252H322.66C328.82 252 333.82 247.01 333.83 240.84C333.85 247.01 338.85 252 345.01 252H353.04C359.21 252 364.22 246.99 364.22 240.82V227.13C364.22 220.95 359.21 215.95 353.04 215.95C359.21 215.95 364.22 210.94 364.22 204.77V191.07C364.22 184.9 359.21 179.89 353.04 179.89C359.21 179.89 364.22 174.89 364.22 168.71V155.02C364.22 149.52 360.25 144.96 355.02 144.03C360.25 143.09 364.22 138.53 364.22 133.03V119.34C364.22 113.17 359.22 108.17 353.06 108.16C359.22 108.16 364.22 103.15 364.22 96.98V83.29C364.22 77.11 359.21 72.11 353.04 72.11C359.21 72.11 364.22 67.1 364.22 60.93V47.23C364.22 41.06 359.21 36.05 353.04 36.05C359.21 36.05 364.22 31.05 364.22 24.87V11.18C364.22 5.01 359.21 0 353.04 0H345.01C338.85 0 333.85 4.99 333.83 11.16C333.82 4.99 328.82 0 322.66 0H314.63C308.46 0 303.45 5.01 303.45 11.18C303.45 5.01 298.44 0 292.27 0H284.24C278.08 0 273.08 4.99 273.06 11.16C273.05 4.99 268.05 0 261.89 0H253.86C247.69 0 242.68 5.01 242.68 11.18C242.68 5.01 237.68 0 231.5 0H223.48C217.7 0 212.95 4.38 212.36 10C211.78 4.38 207.03 0 201.25 0H193.23C187.06 0 182.06 5 182.05 11.16C182.04 5 177.04 0 170.87 0H162.85C157.24 0 152.6 4.13 151.79 9.52C150.99 4.13 146.35 0 140.74 0H132.72C126.55 0 121.55 4.99 121.54 11.16C121.53 4.99 116.53 0 110.36 0H102.34C96.16 0 91.16 5.01 91.16 11.18C91.16 5.01 86.15 0 79.98 0H71.94C65.79 0 60.79 4.99 60.76 11.16C60.75 4.99 55.75 0 49.6 0H41.56C35.4 0 30.38 5.01 30.38 11.18C30.38 5.01 25.38 0 19.2 0H11.18C5 0 0 5.01 0 11.18V24.87C0 31.05 5 36.05 11.18 36.05C5 36.05 0 41.06 0 47.23V60.93C0 67.1 5 72.11 11.18 72.11C5 72.11 0 77.11 0 83.29V96.98C0 103.15 4.99 108.15 11.16 108.16C4.99 108.17 0 113.17 0 119.34V133.03C0 138.53 3.97 143.09 9.19 144.03C3.97 144.96 0 149.52 0 155.02V168.71C0 174.89 5 179.89 11.18 179.89C5 179.89 0 184.9 0 191.07V204.77C0 210.94 5 215.95 11.18 215.95C5 215.95 0 220.95 0 227.13ZM333.83 24.89C333.85 31.06 338.85 36.05 345.01 36.05C338.85 36.05 333.85 41.05 333.83 47.21C333.82 41.05 328.82 36.05 322.66 36.05C328.82 36.05 333.82 31.06 333.83 24.89ZM333.83 60.95C333.85 67.11 338.85 72.11 345.01 72.11C338.85 72.11 333.85 77.1 333.83 83.27C333.82 77.1 328.82 72.11 322.66 72.11C328.82 72.11 333.82 67.11 333.83 60.95ZM333.83 119.32C333.82 113.16 328.83 108.17 322.68 108.16C328.83 108.16 333.82 103.16 333.83 97C333.85 103.16 338.83 108.15 344.99 108.16C338.83 108.17 333.85 113.16 333.83 119.32ZM343.03 144.03C337.81 144.96 333.84 149.51 333.83 155C333.82 149.51 329.86 144.96 324.64 144.03C329.86 143.09 333.82 138.54 333.83 133.05C333.83 138.54 337.81 143.09 343.03 144.03ZM333.83 168.73C333.85 174.9 338.85 179.89 345.01 179.89C338.85 179.89 333.85 184.89 333.83 191.05C333.82 184.89 328.82 179.89 322.66 179.89C328.82 179.89 333.82 174.9 333.83 168.73ZM333.83 204.79C333.85 210.95 338.85 215.95 345.01 215.95C338.85 215.95 333.85 220.94 333.83 227.11C333.82 220.94 328.82 215.95 322.66 215.95C328.82 215.95 333.82 210.95 333.83 204.79ZM303.45 24.87C303.45 31.05 308.46 36.05 314.63 36.05C308.46 36.05 303.45 41.06 303.45 47.23C303.45 41.06 298.44 36.05 292.27 36.05C298.44 36.05 303.45 31.05 303.45 24.87ZM303.45 60.93C303.45 67.1 308.46 72.11 314.63 72.11C308.46 72.11 303.45 77.11 303.45 83.29C303.45 77.11 298.44 72.11 292.27 72.11C298.44 72.11 303.45 67.1 303.45 60.93ZM303.45 119.34C303.45 113.17 298.45 108.17 292.29 108.16C298.45 108.16 303.45 103.15 303.45 96.98C303.45 103.15 308.45 108.15 314.61 108.16C308.45 108.17 303.45 113.17 303.45 119.34ZM312.64 144.03C307.42 144.96 303.45 149.52 303.45 155.02C303.45 149.52 299.48 144.96 294.25 144.03C299.48 143.09 303.45 138.53 303.45 133.03C303.45 138.53 307.42 143.09 312.64 144.03ZM303.45 168.71C303.45 174.89 308.46 179.89 314.63 179.89C308.46 179.89 303.45 184.9 303.45 191.07C303.45 184.9 298.44 179.89 292.27 179.89C298.44 179.89 303.45 174.89 303.45 168.71ZM303.45 204.77C303.45 210.94 308.46 215.95 314.63 215.95C308.46 215.95 303.45 220.95 303.45 227.13C303.45 220.95 298.44 215.95 292.27 215.95C298.44 215.95 303.45 210.94 303.45 204.77ZM273.06 24.9C273.08 31.06 278.08 36.05 284.24 36.05C278.08 36.05 273.08 41.05 273.06 47.21C273.05 41.05 268.05 36.05 261.89 36.05C268.05 36.05 273.05 31.06 273.06 24.9ZM273.06 60.95C273.08 67.11 278.08 72.11 284.24 72.11C278.08 72.11 273.08 77.1 273.06 83.26C273.05 77.1 268.05 72.11 261.89 72.11C268.05 72.11 273.05 67.11 273.06 60.95ZM273.06 119.31C273.05 113.16 268.06 108.17 261.91 108.16C268.06 108.16 273.05 103.16 273.06 97.01C273.08 103.16 278.07 108.15 284.22 108.16C278.07 108.17 273.08 113.16 273.06 119.31ZM282.26 144.03C277.04 144.96 273.08 149.51 273.06 154.99C273.05 149.51 269.09 144.96 263.87 144.03C269.09 143.09 273.05 138.54 273.06 133.06C273.08 138.54 277.04 143.09 282.26 144.03ZM273.06 168.74C273.08 174.9 278.08 179.89 284.24 179.89C278.08 179.89 273.08 184.89 273.06 191.05C273.05 184.89 268.05 179.89 261.89 179.89C268.05 179.89 273.05 174.9 273.06 168.74ZM273.06 204.79C273.08 210.95 278.08 215.95 284.24 215.95C278.08 215.95 273.08 220.94 273.06 227.1C273.05 220.94 268.05 215.95 261.89 215.95C268.05 215.95 273.05 210.95 273.06 204.79ZM242.68 24.87C242.68 31.05 247.69 36.05 253.86 36.05C247.69 36.05 242.68 41.06 242.68 47.23C242.68 41.06 237.68 36.05 231.5 36.05C237.68 36.05 242.68 31.05 242.68 24.87ZM242.68 60.93C242.68 67.1 247.69 72.11 253.86 72.11C247.69 72.11 242.68 77.11 242.68 83.29C242.68 77.11 237.68 72.11 231.5 72.11C237.68 72.11 242.68 67.1 242.68 60.93ZM242.68 119.34C242.68 113.17 237.69 108.17 231.52 108.16C237.69 108.16 242.68 103.15 242.68 96.98C242.68 103.15 247.68 108.15 253.84 108.16C247.68 108.17 242.68 113.17 242.68 119.34ZM251.87 144.03C246.65 144.96 242.68 149.52 242.68 155.02C242.68 149.52 238.71 144.96 233.49 144.03C238.71 143.09 242.68 138.53 242.68 133.03C242.68 138.53 246.65 143.09 251.87 144.03ZM242.68 168.71C242.68 174.89 247.69 179.89 253.86 179.89C247.69 179.89 242.68 184.9 242.68 191.07C242.68 184.9 237.68 179.89 231.5 179.89C237.68 179.89 242.68 174.89 242.68 168.71ZM242.68 204.77C242.68 210.94 247.69 215.95 253.86 215.95C247.69 215.95 242.68 220.95 242.68 227.13C242.68 220.95 237.68 215.95 231.5 215.95C237.68 215.95 242.68 210.94 242.68 204.77ZM212.36 26.05C212.95 31.68 217.7 36.05 223.48 36.05C217.7 36.05 212.95 40.43 212.36 46.05C211.78 40.43 207.03 36.05 201.25 36.05C207.03 36.05 211.78 31.68 212.36 26.05ZM212.36 62.11C212.95 67.73 217.7 72.11 223.48 72.11C217.7 72.11 212.95 76.48 212.36 82.11C211.78 76.48 207.03 72.11 201.25 72.11C207.03 72.11 211.78 67.73 212.36 62.11ZM212.36 118.16C211.78 112.54 207.04 108.17 201.28 108.16C207.04 108.16 211.78 103.78 212.36 98.16C212.95 103.78 217.69 108.15 223.46 108.16C217.69 108.17 212.95 112.54 212.36 118.16ZM221.49 144.03C216.64 144.89 212.88 148.88 212.36 153.85C211.86 148.88 208.1 144.89 203.24 144.03C208.1 143.16 211.86 139.17 212.36 134.2C212.88 139.17 216.64 143.16 221.49 144.03ZM212.36 169.89C212.95 175.52 217.7 179.89 223.48 179.89C217.7 179.89 212.95 184.27 212.36 189.89C211.78 184.27 207.03 179.89 201.25 179.89C207.03 179.89 211.78 175.52 212.36 169.89ZM212.36 205.95C212.95 211.57 217.7 215.95 223.48 215.95C217.7 215.95 212.95 220.32 212.36 225.95C211.78 220.32 207.03 215.95 201.25 215.95C207.03 215.95 211.78 211.57 212.36 205.95ZM182.05 24.89C182.06 31.06 187.06 36.05 193.23 36.05C187.06 36.05 182.06 41.05 182.05 47.22C182.04 41.05 177.04 36.05 170.87 36.05C177.04 36.05 182.04 31.06 182.05 24.89ZM182.05 60.95C182.06 67.11 187.06 72.11 193.23 72.11C187.06 72.11 182.06 77.1 182.05 83.27C182.04 77.1 177.04 72.11 170.87 72.11C177.04 72.11 182.04 67.11 182.05 60.95ZM182.05 119.32C182.04 113.16 177.05 108.17 170.9 108.16C177.05 108.16 182.04 103.16 182.05 97C182.06 103.16 187.05 108.15 193.22 108.16C187.05 108.17 182.06 113.16 182.05 119.32ZM191.24 144.03C186.03 144.96 182.06 149.51 182.05 155C182.04 149.51 178.09 144.96 172.86 144.03C178.09 143.09 182.04 138.54 182.05 133.05C182.06 138.54 186.03 143.09 191.24 144.03ZM182.05 168.73C182.06 174.9 187.06 179.89 193.23 179.89C187.06 179.89 182.06 184.89 182.05 191.05C182.04 184.89 177.04 179.89 170.87 179.89C177.04 179.89 182.04 174.9 182.05 168.73ZM182.05 204.79C182.06 210.95 187.06 215.95 193.23 215.95C187.06 215.95 182.06 220.94 182.05 227.11C182.04 220.94 177.04 215.95 170.87 215.95C177.04 215.95 182.04 210.95 182.05 204.79ZM151.79 26.53C152.6 31.92 157.24 36.05 162.85 36.05C157.24 36.05 152.6 40.18 151.79 45.57C150.99 40.18 146.35 36.05 140.74 36.05C146.35 36.05 150.99 31.92 151.79 26.53ZM151.79 62.59C152.6 67.98 157.24 72.11 162.85 72.11C157.24 72.11 152.6 76.24 151.79 81.63C150.99 76.24 146.35 72.11 140.74 72.11C146.35 72.11 150.99 67.98 151.79 62.59ZM151.79 117.68C151 112.3 146.36 108.17 140.76 108.16C146.36 108.16 151 104.02 151.79 98.64C152.6 104.02 157.23 108.15 162.84 108.16C157.23 108.17 152.6 112.3 151.79 117.68ZM160.86 144.03C156.18 144.86 152.5 148.62 151.79 153.35C151.1 148.62 147.41 144.86 142.73 144.03C147.41 143.19 151.1 139.43 151.79 134.7C152.5 139.43 156.18 143.19 160.86 144.03ZM151.79 170.37C152.6 175.76 157.24 179.89 162.85 179.89C157.24 179.89 152.6 184.02 151.79 189.41C150.99 184.02 146.35 179.89 140.74 179.89C146.35 179.89 150.99 175.76 151.79 170.37ZM151.79 206.43C152.6 211.82 157.24 215.95 162.85 215.95C157.24 215.95 152.6 220.08 151.79 225.47C150.99 220.08 146.35 215.95 140.74 215.95C146.35 215.95 150.99 211.82 151.79 206.43ZM121.54 24.89C121.55 31.06 126.55 36.05 132.72 36.05C126.55 36.05 121.55 41.05 121.54 47.21C121.53 41.05 116.53 36.05 110.36 36.05C116.53 36.05 121.53 31.06 121.54 24.89ZM121.54 60.95C121.55 67.11 126.55 72.11 132.72 72.11C126.55 72.11 121.55 77.1 121.54 83.27C121.53 77.1 116.53 72.11 110.36 72.11C116.53 72.11 121.53 67.11 121.54 60.95ZM121.54 119.32C121.53 113.16 116.54 108.17 110.38 108.16C116.54 108.16 121.53 103.16 121.54 97C121.55 103.16 126.54 108.15 132.69 108.16C126.54 108.17 121.55 113.16 121.54 119.32ZM130.73 144.03C125.51 144.96 121.54 149.51 121.54 155C121.53 149.51 117.56 144.96 112.35 144.03C117.56 143.09 121.53 138.54 121.54 133.05C121.54 138.54 125.51 143.09 130.73 144.03ZM121.54 168.73C121.55 174.9 126.55 179.89 132.72 179.89C126.55 179.89 121.55 184.89 121.54 191.05C121.53 184.89 116.53 179.89 110.36 179.89C116.53 179.89 121.53 174.9 121.54 168.73ZM121.54 204.79C121.55 210.95 126.55 215.95 132.72 215.95C126.55 215.95 121.55 220.94 121.54 227.11C121.53 220.94 116.53 215.95 110.36 215.95C116.53 215.95 121.53 210.95 121.54 204.79ZM91.16 24.87C91.16 31.05 96.16 36.05 102.34 36.05C96.16 36.05 91.16 41.06 91.16 47.23C91.16 41.06 86.15 36.05 79.98 36.05C86.15 36.05 91.16 31.05 91.16 24.87ZM91.16 60.93C91.16 67.1 96.16 72.11 102.34 72.11C96.16 72.11 91.16 77.11 91.16 83.29C91.16 77.11 86.15 72.11 79.98 72.11C86.15 72.11 91.16 67.1 91.16 60.93ZM91.16 119.34C91.16 113.17 86.16 108.17 79.99 108.16C86.16 108.16 91.16 103.15 91.16 96.98C91.16 103.15 96.16 108.15 102.31 108.16C96.16 108.17 91.16 113.17 91.16 119.34ZM100.35 144.03C95.12 144.96 91.16 149.52 91.16 155.02C91.16 149.52 87.18 144.96 81.95 144.03C87.18 143.09 91.16 138.53 91.16 133.03C91.16 138.53 95.12 143.09 100.35 144.03ZM91.16 168.71C91.16 174.89 96.16 179.89 102.34 179.89C96.16 179.89 91.16 184.9 91.16 191.07C91.16 184.9 86.15 179.89 79.98 179.89C86.15 179.89 91.16 174.89 91.16 168.71ZM91.16 204.77C91.16 210.94 96.16 215.95 102.34 215.95C96.16 215.95 91.16 220.95 91.16 227.13C91.16 220.95 86.15 215.95 79.98 215.95C86.15 215.95 91.16 210.94 91.16 204.77ZM60.76 24.9C60.79 31.06 65.79 36.05 71.94 36.05C65.79 36.05 60.79 41.05 60.76 47.21C60.75 41.05 55.75 36.05 49.6 36.05C55.75 36.05 60.75 31.06 60.76 24.9ZM60.76 60.95C60.79 67.11 65.79 72.11 71.94 72.11C65.79 72.11 60.79 77.1 60.76 83.26C60.75 77.1 55.75 72.11 49.6 72.11C55.75 72.11 60.75 67.11 60.76 60.95ZM60.76 119.31C60.75 113.16 55.76 108.17 49.61 108.16C55.76 108.16 60.75 103.16 60.76 97.01C60.79 103.16 65.78 108.15 71.92 108.16C65.78 108.17 60.79 113.16 60.76 119.31ZM69.97 144.03C64.74 144.96 60.79 149.51 60.76 154.99C60.75 149.51 56.79 144.96 51.57 144.03C56.79 143.09 60.75 138.54 60.76 133.06C60.79 138.54 64.74 143.09 69.97 144.03ZM60.76 168.74C60.79 174.9 65.79 179.89 71.94 179.89C65.79 179.89 60.79 184.89 60.76 191.05C60.75 184.89 55.75 179.89 49.6 179.89C55.75 179.89 60.75 174.9 60.76 168.74ZM60.76 204.79C60.79 210.95 65.79 215.95 71.94 215.95C65.79 215.95 60.79 220.94 60.76 227.1C60.75 220.94 55.75 215.95 49.6 215.95C55.75 215.95 60.75 210.95 60.76 204.79ZM30.38 24.87C30.38 31.05 35.4 36.05 41.56 36.05C35.4 36.05 30.38 41.06 30.38 47.23C30.38 41.06 25.38 36.05 19.2 36.05C25.38 36.05 30.38 31.05 30.38 24.87ZM30.38 60.93C30.38 67.1 35.4 72.11 41.56 72.11C35.4 72.11 30.38 77.11 30.38 83.29C30.38 77.11 25.38 72.11 19.2 72.11C25.38 72.11 30.38 67.1 30.38 60.93ZM30.38 119.34C30.38 113.17 25.4 108.17 19.23 108.16C25.4 108.16 30.38 103.15 30.38 96.98C30.38 103.15 35.38 108.15 41.54 108.16C35.38 108.17 30.38 113.17 30.38 119.34ZM39.57 144.03C34.35 144.96 30.38 149.52 30.38 155.02C30.38 149.52 26.41 144.96 21.19 144.03C26.41 143.09 30.38 138.53 30.38 133.03C30.38 138.53 34.35 143.09 39.57 144.03ZM30.38 168.71C30.38 174.89 35.4 179.89 41.56 179.89C35.4 179.89 30.38 184.9 30.38 191.07C30.38 184.9 25.38 179.89 19.2 179.89C25.38 179.89 30.38 174.89 30.38 168.71ZM30.38 204.77C30.38 210.94 35.4 215.95 41.56 215.95C35.4 215.95 30.38 220.95 30.38 227.13C30.38 220.95 25.38 215.95 19.2 215.95C25.38 215.95 30.38 210.94 30.38 204.77Z" fill="url(#paint0_linear_3248_5)"/>
              <defs>
                <linearGradient id="paint0_linear_3248_5" x1="182.11" y1="0" x2="182.11" y2="252" gradientUnits="userSpaceOnUse">
                  <stop offset="0" stop-color="${e.color}" stop-opacity="0" />
                  <stop offset="0.3" stop-color="${e.color}" stop-opacity="1" />
                </linearGradient>
              </defs>
            </svg>
            ${e.image?`<img src="${e.image}" class="popup-background-image" alt="">`:""}
            <div class="content-wrapper">
              <div class="popup-title">${e.name}</div>
                          <div class="fade-top"></div> 
              <div class="popup-description">${e.description}</div>
                        <div class="fade-bottom"></div>

              ${e.image?'<button class="impressie-button button-base">Impressie</button>':""}
              <button class="more-info-button button-base">Meer info</button>
            </div>
          </div>
          
          <div class="popup-side popup-back">
            <div class="content-wrapper">
              <div class="popup-title details">${e.name||"Naam error"}</div>

               <!-- Add this new social-icons div -->
          <div class="social-icons">
          ${e.website?`
            <a href="${e.website}" target="_blank" aria-label="Website" title="Website">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="2" y1="12" x2="22" y2="12"></line>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
              </svg>
            </a>`:""}
          ${e.instagram?`
            <a href="${e.instagram}" target="_blank" aria-label="Instagram" title="Instagram">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.28-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
              </svg>
            </a>`:""}
          ${e.facebook?`
            <a href="${e.facebook}" target="_blank" aria-label="Facebook" title="Facebook">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                 <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
              </svg>
            </a>`:""}
            </div>
              <div class="info-content"</div>
                <div class="popup-descriptionv2">${e.descriptionv2}</div>
              <button class="more-info-button button-base">Terug</button>
            </div>
          </div>
        </div>
      `}}function t1(e,t,o){if(!e)return;t&&(t.style.transition="opacity 0.3s ease"),o&&(o.style.transition="opacity 0.3s ease");const a=()=>{const n=e.scrollHeight-e.clientHeight;if(n<=5){t&&(t.style.opacity="0"),o&&(o.style.opacity="0");return}const l=e.scrollTop/n;if(o){let s=1;l>.75&&(s=1-(l-.75)/.25),o.style.opacity=Math.max(0,Math.min(1,s)).toFixed(2)}if(t){let s=0;l>0&&(s=Math.min(1,l*4)),t.style.opacity=Math.max(0,Math.min(1,s)).toFixed(2)}};return e.addEventListener("scroll",a),window.addEventListener("resize",a),a(),()=>{e.removeEventListener("scroll",a),window.removeEventListener("resize",a)}}function o1(e,t,o){const a=e.getElement(),n=a.querySelector(".mapboxgl-popup-content"),l=a.querySelector(".popup-wrapper"),s=a.querySelector(".popup-front .content-wrapper"),i=a.querySelector(".popup-back .content-wrapper"),c=a.querySelector(".popup-description"),r=a.querySelector("#paint0_linear_3248_5"),p=a.querySelector(".popup-front .fade-top"),g=a.querySelector(".popup-front .fade-bottom");if(c){const C=t1(c,p,g),x=a.querySelector(".popup-back .popup-descriptionv2"),w=a.querySelector(".popup-back .fade-top"),E=a.querySelector(".popup-back .fade-bottom");if(x){const M=t1(x,w,E);a.querySelector(".close-button").addEventListener("click",()=>{typeof C=="function"&&C(),typeof M=="function"&&M()})}else a.querySelector(".close-button").addEventListener("click",()=>{typeof C=="function"&&C()});a.querySelectorAll(".more-info-button").forEach(M=>{M.addEventListener("click",()=>{setTimeout(()=>{const m=l.classList.contains("is-flipped"),k=m?x:c;if(k){const P=k.scrollHeight-k.clientHeight;if(P>5){const L=k.scrollTop/P;m?(w&&(w.style.opacity=L>0?Math.min(1,L*4).toFixed(2):"0"),E&&(E.style.opacity=L>.75?(1-(L-.75)/.25).toFixed(2):"1")):(p&&(p.style.opacity=L>0?Math.min(1,L*4).toFixed(2):"0"),g&&(g.style.opacity=L>.75?(1-(L-.75)/.25).toFixed(2):"1"))}}},50)})})}function u(C,x,w){const E=parseFloat(w.y1.baseVal.value),M=parseFloat(w.y2.baseVal.value),m=Date.now();function k(){const P=Math.min((Date.now()-m)/800,1);w.y1.baseVal.value=E+(C-E)*P,w.y2.baseVal.value=M+(x-M)*P,P<1&&requestAnimationFrame(k)}requestAnimationFrame(k)}function b(){const C=Math.max(s.offsetHeight,i.offsetHeight);l.style.height=`${C}px`,a.querySelectorAll(".popup-side").forEach(x=>{x.style.height=`${C}px`})}if(l.addEventListener("mouseenter",()=>{u(30,282,r)}),l.addEventListener("mouseleave",()=>{u(0,252,r)}),setTimeout(b,10),n.style.opacity="0",n.style.transform="rotate(8deg) translateY(40px) scale(0.4)",requestAnimationFrame(()=>{n.style.transition="all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",n.style.opacity="1",n.style.transform="rotate(0deg) translateY(0) scale(1)"}),c){c.addEventListener("wheel",m=>{m.stopPropagation(),m.preventDefault(),c.scrollTop+=m.deltaY},{passive:!1}),c.addEventListener("mouseenter",()=>{map.dragPan.disable(),map.scrollZoom.disable()}),c.addEventListener("mouseleave",()=>{map.dragPan.enable(),map.scrollZoom.enable()});let C=!1,x,w;c.addEventListener("mousedown",m=>{C=!0,x=m.pageY,w=c.scrollTop,c.style.cursor="grabbing",m.preventDefault(),m.stopPropagation()}),c.addEventListener("mousemove",m=>{if(!C)return;m.preventDefault(),m.stopPropagation();const k=m.pageY-x;c.scrollTop=w-k}),document.addEventListener("mouseup",()=>{C=!1,c.style.cursor="grab"}),c.addEventListener("mouseleave",()=>{C=!1,c.style.cursor="grab"});let E=0,M=0;c.addEventListener("touchstart",m=>{E=m.touches[0].clientY,M=c.scrollTop,m.stopPropagation()}),c.addEventListener("touchmove",m=>{const k=E-m.touches[0].clientY;c.scrollTop=M+k,m.stopPropagation(),m.preventDefault()},{passive:!1})}t.image&&a.querySelector(".impressie-button")&&a.querySelector(".impressie-button").addEventListener("click",()=>{t.link_ar||(n.style.transition="all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)",n.style.transform="rotate(-5deg) translateY(40px) scale(0.6)",n.style.opacity="0",setTimeout(()=>{const C=Math.max(s.offsetHeight,i.offsetHeight);e.remove(),activePopup=null,q1(t,o,C)},400))}),a.querySelectorAll(".more-info-button").forEach(C=>{C.addEventListener("click",()=>{l.classList.toggle("is-flipped")})}),a.querySelectorAll(".close-button").forEach(C=>{C.addEventListener("click",()=>{n.style.transition="all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)",n.style.transform="rotate(-5deg) translateY(40px) scale(0.6)",n.style.opacity="0";const x=$(".locations-map_item.is--show");x.length&&x.css({opacity:"0",transform:"translateY(40px) scale(0.6)",transition:"all 400ms cubic-bezier(0.68, -0.55, 0.265, 1.55)"}),setTimeout(()=>{e.remove(),activePopup=null,$(".locations-map_item").removeClass("is--show"),window.geolocationManager&&(window.geolocationManager.isPopupOpen=!1,window.geolocationManager.wasTracking&&window.geolocationManager.resumeTracking())},400)})}),window.addEventListener("resize",b)}function q1(e,t,o){window.matchMedia("(max-width: 479px)").matches;const a=new mapboxgl.Popup({offset:{bottom:[0,-5],top:[0,0],left:[0,0],right:[0,0]},className:"custom-popup",closeButton:!1,maxWidth:"300px",closeOnClick:!1,anchor:"bottom"}),n=`
    <style>
      .popup-wrapper {
        height: ${o}px;
      }

      .popup-side {
        background-color: ${e.color||"#6B46C1"};
        clip-path: polygon(calc(100% - 0px) 26.5px, calc(100% - 0px) calc(100% - 26.5px), calc(100% - 0px) calc(100% - 26.5px), calc(100% - 0.34671999999995px) calc(100% - 22.20048px), calc(100% - 1.3505599999999px) calc(100% - 18.12224px), calc(100% - 2.95704px) calc(100% - 14.31976px), calc(100% - 5.11168px) calc(100% - 10.84752px), calc(100% - 7.76px) calc(100% - 7.76px), calc(100% - 10.84752px) calc(100% - 5.11168px), calc(100% - 14.31976px) calc(100% - 2.9570399999999px), calc(100% - 18.12224px) calc(100% - 1.35056px), calc(100% - 22.20048px) calc(100% - 0.34672px), calc(100% - 26.5px) calc(100% - 0px), calc(50% - -32.6px) calc(100% - 0px), calc(50% - -32.6px) calc(100% - 0px), calc(50% - -31.57121px) calc(100% - 0.057139999999947px), calc(50% - -30.56648px) calc(100% - 0.2255199999999px), calc(50% - -29.59427px) calc(100% - 0.50057999999996px), calc(50% - -28.66304px) calc(100% - 0.87775999999991px), calc(50% - -27.78125px) calc(100% - 1.3525px), calc(50% - -26.95736px) calc(100% - 1.92024px), calc(50% - -26.19983px) calc(100% - 2.57642px), calc(50% - -25.51712px) calc(100% - 3.31648px), calc(50% - -24.91769px) calc(100% - 4.13586px), calc(50% - -24.41px) calc(100% - 5.03px), calc(50% - -24.41px) calc(100% - 5.03px), calc(50% - -22.95654px) calc(100% - 7.6045699999999px), calc(50% - -21.23752px) calc(100% - 9.9929599999998px), calc(50% - -19.27298px) calc(100% - 12.17519px), calc(50% - -17.08296px) calc(100% - 14.13128px), calc(50% - -14.6875px) calc(100% - 15.84125px), calc(50% - -12.10664px) calc(100% - 17.28512px), calc(50% - -9.36042px) calc(100% - 18.44291px), calc(50% - -6.46888px) calc(100% - 19.29464px), calc(50% - -3.45206px) calc(100% - 19.82033px), calc(50% - -0.32999999999998px) calc(100% - 20px), calc(50% - -0.32999999999998px) calc(100% - 20px), calc(50% - 2.79179px) calc(100% - 19.82033px), calc(50% - 5.8079199999999px) calc(100% - 19.29464px), calc(50% - 8.69853px) calc(100% - 18.44291px), calc(50% - 11.44376px) calc(100% - 17.28512px), calc(50% - 14.02375px) calc(100% - 15.84125px), calc(50% - 16.41864px) calc(100% - 14.13128px), calc(50% - 18.60857px) calc(100% - 12.17519px), calc(50% - 20.57368px) calc(100% - 9.9929599999999px), calc(50% - 22.29411px) calc(100% - 7.60457px), calc(50% - 23.75px) calc(100% - 5.03px), calc(50% - 23.75px) calc(100% - 5.03px), calc(50% - 24.25769px) calc(100% - 4.1358599999999px), calc(50% - 24.85712px) calc(100% - 3.3164799999998px), calc(50% - 25.53983px) calc(100% - 2.57642px), calc(50% - 26.29736px) calc(100% - 1.92024px), calc(50% - 27.12125px) calc(100% - 1.3525px), calc(50% - 28.00304px) calc(100% - 0.87775999999997px), calc(50% - 28.93427px) calc(100% - 0.50057999999996px), calc(50% - 29.90648px) calc(100% - 0.22552000000002px), calc(50% - 30.91121px) calc(100% - 0.057140000000004px), calc(50% - 31.94px) calc(100% - 0px), 26.5px calc(100% - 0px), 26.5px calc(100% - 0px), 22.20048px calc(100% - 0.34671999999989px), 18.12224px calc(100% - 1.3505599999999px), 14.31976px calc(100% - 2.95704px), 10.84752px calc(100% - 5.1116799999999px), 7.76px calc(100% - 7.76px), 5.11168px calc(100% - 10.84752px), 2.95704px calc(100% - 14.31976px), 1.35056px calc(100% - 18.12224px), 0.34672px calc(100% - 22.20048px), 4.3855735949631E-31px calc(100% - 26.5px), 0px 26.5px, 0px 26.5px, 0.34672px 22.20048px, 1.35056px 18.12224px, 2.95704px 14.31976px, 5.11168px 10.84752px, 7.76px 7.76px, 10.84752px 5.11168px, 14.31976px 2.95704px, 18.12224px 1.35056px, 22.20048px 0.34672px, 26.5px 4.3855735949631E-31px, calc(50% - 26.74px) 0px, calc(50% - 26.74px) 0px, calc(50% - 25.31263px) 0.07137px, calc(50% - 23.91544px) 0.28176px, calc(50% - 22.55581px) 0.62559px, calc(50% - 21.24112px) 1.09728px, calc(50% - 19.97875px) 1.69125px, calc(50% - 18.77608px) 2.40192px, calc(50% - 17.64049px) 3.22371px, calc(50% - 16.57936px) 4.15104px, calc(50% - 15.60007px) 5.17833px, calc(50% - 14.71px) 6.3px, calc(50% - 14.71px) 6.3px, calc(50% - 13.6371px) 7.64798px, calc(50% - 12.446px) 8.89024px, calc(50% - 11.1451px) 10.01826px, calc(50% - 9.7428px) 11.02352px, calc(50% - 8.2475px) 11.8975px, calc(50% - 6.6676px) 12.63168px, calc(50% - 5.0115px) 13.21754px, calc(50% - 3.2876px) 13.64656px, calc(50% - 1.5043px) 13.91022px, calc(50% - -0.32999999999996px) 14px, calc(50% - -0.32999999999998px) 14px, calc(50% - -2.16431px) 13.9105px, calc(50% - -3.94768px) 13.6476px, calc(50% - -5.67177px) 13.2197px, calc(50% - -7.32824px) 12.6352px, calc(50% - -8.90875px) 11.9025px, calc(50% - -10.40496px) 11.03px, calc(50% - -11.80853px) 10.0261px, calc(50% - -13.11112px) 8.8992px, calc(50% - -14.30439px) 7.6577px, calc(50% - -15.38px) 6.31px, calc(50% - -15.38px) 6.31px, calc(50% - -16.27279px) 5.18562px, calc(50% - -17.25432px) 4.15616px, calc(50% - -18.31733px) 3.22714px, calc(50% - -19.45456px) 2.40408px, calc(50% - -20.65875px) 1.6925px, calc(50% - -21.92264px) 1.09792px, calc(50% - -23.23897px) 0.62586px, calc(50% - -24.60048px) 0.28184px, calc(50% - -25.99991px) 0.07138px, calc(50% - -27.43px) 8.9116630386686E-32px, calc(100% - 26.5px) 0px, calc(100% - 26.5px) 0px, calc(100% - 22.20048px) 0.34672px, calc(100% - 18.12224px) 1.35056px, calc(100% - 14.31976px) 2.95704px, calc(100% - 10.84752px) 5.11168px, calc(100% - 7.76px) 7.76px, calc(100% - 5.11168px) 10.84752px, calc(100% - 2.9570399999999px) 14.31976px, calc(100% - 1.35056px) 18.12224px, calc(100% - 0.34671999999995px) 22.20048px, calc(100% - 5.6843418860808E-14px) 26.5px);
      }

      .close-button {
        background: ${e.color||"#6B46C1"};
      }
    </style>
    <div class="popup-wrapper">
      <button class="close-button" aria-label="Close popup"></button>
      <div class="popup-side">
        <div class="image-container">
          <img src="${e.image}" alt="${e.name}" class="full-image">
          <div class="button-container">
            <button class="back-button">Terug</button>
          </div>
          <div class="location-name">${e.name}</div>
        </div>
      </div>
    </div>
  `;a.setLngLat(t).setHTML(n).addTo(map),activePopup=a;const l=a.getElement(),s=l.querySelector(".mapboxgl-popup-content"),i=l.querySelector(".close-button"),c=l.querySelector(".back-button");s.style.opacity="0",s.style.transform="rotate(8deg) translateY(40px) scale(0.4)",requestAnimationFrame(()=>{s.style.transition="all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",s.style.opacity="1",s.style.transform="rotate(0deg) translateY(0) scale(1)"});const r=l.querySelector("svg");if(r){const p=r.querySelector("linearGradient");if(p){const g=l.querySelector(".popup-wrapper");g.addEventListener("mouseenter",()=>{animateGradient(30,282,p)}),g.addEventListener("mouseleave",()=>{animateGradient(0,252,p)})}}i.addEventListener("click",()=>{s.style.transition="all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)",s.style.transform="rotate(-5deg) translateY(40px) scale(0.6)",s.style.opacity="0",setTimeout(()=>{a.remove(),activePopup=null},400)}),c.addEventListener("click",()=>{s.style.transition="all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)",s.style.transform="rotate(-5deg) translateY(40px) scale(0.6)",s.style.opacity="0",setTimeout(()=>{a.remove(),activePopup=null;const p=new mapboxgl.Popup({offset:{bottom:[0,-5],top:[0,0],left:[0,0],right:[0,0]},className:"custom-popup",closeButton:!1,maxWidth:"300px",closeOnClick:!1,anchor:"bottom"}),{styles:g,html:u}=e1(e);p.setLngLat(t).setHTML(`${g}${u}`),p.addTo(map),activePopup=p,o1(p,e,t);const b=p.getElement().querySelector(".mapboxgl-popup-content");b.style.opacity="0",b.style.transform="rotate(8deg) translateY(40px) scale(0.4)",requestAnimationFrame(()=>{b.style.transition="all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",b.style.opacity="1",b.style.transform="rotate(0deg) translateY(0) scale(1)"})},400)})}map.on("click","location-markers",async e=>{const t=e.features[0].geometry.coordinates.slice(),o=e.features[0].properties,a=o.type==="ar",n=window.matchMedia("(max-width: 479px)").matches?[0,200]:[0,250];map.flyTo({center:t,offset:n,duration:800,essential:!0});const l=$(".locations-map_item.is--show");if(l.length&&l.css({opacity:"0",transform:"translateY(40px) scale(0.6)"}),activePopup){const r=activePopup.getElement().querySelector(".mapboxgl-popup-content");r.style.transition="all 400ms cubic-bezier(0.68, -0.55, 0.265, 1.55)",r.style.transform="rotate(-5deg) translateY(20px) scale(0.8)",r.style.opacity="0"}if(await new Promise(r=>setTimeout(r,400)),activePopup&&(activePopup.remove(),activePopup=null),a)$(".locations-map_wrapper").removeClass("is--show"),$(".locations-map_item").removeClass("is--show");else{$(".locations-map_item").removeClass("is--show").css({display:"none",transform:"translateY(40px) scale(0.6)",opacity:"0"}),$(".locations-map_wrapper").addClass("is--show");const r=$(".locations-map_item").eq(o.arrayID);r.css({display:"block",opacity:"0",transform:"translateY(40px) scale(0.6)"}),r[0].offsetHeight,requestAnimationFrame(()=>{r.css({transition:"all 400ms cubic-bezier(0.68, -0.55, 0.265, 1.55)",opacity:"1",transform:"translateY(0) scale(1)"}).addClass("is--show")})}const s=new mapboxgl.Popup({offset:{bottom:[0,-5],top:[0,0],left:[0,0],right:[0,0]},className:"custom-popup",closeButton:!1,maxWidth:"300px",closeOnClick:!1,anchor:"bottom"});window.geolocationManager&&(window.geolocationManager.isPopupOpen=!0,window.geolocationManager.geolocateControl&&(window.geolocationManager.wasTracking=window.geolocationManager.geolocateControl._watchState==="ACTIVE_LOCK",window.geolocationManager.pauseTracking()));const{styles:i,html:c}=e1(o);s.setLngLat(t).setHTML(`${i}${c}`).addTo(map),activePopup=s,s.on("close",()=>{window.geolocationManager&&(window.geolocationManager.isPopupOpen=!1,window.geolocationManager.wasTracking&&window.geolocationManager.resumeTracking())}),o1(s,o,t)});const z1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));//! ============= MAP INTERACTION HANDLERS =============
map.on("load",()=>{map.once("idle",()=>{var t;const e=(t=map.getStyle().layers.find(o=>o.type==="symbol"&&o.id.includes("label")))==null?void 0:t.id;map.addLayer({id:"heerlen-buildings",type:"fill-extrusion",source:"composite","source-layer":"building",filter:["!=",["get","type"],"underground"],minzoom:15,paint:{"fill-extrusion-color":"#e8e0cc","fill-extrusion-height":["case",["has","height"],["get","height"],["has","min_height"],["get","min_height"],3],"fill-extrusion-base":["case",["has","min_height"],["get","min_height"],0],"fill-extrusion-opacity":1,"fill-extrusion-vertical-gradient":!0}},e)}),loadFiltersAndUpdateMap(),loadIcons(),addCustomMarkers(),setupLocationFilters(),markersAdded?applyMapFilters():map.once("idle",applyMapFilters),setTimeout(()=>{const e=window.matchMedia("(max-width: 479px)").matches?17:18;map.jumpTo({center:CONFIG.MAP.center,zoom:15,pitch:0,bearing:0}),map.flyTo({center:CONFIG.MAP.center,zoom:e,pitch:55,bearing:-17.6,duration:6e3,essential:!0,easing:t=>t*(2-t)})},5e3)}),$(".close-block").on("click",()=>{closeItem()}),["dragstart","zoomstart","rotatestart","pitchstart"].forEach(e=>{map.on(e,()=>{const t=$(".locations-map_item.is--show");if(t.length&&(t.css({opacity:"0",transform:"translateY(40px) scale(0.6)",transition:"all 400ms cubic-bezier(0.68, -0.55, 0.265, 1.55)"}),setTimeout(()=>{t.removeClass("is--show")},400)),activePopup){const o=activePopup.getElement().querySelector(".mapboxgl-popup-content");o.style.transition="all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)",o.style.transform="rotate(-5deg) translateY(40px) scale(0.6)",o.style.opacity="0",setTimeout(()=>{activePopup.remove(),activePopup=null},400)}})});//! grens instellingen en teleport functie voor zoom en afstand. 
map.on("moveend",()=>{if(map.isEasing())return;const e=map.getCenter(),t={lng:CONFIG.MAP.boundary.center[0],lat:CONFIG.MAP.boundary.center[1]};if(j1(e.lat,e.lng,t.lat,t.lng)>1){const a=document.createElement("div");a.id="interaction-blocker",document.body.appendChild(a),map.flyTo({center:CONFIG.MAP.center,zoom:17,pitch:45,bearing:-17.6,speed:.8,curve:1.5,essential:!0}),gsap.to(a,{duration:2,backgroundColor:"rgba(255,255,255,0)",onComplete:()=>{a.remove()}})}});//! Zorg ervoor dat de calculateDistance functie beschikbaar is op global niveau
function j1(e,t,o,a){const n=r=>r*(Math.PI/180),l=n(o-e),s=n(a-t),i=Math.sin(l/2)*Math.sin(l/2)+Math.cos(n(e))*Math.cos(n(o))*Math.sin(s/2)*Math.sin(s/2);return 6371*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))}const V1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));//! ============= THREEJS LAYER =============
const Y1=[{id:"schunck",origin:[50.88778235149691,5.979389928151281],altitude:0,rotate:[Math.PI/2,.45,0],url:"https://cdn.jsdelivr.net/gh/Artwalters/3dmodels_heerlen@main/schunckv5.glb",scale:1.3},{id:"theater",origin:[50.886541206107225,5.972454838314243],altitude:0,rotate:[Math.PI/2,2.05,0],url:"https://cdn.jsdelivr.net/gh/Artwalters/3dmodels_heerlen@main/theaterheerlenv4.glb",scale:.6}],W1={origin:[50.88801513786042,5.980644311376565],altitude:6.5,rotate:[Math.PI/2,.35,0],imageUrl:"https://daks2k3a4ib2z.cloudfront.net/671769e099775386585f574d/67adf2bff5be8a200ec2fa55_osgameos_mural-p-130x130q80.png",width:13,height:13};function K1(e){const t=mapboxgl.MercatorCoordinate.fromLngLat([e.origin[1],e.origin[0]],e.altitude),o=t.meterInMercatorCoordinateUnits(),a=e.width*o,n=e.height*o;return new Promise((l,s)=>{new THREE.TextureLoader().load(e.imageUrl,c=>{const r=new THREE.MeshBasicMaterial({map:c,transparent:!0,side:THREE.DoubleSide}),p=new THREE.PlaneGeometry(a,n),g=new THREE.Mesh(p,r);g.userData.transform={translateX:t.x,translateY:t.y,translateZ:t.z,rotate:e.rotate,scale:1},l(g)},void 0,c=>s(c))})}const J1={id:"3d-models",type:"custom",renderingMode:"3d",onAdd:function(e,t){this.map=e,this.scene=new THREE.Scene,this.camera=new THREE.Camera;const o=new THREE.AmbientLight(16777215,.57);this.scene.add(o);const a=new THREE.DirectionalLight(16777215,.55);a.color.setHex(16579836);const n=210*(Math.PI/180),l=50*(Math.PI/180);a.position.set(Math.sin(n)*Math.sin(l),Math.cos(n)*Math.sin(l),Math.cos(l)).normalize(),this.scene.add(a),this.renderer=new THREE.WebGLRenderer({canvas:e.getCanvas(),context:t,antialias:!0}),this.renderer.autoClear=!1;const s=new THREE.GLTFLoader;Y1.forEach(i=>{const c=mapboxgl.MercatorCoordinate.fromLngLat([i.origin[1],i.origin[0]],i.altitude);s.load(i.url,r=>{const p=r.scene;p.userData.transform={translateX:c.x,translateY:c.y,translateZ:c.z,rotate:i.rotate,scale:c.meterInMercatorCoordinateUnits()*i.scale},this.scene.add(p)},void 0,r=>console.error(r))}),K1(W1).then(i=>{this.scene.add(i)}).catch(i=>console.error("Error loading image plane:",i))},render:function(e,t){const o=new THREE.Matrix4().fromArray(t);this.scene.traverse(a=>{if(a.userData.transform){const n=a.userData.transform,l=new THREE.Matrix4().makeTranslation(n.translateX,n.translateY,n.translateZ),s=new THREE.Matrix4().makeScale(n.scale,-n.scale,n.scale),i=new THREE.Matrix4().makeRotationX(n.rotate[0]),c=new THREE.Matrix4().makeRotationY(n.rotate[1]),r=new THREE.Matrix4().makeRotationZ(n.rotate[2]),p=new THREE.Matrix4().multiply(l).multiply(s).multiply(i).multiply(c).multiply(r);a.matrix=new THREE.Matrix4().copy(o).multiply(p),a.matrixAutoUpdate=!1}}),this.renderer.resetState(),this.renderer.render(this.scene,this.camera)}};map.on("style.load",()=>{map.addLayer(J1)});const X1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));//! Complete POI filter and interaction code /////////////////////////
const Q1=["Brasserie Mijn Streek","De Twee Gezusters","SCHUNCK Bibliotheek Heerlen Glaspaleis","Glaspaleis Schunck","Bagels & Beans","Terras Bagels & Beans","Brunch Bar","Berden","Aroma","Brasserie Goya","Poppodium Nieuwe Nor","Nederlands Mijnmuseum","Smaak & Vermaak","Café ","De Kromme Toeter","Café Pelt","Het Romeins Museum","Pat's Tosti Bar","Sint-Pancratiuskerk","Cafe Bluff"];map.on("idle",()=>{if(!map.loaded())return;let e=["all"];Q1.forEach(o=>{e.push(["all",["!=",["get","brand"],o],["!=",["get","name"],o]])}),e.push(["has","name"]),["poi-label","poi-scalerank1","poi-scalerank2","poi-scalerank3","poi-scalerank4"].forEach(o=>{map.getLayer(o)&&map.setFilter(o,e)})});const ee=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));//! Enhanced walkthrough for Heerlen Mapbox application ////////////////////
document.addEventListener("DOMContentLoaded",function(){if(typeof mapboxgl<"u"){te();const e=setInterval(function(){const t=document.getElementById("map");t&&t.querySelector(".mapboxgl-canvas")&&map&&map.loaded()&&(clearInterval(e),setTimeout(function(){oe()},2e3))},500)}});function te(){if(!document.getElementById("tour-styles")){const e=document.createElement("link");e.id="tour-styles",e.rel="stylesheet",e.type="text/css",e.href="tour-styles.css",document.head.appendChild(e)}}function oe(){const e=localStorage.getItem("heerlenMapWalkthroughShown");ne(),(!e||window.location.hash==="#tutorial")&&ae(function(){a1(),localStorage.setItem("heerlenMapWalkthroughShown","true")})}function ae(e){const t=document.createElement("div");t.className="welcome-overlay",t.innerHTML=`
      <div class="welcome-card">
        <p> Welkom in <strong>Heerlen</strong> deze kaart heeft veel unieke functies die ik je graag uitleg </p>
        <div class="welcome-buttons">
          <button class="welcome-start-btn">Start tour</button>
          <button class="welcome-skip-btn">Skip tour</button>
        </div>
      </div>
    `,document.body.appendChild(t),setTimeout(()=>{t.style.opacity="1";const o=t.querySelector(".welcome-card");o.style.transform="translateY(0)",o.style.opacity="1"},100),t.querySelector(".welcome-start-btn").addEventListener("click",function(){t.style.opacity="0",setTimeout(()=>{t.remove(),e()},500)}),t.querySelector(".welcome-skip-btn").addEventListener("click",function(){t.style.opacity="0",setTimeout(()=>{t.remove()},500)})}function ne(){const e=document.querySelector(".help-button");e&&e.remove();const t=document.createElement("button");t.className="help-button",t.innerHTML="?",t.title="Start rondleiding",t.setAttribute("aria-label","Start kaart rondleiding"),t.addEventListener("click",()=>{if(window.activeTour&&window.activeTour.isActive()){const a=window.activeTour.getCurrentStep();a?window.activeTour.show(a.id):window.activeTour.start()}else a1()});const o=document.querySelector(".mapboxgl-ctrl-top-right");if(o){const a=document.createElement("div");a.className="mapboxgl-ctrl mapboxgl-ctrl-group help-button-container",a.appendChild(t),o.appendChild(a)}}function a1(){const e=new Shepherd.Tour({useModalOverlay:!1,defaultStepOptions:{cancelIcon:{enabled:!0},classes:"shepherd-theme-heerlen",scrollTo:!1,title:null,popperOptions:{modifiers:[{name:"offset",options:{offset:[0,12]}},{name:"preventOverflow",options:{boundary:document.body,padding:10}}]}}});window.activeTour=e;function t(){const i=document.querySelector(".shepherd-modal-overlay-container");i&&(i.style.transition="opacity 0.3s ease",i.classList.add("shepherd-modal-is-visible"),i.style.pointerEvents="auto")}function o(){const i=document.querySelector(".shepherd-modal-overlay-container");i&&(i.classList.remove("shepherd-modal-is-visible"),i.style.pointerEvents="none")}function a(i,c){const r=document.querySelector(i);if(r)return{element:r,on:"bottom"};if(c){const p=document.querySelector(c);if(p)return{element:p,on:"bottom"}}return null}e.addStep({id:"welcome",text:"Ontdek <strong>Heerlen</strong> met deze interactieve kaart. We leiden je even rond!.",buttons:[{text:"Start",action:e.next,classes:"shepherd-button-primary"}],when:{show:t}}),[{id:"map-controls",attachTo:a(".mapboxgl-ctrl-top-right",".mapboxgl-ctrl-group"),text:"Gebruik deze <strong>knoppen</strong> om in/uit te zoomen en de kaart te draaien."},{id:"filters",attachTo:a(".map-filter-wrap-2",".filter-btn"),text:" gebruik <strong>filters</strong> om per categorie te zoeken en te ontdekken!"},{id:"geolocation",attachTo:a(".mapboxgl-ctrl-geolocate",".mapboxgl-ctrl-bottom-right"),text:"Klik hier om je <strong>locatie</strong> aan te zetten en direct te zien waar jij je bevindt op de kaart."}].forEach(i=>{i.attachTo&&e.addStep({...i,buttons:[{text:"←",action:e.back,classes:"shepherd-button-secondary"},{text:"→",action:e.next,classes:"shepherd-button-primary"}],when:{show:t,hide:()=>{var r;const c=(r=i.attachTo)==null?void 0:r.element;c&&(c.classList.add("tour-highlight-pulse"),setTimeout(()=>{c.classList.remove("tour-highlight-pulse")},1e3))}}})}),e.addStep({id:"try-marker",text:`
        <div class="tour-marker-instruction">
          <p>klik op een van de <strong>gekleurde</strong> rondjes.</p>
          <div class="marker-animation">
            <span class="pulse-dot"></span>
            <span class="instruction-arrow">↓</span>
          </div>
        </div>
      `,buttons:[{text:"←",action:e.back,classes:"shepherd-button-secondary"},{text:"Skip",action:()=>{window.tourWaitingForMarkerClick=!1,e.show("popup-info")},classes:"shepherd-button-secondary"}],when:{show:function(){o();const i=document.createElement("div");i.className="tour-instruction-message",i.textContent="Klik op een marker om door te gaan",document.body.appendChild(i),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i)},4e3),window.tourWaitingForMarkerClick=!0,window.markerClickFallbackTimer=setTimeout(()=>{if(window.tourWaitingForMarkerClick){const c=document.createElement("div");c.className="tour-instruction-message",c.textContent='Klik op "Skip" als je geen marker kunt vinden',document.body.appendChild(c),setTimeout(()=>{c.parentNode&&c.parentNode.removeChild(c)},5e3)}},15e3)},hide:function(){window.markerClickFallbackTimer&&clearTimeout(window.markerClickFallbackTimer),document.querySelectorAll(".tour-instruction-message").forEach(c=>{c.parentNode&&c.parentNode.removeChild(c)})}},canClickTarget:!1,advanceOn:null}),e.addStep({id:"popup-info",attachTo:function(){const i=document.querySelector(".mapboxgl-popup-content");return i?{element:i,on:"top"}:null},text:"Bekijk <strong>informatie</strong> over deze plek en druk op de <strong>like-knop</strong> om deze locatie op te slaan.",buttons:[{text:"←",action:e.back,classes:"shepherd-button-secondary"},{text:"→",action:e.next,classes:"shepherd-button-primary"}],when:{show:function(){if(t(),!document.querySelector(".mapboxgl-popup-content")&&map){const i=document.querySelector(".mapboxgl-marker, .mapboxgl-user-location-dot");i&&(i.click(),setTimeout(()=>{if(!document.querySelector(".mapboxgl-popup-content")&&map.getLayer("location-markers")){const c=map.queryRenderedFeatures({layers:["location-markers"]});if(c.length>0){const r=c[0];map.fire("click",{lngLat:r.geometry.coordinates,point:map.project(r.geometry.coordinates),features:[r]})}}},300))}}}}),e.addStep({id:"like-heart-svg",attachTo:a(".heart-svg.w-embed",".like-heart-svg"),text:"Klik op het <strong>hartje</strong> om al je opgeslagen favoriete locaties te bekijken.",buttons:[{text:"←",action:e.back,classes:"shepherd-button-secondary"},{text:"→",action:e.next,classes:"shepherd-button-primary"}],when:{show:t,hide:()=>{const i=document.querySelector(".heart-svg.w-embed");i&&(i.classList.add("tour-highlight-pulse"),setTimeout(()=>{i.classList.remove("tour-highlight-pulse")},1e3))}}}),e.addStep({id:"finish",text:"Je bent nu klaar om <strong>Heerlen te verkennen</strong>! Klik op markers om locaties te ontdekken. Je kunt deze rondleiding opnieuw starten via het <strong>?</strong> icoon.",buttons:[{text:"Klaar",action:e.complete,classes:"shepherd-button-primary"}],when:{show:t}}),e.on("start",()=>{ce(e)});function l(){window.markerClickListener&&map.off("click","location-markers",window.markerClickListener),window.markerClickListener=()=>{window.tourWaitingForMarkerClick&&(window.tourWaitingForMarkerClick=!1,clearTimeout(window.markerClickFallbackTimer),setTimeout(()=>{e.getCurrentStep()&&e.getCurrentStep().id==="try-marker"&&(t(),e.show("popup-info"))},500))},map.on("click","location-markers",window.markerClickListener)}l();function s(){window.tourWaitingForMarkerClick=!1,window.markerClickFallbackTimer&&clearTimeout(window.markerClickFallbackTimer),document.querySelectorAll(".tour-instruction-message").forEach(r=>{r.parentNode&&r.parentNode.removeChild(r)});const c=document.querySelector(".shepherd-progress-bar");c&&c.parentNode&&c.parentNode.removeChild(c)}e.on("complete",s),e.on("cancel",s),e.start()}function ce(e){const t=document.querySelector(".shepherd-progress-bar");t&&t.remove();const o=document.createElement("div");o.className="shepherd-progress-bar";const a=document.createElement("div");a.className="progress-inner",a.innerHTML='<div class="progress-fill"></div>';const n=document.createElement("button");n.className="progress-bar-close-btn",n.innerHTML="×",n.setAttribute("aria-label","Sluit rondleiding"),n.title="Sluit rondleiding",n.addEventListener("click",()=>{e.cancel()}),o.appendChild(a),o.appendChild(n),document.body.appendChild(o);function l(){const s=e.getCurrentStep();if(!s)return;const i=e.steps.indexOf(s),c=e.steps.length,r=c>1?Math.round(i/(c-1)*100):100,p=o.querySelector(".progress-fill");p&&(p.style.width=`${r}%`)}e.on("show",l),l()}window.addEventListener("storage",function(e){if(e.key===localStorageKey){console.log("Storage event ontvangen op kaart pagina:",e.newValue);try{const t=e.newValue?JSON.parse(e.newValue):[];updateMapState(t)}catch(t){console.error("Kon storage update niet verwerken op kaart:",t),updateMapState([])}}});const ie=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));//!Toggle 3D layers visibility - optimized version //////////////
function F(e){PERFORMANCE_CONFIG.settings.is3DEnabled=e,c1(),n1(),PERFORMANCE_CONFIG.layers.buildingLayers.length===0&&O();const t=PERFORMANCE_CONFIG.layers.threeDModelsLayer;map.getLayer(t)&&map.setLayoutProperty(t,"visibility",e?"visible":"none"),PERFORMANCE_CONFIG.layers.buildingLayers.forEach(o=>{if(e){if(map.setLayoutProperty(o,"visibility","visible"),PERFORMANCE_CONFIG.originalPaintProperties[o]){const a=PERFORMANCE_CONFIG.originalPaintProperties[o];Object.entries(a).forEach(([n,l])=>{map.setPaintProperty(o,n,l)})}}else PERFORMANCE_CONFIG.originalPaintProperties[o]||(PERFORMANCE_CONFIG.originalPaintProperties[o]={"fill-extrusion-height":map.getPaintProperty(o,"fill-extrusion-height"),"fill-extrusion-base":map.getPaintProperty(o,"fill-extrusion-base")}),map.setLayoutProperty(o,"visibility","none")}),le(e)}function O(){const e=map.getStyle().layers;PERFORMANCE_CONFIG.layers.buildingLayers=e.filter(t=>t.type==="fill-extrusion"&&(t.id.includes("building")||t.id.includes("3d"))).map(t=>t.id)}function le(e){if(!e&&map.getPitch()>0)PERFORMANCE_CONFIG.previousPitch=map.getPitch(),c1(),map.easeTo({pitch:0,duration:500});else if(e&&!PERFORMANCE_CONFIG.settings.lowPerformanceDetected){const t=PERFORMANCE_CONFIG.previousPitch||45;map.easeTo({pitch:t,duration:500})}}function n1(){const e=document.querySelector(".toggle-3d-button");if(!e)return;const t=PERFORMANCE_CONFIG.settings.is3DEnabled;e.classList.toggle("is-active",t),e.setAttribute("aria-pressed",t),e.title=t?"Schakel Performance Mode uit":"Schakel Performance Mode in",e.innerHTML=t?'<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9M12 4.15l-6.04 3.4 6.04 3.4 6.04-3.4L12 4.15Z"/></svg>':'<svg viewBox="0 0 24 24" width="16" height="16"><path fill="none" stroke="currentColor" stroke-width="1.5" d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9M12 4.15l-6.04 3.4 6.04 3.4 6.04-3.4L12 4.15Z"/></svg>'}function c1(){localStorage.setItem("heerlen_map_performance",JSON.stringify({is3DEnabled:PERFORMANCE_CONFIG.settings.is3DEnabled,previousPitch:PERFORMANCE_CONFIG.previousPitch||45,tooltipShown:PERFORMANCE_CONFIG.settings.frameRatePopupShown,warningShown:localStorage.getItem("performance_warning_shown")==="true"}))}function se(){try{const e=localStorage.getItem("heerlen_map_performance");if(e){const t=JSON.parse(e);PERFORMANCE_CONFIG.settings.is3DEnabled=t.is3DEnabled!==!1,PERFORMANCE_CONFIG.previousPitch=t.previousPitch,PERFORMANCE_CONFIG.settings.frameRatePopupShown=t.tooltipShown===!0,t.warningShown&&localStorage.setItem("performance_warning_shown","true")}else PERFORMANCE_CONFIG.settings.is3DEnabled=localStorage.getItem("heerlen_map_3d_enabled")!=="false",PERFORMANCE_CONFIG.settings.frameRatePopupShown=localStorage.getItem("performance_tooltip_shown")==="true"}catch{console.warn("Failed to load performance settings")}}function re(){if(PERFORMANCE_CONFIG.frameRateMonitor)return;let e=performance.now(),t=0,o=0,a=0,n=!0,l=null;const s=2e3,i=()=>{if(!n)return;t++;const r=performance.now();if(r-e>=s){const p=Math.round(t*1e3/(r-e));if(a+=p,o++,o>=3){if(a/o<20){PERFORMANCE_CONFIG.settings.lowPerformanceDetected=!0;const u=document.querySelector(".toggle-3d-button");PERFORMANCE_CONFIG.settings.is3DEnabled&&u&&!PERFORMANCE_CONFIG.settings.frameRatePopupShown&&showPerformanceTooltip(u),c();return}else if(o>=5){c();return}}t=0,e=r}n&&(l=requestAnimationFrame(i))},c=()=>{n=!1,l!==null&&cancelAnimationFrame(l),PERFORMANCE_CONFIG.frameRateMonitor=null};l=requestAnimationFrame(i),PERFORMANCE_CONFIG.frameRateMonitor={stop:c},setTimeout(c,3e4)}function pe(){const e=document.querySelector(".mapboxgl-ctrl-group .toggle-3d-button");if(e){const n=e.closest(".mapboxgl-ctrl-group");n&&n.remove()}const t=document.createElement("div");t.className="mapboxgl-ctrl mapboxgl-ctrl-group";const o=document.createElement("button");o.className="mapboxgl-ctrl-icon toggle-3d-button",o.type="button",o.setAttribute("aria-label","3D gebouwen aan/uit"),n1(),o.addEventListener("click",()=>{F(!PERFORMANCE_CONFIG.settings.is3DEnabled),PERFORMANCE_CONFIG.settings.is3DEnabled&&PERFORMANCE_CONFIG.settings.lowPerformanceDetected&&localStorage.getItem("performance_warning_shown")!=="true"&&showPerformanceWarning()}),o.addEventListener("mouseenter",()=>{PERFORMANCE_CONFIG.settings.lowPerformanceDetected&&!PERFORMANCE_CONFIG.settings.frameRatePopupShown&&showPerformanceTooltip(o)}),t.appendChild(o);const a=document.querySelector(".mapboxgl-ctrl-top-right");a&&a.appendChild(t)}function de(){se(),map.once("load",()=>{pe(),setTimeout(re,5e3);const e=()=>{map.getLayer(PERFORMANCE_CONFIG.layers.threeDModelsLayer)&&(O(),F(PERFORMANCE_CONFIG.settings.is3DEnabled),map.off("styledata",e))};map.on("styledata",e),map.getLayer(PERFORMANCE_CONFIG.layers.threeDModelsLayer)&&(O(),F(PERFORMANCE_CONFIG.settings.is3DEnabled))})}de();const ue=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}))})();
